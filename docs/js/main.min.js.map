{"version":3,"sources":["src/js/main.js","../../src/js/common/modal/modal.service.js","../../src/js/common/utils/utils.js","../../src/js/environment.js","../../src/js/environment.static.js","../../src/js/environment.served.js","../../src/js/common/http/http.service.js","../../src/js/common/label/label.pipe.js","../../src/js/common/location/location.service.js","../../src/js/common/language/language.service.js","../../src/js/common/api/api.service.js","../../src/js/common/storage/local-storage.service.js","../../src/js/shared/header/header.service.js","../../src/js/shared/cart-mini/cart-mini.service.js","../../src/js/pages/cart/cart.service.js","../../src/js/common/storage/session-storage.service.js","../../src/js/shared/user/user.service.js","../../src/js/app.component.js","../../src/js/common/alt/alt.directive.js","../../src/js/common/click-outside/click-outside.directive.js","../../src/js/common/date/date.pipe.js","../../src/js/common/download/download.directive.js","../../src/js/common/locomotive-scroll/locomotive-scroll.service.js","../../src/js/common/dropdown/dropdown.directive.js","../../src/js/common/dropdown/dropdown-item.directive.js","../../src/js/common/env/env.pipe.js","../../src/js/common/filter/filter-item.component.js","../../src/js/common/flag/flag.pipe.js","../../src/js/common/highlight/highlight.pipe.js","../../src/js/common/html/html.pipe.js","../../src/js/common/id/id.directive.js","../../src/js/common/label-for/label-for.directive.js","../../src/js/common/locomotive-scroll/locomotive-scroll-sticky.directive.js","../../src/js/common/locomotive-scroll/locomotive-scroll-to.directive.js","../../src/js/common/locomotive-scroll/locomotive-scroll.directive.js","../../src/js/common/locomotive-scroll/scroll.directive.js","../../src/js/common/modal/modal-outlet.component.js","../../src/js/common/name/name.directive.js","../../src/js/common/number/number.pipe.js","../../src/js/common/relative-date/relative-date.pipe.js","../../src/js/common/share/share.directive.js","../../src/js/common/slug/slug.pipe.js","../../src/js/common/svg/svg-icon.structure.js","../../src/js/common/swiper/swiper.directive.js","../../src/js/common/thron/thron.service.js","../../src/js/common/thron/thron.component.js","../../src/js/common/title/title.directive.js","../../src/js/common/common.module.js","../../src/js/controls/control.component.js","../../src/js/controls/control-autocomplete.component.js","../../src/js/controls/control-checkbox.component.js","../../src/js/common/keyboard/keyboard.service.js","../../src/js/controls/control-custom-select.component.js","../../src/js/controls/control-email.component.js","../../src/js/controls/control-file.component.js","../../src/js/controls/control-password.component.js","../../src/js/controls/control-privacy.component.js","../../src/js/controls/control-search.component.js","../../src/js/controls/control-text.component.js","../../src/js/controls/control-textarea.component.js","../../src/js/controls/errors.component.js","../../src/js/controls/test.component.js","../../src/js/controls/controls.module.js","../../src/js/common/filter/filter-item.js","../../src/js/common/filter/filter.service.js","../../src/js/shared/filters/filters.component.js","../../src/js/pages/products/products.service.js","../../src/js/pages/products/products.component.js","../../src/js/pages/ambience/ambience.service.js","../../src/js/pages/ambience/ambience.component.js","../../src/js/pages/ateliers-and-stores/ateliers-and-stores.service.js","../../src/js/pages/ateliers-and-stores/ateliers-and-stores.component.js","../../src/js/pages/careers/careers-modal.component.js","../../src/js/common/gtm/gtm.service.js","../../src/js/controls/form.service.js","../../src/js/controls/required-if.validator.js","../../src/js/pages/careers/careers.service.js","../../src/js/pages/careers/careers.component.js","../../src/js/common/once/once.service.js","../../src/js/common/facebook/facebook.service.js","../../src/js/common/google/google.service.js","../../src/js/common/googlemaps/googlemaps.service.js","../../src/js/common/linkedin/linkedin.service.js","../../src/js/controls/required-true-if.validator.js","../../src/js/pages/orders/orders.service.js","../../src/js/pages/cart/cart.component.js","../../src/js/pages/catalogues/catalogues.service.js","../../src/js/pages/catalogues/catalogues.component.js","../../src/js/pages/contacts/contacts.service.js","../../src/js/pages/contacts/contacts.component.js","../../src/js/pages/dealers/dealers.service.js","../../src/js/pages/dealers/dealers.component.js","../../src/js/pages/designers/designers.service.js","../../src/js/pages/designers/designers.component.js","../../src/js/pages/generic/generic-modal.component.js","../../src/js/pages/magazine-request/magazine-request-modal.component.js","../../src/js/pages/magazine-request/magazine-request-proposition.component.js","../../src/js/controls/phone-number.validator.js","../../src/js/pages/magazine-request/magazine-request.service.js","../../src/js/pages/magazine-request/magazine-request.component.js","../../src/js/pages/magazine/magazine.service.js","../../src/js/pages/magazine/magazine.component.js","../../src/js/pages/markets-and-languages/markets-and-languages.service.js","../../src/js/pages/market-proposition/market-proposition-modal.component.js","../../src/js/pages/markets-and-languages/markets-and-languages-modal.component.js","../../src/js/pages/materials/materials-modal.component.js","../../src/js/pages/materials/materials.service.js","../../src/js/pages/materials/materials.component.js","../../src/js/pages/news/news.service.js","../../src/js/pages/news/news.component.js","../../src/js/pages/newsletter/newsletter.service.js","../../src/js/pages/newsletter/newsletter.component.js","../../src/js/pages/orders/orders-modal.component.js","../../src/js/pages/orders/orders-detail.component.js","../../src/js/pages/orders/orders.component.js","../../src/js/pages/press/press.service.js","../../src/js/pages/press/press.component.js","../../src/js/pages/products-configure/products-configure.component.js","../../src/js/pages/products-detail/products-detail-request-modal.component.js","../../src/js/pages/products-detail/products-detail.service.js","../../src/js/pages/products-detail/products-detail-request.component.js","../../src/js/pages/products-detail/products-detail.component.js","../../src/js/pages/projects-registration/projects-registration-modal.component.js","../../src/js/pages/projects-registration/projects-registration.service.js","../../src/js/pages/projects-registration/projects-registration.component.js","../../src/js/pages/projects/projects.service.js","../../src/js/pages/projects/projects.component.js","../../src/js/shared/files/files.service.js","../../src/js/pages/reserved-area/reserved-area.service.js","../../src/js/pages/reserved-area/reserved-area.component.js","../../src/js/partials/map/map.service.js","../../src/js/pages/store-locator/store-locator.service.js","../../src/js/pages/store-locator/store-locator.component.js","../../node_modules/@googlemaps/markerclustererplus/src/overlay-view-safe.ts","../../node_modules/@googlemaps/markerclustererplus/src/cluster-icon.ts","../../node_modules/@googlemaps/markerclustererplus/src/cluster.ts","../../node_modules/@googlemaps/markerclustererplus/src/markerclusterer.ts","../../src/js/partials/map/map.style.js","../../src/js/partials/map/map.component.js","../../src/js/partials/swiper-gallery/swiper-gallery.directive.js","../../src/js/partials/swiper-homepage/swiper-homepage.directive.js","../../src/js/partials/swiper-news-proposition/swiper-news-proposition.directive.js","../../src/js/partials/swiper-products-proposition/swiper-products-proposition.directive.js","../../src/js/partials/swiper-projects-proposition/swiper-projects-proposition.directive.js","../../src/js/shared/cart-mini/cart-mini.component.js","../../src/js/shared/error/error.component.js","../../src/js/shared/files/files.component.js","../../src/js/shared/menu/menu.service.js","../../src/js/shared/header/header.component.js","../../src/js/shared/menu/menu.directive.js","../../src/js/shared/newsletter-proposition/newsletter-proposition.component.js","../../src/js/shared/search/search.service.js","../../src/js/shared/search/search.component.js","../../src/js/shared/submenu/submenu.directive.js","../../src/js/shared/tree/tree.component.js","../../src/js/shared/user/user-access-data.component.js","../../src/js/shared/user/user-delete.component.js","../../src/js/shared/user/user-detail.component.js","../../src/js/shared/user/user-edit-password.component.js","../../src/js/shared/user/user-edit.component.js","../../src/js/shared/user/user-forgot.component.js","../../src/js/shared/user/user.component.js","../../src/js/shared/user/user-modal.component.js","../../src/js/shared/user/user-signin.component.js","../../src/js/controls/match.validator.js","../../src/js/shared/user/user-signup.component.js","../../src/js/shared/shared.module.js","../../src/js/app.module.js","../../src/js/main.js"],"names":["g","f","exports","module","require","define","amd","globalThis","self","rxcomp","form","rxjs","operators","this","rxcompForm","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","Constructor","protoProps","staticProps","prototype","_defineProperty","obj","value","_inheritsLoose","subClass","superClass","create","constructor","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_assertThisInitialized","ReferenceError","ModalEvent","data","ModalResolveEvent","_ModalEvent","apply","arguments","ModalRejectEvent","_ModalEvent2","ModalService","open$","modal","_this","busy$","next","getTemplate$","src","pipe","map","template","node","getNode","tap","modal$","hasModal","switchMap","events$","_","load$","url","from","fetch","then","response","text","div","document","createElement","innerHTML","firstElementChild","reject","resolve","Subject","Utils","merge","source","keys","forEach","Array","isArray","NODE","BASE_HREF","get","URLSearchParams","window","location","search","querySelector","getAttribute","HEROKU","host","indexOf","STATIC","port","DEVELOPMENT","split","ENV","PRODUCTION","Environment","_proto","options","assign","getAbsoluteUrl","path","params","origin","replace","getPath","isLocal","href","set","console","log","githubDocs","defaultOptions","flags","production","heroku","slug","markets","defaultMarket","currentMarket","languages","defaultLanguage","currentLanguage","labels","select","browse","cancel","error_email","error_phoneNumber","error_match","error_required","loading","remove","required","select_file","update","upload","drag_and_drop_images","environmentOptions","cart","userCountry","userMarket","detectedCountry","api","assets","configureProduct","reservedArea","careersModal","genericModal","magazineRequestModal","marketsAndLanguagesModal","marketPropositionModal","materialsModal","ordersModal","projectsRegistrationModal","userModal","productsDetailRequestModal","facebook","appId","fields","scope","tokenClient","version","google","clientId","linkedIn","clientSecret","googleMaps","apiKey","thron","workers","image","prefetch","environment","HttpService","http$","method","format","userPass","response_","headers","Accept","Content-Type","body","JSON","stringify","undefined","credentials","btoa","Headers","typedResponse","contentType","json","ok","Promise","error","warn","catchError","throwError","getError","get$","query","delete$","post$","put$","patch$","object","status","statusCode","statusMessage","statusText","LabelPipe","_Pipe","transform","labels_","getKeys","_len","_key","x","join","setLabels","LABELS","Pipe","meta","name","LocationService","has","keyOrValue","pushParams","history","pushState","title","toString","to","replaceState","pathname","state","deserialize","encoded","decode","serialize","encode","decoded","atob","parse","LanguageService","getDefaultLanguages","alternates","getDefaultLanguage","lang","setLanguage","language","selectedLanguage","setLanguage$","html","labelsMatch","exec","Function","call","bhereMatch","bhere","activeLanguage","toggleLanguages","showLanguages","pushChanges","_this2","find","ApiService","_HttpService","LocalStorageService","delete","isLocalStorageSupported","localStorage","removeItem","exist","e","cache","push","setItem","supported","HeaderService","setHeader","id","header$_","toggleHeader","currentHeader","onBack","header$","getValue","BehaviorSubject","CartMiniService","hasItem","item","items","currentItems","setItems","skip","STORAGE_KEY","items$_","setPendingItems","STORAGE_PENDING_KEY","resumePendingItems","items$","localItems","of","incrementItem$","slice","item_","qty","decrementItem$","removeItem$","addItem$","price","index","splice","removeAll$","getPrice$","getPriceAndAddItem$","match","code","showefy","internalstr","reduce","CartSteps","None","Items","Data","Delivery","Recap","Payment","Complete","Error","CartService","setStep","step","currentCart","setCart","cart$_","setPendingCart","hasPendingCart","resumePendingCart","cart$","localCart","clear$","data$","estimatedDelivery$","estimatedDelivery","Date","setDate","getDate","getDeliveryType$","getStores$","getDiscount$","payload","doPayment$","SessionStorageService","isSessionStorageSupported","sessionStorage","UserViews","SIGN_IN","SIGN_UP","FORGOTTEN","EDIT","User","firstName","substr","toUpperCase","lastName","UserService","setUser","user","user$_","forgot$","me$","busyMe","sessionUser","mapUser","signin$","signout$","_this3","signup$","_this4","edit$","_this5","editPassword$","accessData$","gdpr$","tryFacebook$","me","tryGoogle$","tryLinkedin$","sessionStorage$","mapUsers","users","AppComponent","_Component","onInit","getContext","classList","header","takeUntil","unsubscribe$","subscribe","setTimeout","checkUserMarket","cookie","onOpenMarketProposition","event","onOpenMarketAndLanguage","onLogin","view","onLogout","first","onProjectRegistration","onAddToCart","onOpenMiniCart","Component","selector","AltDirective","_Directive","onChanges","setAttribute","alt","Directive","inputs","ClickOutsideDirective","initialFocus","_getContext","parentInstance","event$","fromEvent","filter","contains","shareReplay","expression","outputFunction","makeFunction","clickOutside$","DatePipe","Intl","DateTimeFormat","DownloadDirective","download","LocomotiveScrollService","scroll","scroll$","init","useKeyboard","smoothMobile","inertia","smooth","lerp","getDirection","getSpeed","initClass","scrollingClass","draggingClass","smoothClass","scrollbarContainer","scrollbarClass","multiplier","firefoxMultiplier","touchMultiplier","scrollFromAnywhere","gestureDirection","reloadOnContextChange","resetNativeScroll","el","useLocomotiveScroll","instance","LocomotiveScroll","add","innerWidth","isTouchDevice","userAgent","navigator","toLowerCase","isTablet","test","isSmartphone","isMacLike","platform","isIOS","isMacOs","isSafari","vendor","init$","delay","on","speed","style","pointerEvents","direction","y","previousY","scrollTop","addEventListener","Math","abs","stop","start","scrollTo","offset","currentTop","distance","getBoundingClientRect","top","pow","gsap","scroll-behavior","disableLerp","duration","ease","Quad","easeOut","overwrite","onUpdate","onComplete","scrollToSelector","ReplaySubject","DROPDOWN_ID","DropdownDirective","trigger","opened","onClick","bind","onDocumentClick","openDropdown","closeDropdown","addListeners","dropdown$","addDocumentListeners","dropped","removeDocumentListeners","removeListeners","removeEventListener","onDestroy","nextId","dropdown","id_","outputs","DropdownItemDirective","enter$","leave$","EnvPipe","keypath","env","k","shift","FilterItemComponent","closeFilter","active","change","toggleFilter","filters","clearFilter","preventDefault","stopImmediatePropagation","clear","onEnter","onLeave","FlagPipe","HighlightPipe","escapedQuery","escapeRegexChars","regExp","RegExp","g1","g2","safeToString","trim","encodeHTML","decodeHTML","HtmlPipe","m","n","String","fromCharCode","parseInt","unescapes","rx","IdDirective","LabelForDirective","labelFor","LocomotiveScrollStickyDirective","args","concat","targetNode","until","sticky$","width","screen","nav","materials","secReserved","removeAttribute","footer","headerHeight","offsetHeight","topFooter","rect","bottom","innerHeight","sticked","height","min","sticked_","LocomotiveScrollToDirective","scrollTo$","_getContext2","LocomotiveScrollDirective","ResizeObserver","entries","observe","ScrollDirective","scrollSpeed","parseFloat","wh","currentY","getProperty","ModalOutletComponent","busy_","modalNode","busy","modal_","removeChild","appendChild","compile","NameDirective","NumberPipe","NumberFormat","RelativeDatePipe","numeric","date","formatter","RelativeTimeFormat","round","ShareDirective","share","open","encodeURI","encodeURIComponent","c","charCodeAt","facebookUrl","pinterestUrl","linkedInUrl","twitterUrl","whatsappUrl","mailToUrl","shareTitle","shareUrl","SlugPipe","SvgIconStructure","_Structure","name_","parentNode","_element$classList","element","createElementNS","w","h","setAttributeNS","rxcompId","replaceChild","Structure","UID","SwiperDirective","slidesPerView","spaceBetween","centeredSlides","keyboardControl","mousewheelControl","pagination","clickable","keyboard","enabled","onlyInViewport","init_","swiperInitOrUpdate_","removeListeners_","swiperDestroy_","onBeforePrint","slideToIndex","swiper","slideTo","hasPrev","activeIndex","slides","hasNext","slidePrev","slideNext","opacity","slideChange","realIndex","touchRatio","slideChangeTransitionStart","slideChangeTransitionEnd","addListeners_","onToggleVideo","onCheckAutoplay","slide","hasAttribute","getContextByNode","playVideo","play","pauseVideo","pause","clearTimeout","onNext","onThronReady","onThronComplete","navigation","nextEl","prevEl","callback","swiperDirectiveInit","Power2","Swiper","_opening","querySelectorAll","onLoad","destroy","matchMedia","matches","ThronService","thron$","THRONContentExperience","THRONPlayer","script","loaded$","head","ID","ThronComponent","THRON","media","splitted","controls","loop","autoplay","player","muted","displayLinked","noSkin","onReady","onCanPlay","onPlaying","onPlay","onPause","video","mediaContainer","ready","canPlay","off","qualities","qualityLevels","highestQuality","currentQuality","playing","complete","toggle","playing_","TitleDirective","title_","factories","pipes","CommonModule","_Module","Module","imports","declarations","ControlComponent","uid","label","control","ControlAutocompleteComponent","_ControlComponent","input","disabled","changes$","setInputValue","query$","distinctUntilChanged","setOption","onClickOutside","onReset","ControlCheckboxComponent","link$","anchors","anchor","stopPropagation","htmlDocument","DOMParser","parseFromString","abstract","description","KeyboardService","keydown$","keydown$_","keyup$","keyup$_","keys$","keys$_","type","startWith","key$","key$_","regexp","typing$","typing$_","typing","ControlCustomSelectComponent","dropdownId","word","scrollToWord","children","offsetTop","isMultiple","TypeError","_readOnlyError","hasOption","getLabel","v","onDropped","$event","touched","multiple","ControlEmailComponent","ControlFileComponent","file","onReaderComplete","onInputDidChange","files","lastModified","lastModifiedDate","size","reader","FileReader","readAsDataURL","content","result","ControlPasswordComponent","ControlPrivacyComponent","onSelect","ControlSearchComponent","onFocus","setSelectionRange","focus","ControlTextComponent","ControlTextareaComponent","ErrorsComponent","TestComponent","onTest","reset","ControlsModule","FilterMode","FilterItem","change$","mode","placeholder","values","unshift","hasAny","FilterService","initialParams","filter$","getParamsCount","locationParams","any","changes","filterItems","updateFilterStates","skipFilter","filteredItems","option","count","FiltersComponent","combineLatest","setFiltersParams","doFilterItem","city","countries","pageSize","visibleItems","FormGroup","FormControl","setFilterByKeyAndValue","finalize","filterService","patch","doSortItems","getVisibleItems","onLoaded","showMore","onSearch","model","onFilterDidChange","ProductsService","all$","listing$","listingId","filters$","sort$","sort","a","b","SHOP_OPTION_ID","ProductsComponent","_FiltersComponent","categoryId","subcategoryId","shop","category","subcategory","categories","subcategories","ambiences","designers","AmbienceService","AmbienceComponent","ambienceId","ambience","AteliersAndStoresService","AteliersAndStoresComponent","types","Atelier","Store","filteredAteliers","filteredStores","country","CareersModalComponent","position","onClose","GtmService","dataLayer","push_","FormService","toOptions","toSelectOptions","RequiredIfValidator","condition","FormValidator","Boolean","CareersService","positions$","submit$","CareersComponent","success","positions","isItaly","Validators","RequiredValidator","email","EmailValidator","telephone","region","domain","cv","presentationLetter","message","privacy","checkRequest","antiforgery","checkField","results","onSubmit","valid","submitted","friendlyMessage","form_name","onOpenPosition","close","OnceService","script$","callbackName","callback$","paths","callbacks$","async","scripts","getElementsByTagName","lastScript","insertBefore","nextSibling","FacebookService","facebook$","protocol","facebook_","concatMap","xfbml","AppEvents","logPageView","status$","getLoginStatus","authResponse_","authResponse","login$","login","logout$","logout","l","accessToken","facebookToken","GoogleService","google$","Observable","gapi","once$","profile","currentUser","getBasicProfile","getId","getName","getGivenName","getFamilyName","picture","getImageUrl","getEmail","googleToken","access_token","auth2Instance$","isSignedIn","signOut","signed","getAuth2$","_this6","auth2","auth2init$","load","_this7","readAccessToken","getAuthResponse","signIn","_this8","client_id","cookiepolicy","fetch_basic_profile","ux_mode","_this9","getAuthInstance","GoogleMapsService","maps$","maps","geocode$","Geocoder","geocode","getAutocompleteService","autocompleteService_","places","AutocompleteService","getPlaceService","placeService_","PlacesService","autocomplete$","autocompleteService","getPlacePredictions","predictions","PlacesServiceStatus","OK","prediction","place_id","getDetails","request","placeId","place","components","address_components","streetNumber","includes","streetNumberName","short_name","route","routeName","locality","localityName","postal_code","zipCode","cityName","province","provinceName","countryName","long_name","address","geometry","latitude","lat","longitude","lng","LinkedinService","getAccessToken$","grant_type","client_secret","redirect_uri","linkedin$","getTime","onSocialCallback","social","floor","OrdersService","detail$","orderId","CartComponent","orderBusy","steps","detectSocialLogin","checkPaymentParams","urlSearchParams","fromEntries","initWithData","errorDelivery","errorDiscount","errorPayment","readyToShip","socialBusy","guest","shipmentCountryOptions","countryOptions","deliveryData","billingData","delivery","discount","paymentMethod","hasInvoice","invoice","hasBilling","billing","hasStore","checkStoreTerms","store","shipmentCountry","invoiceData","taxNumber","sdi","pec","company","conditions","RequiredTrueValidator","newsletter","commercial","promotion","deliveryType","discountCode","stores","storeTerms","sortCountry","info","icons","getStepParam","onPatch","newUrl","onRevalidate","statusSubject","touchForm","firstInvalidInput","ecommstep","totalPrice","currency","revenue","skipUpdate","onAfterPatch","onItems","onUser","onIncrement","onDecrement","onRemove","onEdit","product_link","now","onModalSignIn","onModalSignUp","onGuest","onFacebookLogout","onSocialLogin","onFacebookLogin","onGoogleLogin","onLinkedinLogin","socialMe","mapMe","first_name","last_name","socialPicture","socialType","socialId","socialToken","socialTokenExpiresAt","data_access_expiration_time","expires_at","_this10","token","opener","onData","_this11","deliveryCountry","getCountryById","onGeocoder","billingCountry","countryId","testData","resetData","onDelivery","_this12","storeId","_this13","deliveryTypeOptions","fullPrice","onDiscountCode","_this14","onRecap","onTimetableToggle","selectedStore","showTimetable","testRecap","resetRecap","onPayment","_this15","redirectUrl","mp","transactionId","_this16","paymentMethodId","order","onOpenOrder","onRetry","total","_this17","CataloguesService","CataloguesComponent","ContactsService","ContactsComponent","hasNewsletter","newsletterLanguage","DealersService","regions","DealersComponent","DesignersService","DesignersComponent","GenericModalComponent","MagazineRequestModalComponent","MagazineRequestPropositionComponent","onOpen","MagazineRequestService","MagazineRequestComponent","regex","hasPrintedCopy","printedCopy","magazine","occupation","phoneNumber","onCountryDidChange","MagazineService","currentCaOrder","currentCaId","MagazineComponent","MarketsAndLanguagesService","currentCoId","MarketPropositionModalComponent","proposedMarket","proposedLanguage","setMarket","market","MarketsAndLanguagesModalComponent","MaterialsModalComponent","onPrev","MaterialsService","MaterialsComponent","selectedItem","onToggle","onOpenItem","marginBottom","setCategory","NewsService","NewsComponent","NewsletterService","NewsletterComponent","engagement","OrdersModalComponent","OrdersDetailComponent","OrdersComponent","orders","PressService","PressComponent","breadcumbStyle","ProductsConfigureComponent","sl","product","isReady","isComplete","isConfiguring","iframe","onEvent","sfy","SFYFrame","getIframeDocument","contentWindow","contentDocument","eventName","emit","onShowefyComplete","onStartConfigurator","onButtonPressed","onSetButtonStatus","onGetIframeSize","onGetProductExtData","onGetFastProductExtData","statusTxt","addButtons","getProductExtData","addTexts","HTML","printHTML","buttons","BUTTONS","PROPERTIES","visibility","LABEL","it","en","setButtonStatus","addBreadcrumb","breadcrumb","BREADCUMB","printBreadcumb","cartItem","product_code","productTitle","priceListByMarket","familyCode","ProductsDetailRequestModalComponent","ProductsDetailService","versions$","productId","ProductsDetailRequestComponent","reason","ProductsDetailComponent","pageCategory","isAddedToCart","firstConfigurableVersion","onRequestInfo","onReservedArea","ProjectsRegistrationModalComponent","ProjectsRegistrationService","ProjectsRegistrationComponent","dealer","fullName","client","architect","destination","products","isModal","ProjectsService","ProjectsComponent","FilesService","hasFile","currentFiles","setFiles","files$_","files$","localFiles","addFile$","removeFile$","ReservedAreaService","toTitleCase","all_$","added","sentence","seps","wordPattern","str","ReservedAreaComponent","tree","visibleFiles","downloadBusy","getTree","parentId","onToggleFile","isAddedToFiles","MapService","findNearStores","center","calculateDistance","calculateDistances","lat1","lon1","lat2","lon2","unit","radlat1","PI","radlat2","theta","radtheta","dist","sin","cos","acos","getBounds","Number","POSITIVE_INFINITY","bounds","LatLngBounds","LatLng","extend","StoreLocatorService","rank","StoreLocatorComponent","autocomplete","autocompleteSource$","setPlace","minimumBounds","doSortItemsByDistance","p1","lng2","p2","viewport","union","addListenerOnce","setZoom","getZoom","fitBounds","setCenter","doSortItemsByRank","ranks","9","8","10","11","categoryA","categorySort","countrNameA","countrNameB","cityNameA","cityNameB","onMapReady","mapController","onMapDidChange","hasGeolocation","geolocation","onGeolocation","getCurrentPosition","coords","extendStatics","d","hasOwnProperty","__extends","__","__assign","t","s","OverlayViewSafe","type1","type2","property","OverlayView","toCssText","styles","acc","coercePixels","pixels","ClusterIcon","_super","cluster_","styles_","center_","div_","sums_","visible_","setMap","getMap","onAdd","cMouseDownInCluster","cDraggingMapByCluster","mc","getMarkerClusterer","_a","major","minor","gmVersion","show","getPanes","overlayMouseTarget","boundsChangedListener_","addListener","addDomListener","getZoomOnClick","mz_1","getMaxZoom","theBounds_1","cancelBubble","hide","removeListener","clearInstanceListeners","draw","pos","getPosFromLatLng_","left","display","className","className_","cssText","createCss_","getImageElementHtml","getLabelDivHtml","getTitle","ariaLabelFn","anchorText_","color","textColor","font-size","textSize","font-family","fontFamily","font-weight","fontWeight","font-style","fontStyle","text-decoration","textDecoration","text-align","line-height","textLineHeight","bp","backgroundPosition","spriteH","spriteV","dimensions","getEnableRetinaIcons","clip","overrideDimensionsDynamicIcon","useStyle","sums","max","anchorText","anchorIcon_","anchorIcon","getClusterClass","z-index","getZIndex","cursor","-webkit-user-select","-khtml-user-select","-moz-user-select","-o-user-select","user-select","latlng","getProjection","fromLatLngToDivPixel","Cluster","markerClusterer_","map_","minClusterSize_","getMinimumClusterSize","averageCenter_","getAverageCenter","markers_","bounds_","clusterIcon_","getStyles","getSize","getMarkers","getCenter","markers","getPosition","addMarker","marker","isMarkerAlreadyAdded_","calculateBounds_","isAdded","mCount","mz","isMarkerInClusterBounds","getExtendedBounds","updateIcon","numStyles","getCalculator","getOption","prop","def","MarkerClusterer","clusters_","listeners_","activeMap_","ready_","zIndex_","zIndex","Marker","MAX_ZINDEX","gridSize_","gridSize","minimumClusterSize","maxZoom_","maxZoom","zoomOnClick_","ignoreHidden_","enableRetinaIcons_","imagePath_","imagePath","IMAGE_PATH","imageExtension_","imageExtension","IMAGE_EXTENSION","imageSizes_","imageSizes","IMAGE_SIZES","calculator_","calculator","CALCULATOR","batchSize_","batchSize","BATCH_SIZE","batchSizeIE_","batchSizeIE","BATCH_SIZE_IE","clusterClass_","clusterClass","setupStyles_","addMarkers","repaint","prevZoom_","minZoom","mapTypes","getMapTypeId","zoom","resetViewport_","redraw_","withDefaultStyle","fitMapToMarkers","padding","getVisible","getIgnoreHidden","getGridSize","setGridSize","setMinimumClusterSize","setMaxZoom","setZIndex","setStyles","setTitle","setZoomOnClick","zoomOnClick","setAverageCenter","averageCenter","setIgnoreHidden","ignoreHidden","setEnableRetinaIcons","enableRetinaIcons","getImageExtension","setImageExtension","getImagePath","setImagePath","getImageSizes","setImageSizes","setCalculator","getBatchSizeIE","setBatchSizeIE","setClusterClass","getTotalMarkers","getClusters","getTotalClusters","nodraw","pushMarkerTo_","getDraggable","removeMarker","removed","removeMarker_","removeMarkers","r","clearMarkers","oldClusters","projection","tr","getNorthEast","bl","getSouthWest","trPix","blPix","ne","fromDivPixelToLatLng","sw","createClusters_","distanceBetweenPoints_","dLat","dLon","atan2","sqrt","isMarkerInBounds_","addToClosestCluster_","clusterToAddTo","cluster","iFirst","mapBounds","timerRefStatic","iLast","dv","overrides","MAP_STYLE","featureType","elementType","stylers","saturation","lightness","MapComponent","mapOptions","gestureHandling","zoomControlOptions","ZoomControlStyle","DEFAULT","zoomControl","mapTypeControl","streetViewControl","rotateControl","fullscreenControl","mapElement","Map","getItalyBounds","wheel$","ctrlKey","markersDidChange","markerCluster","phone","fax","markerImage","MarkerImage","Size","icon","setMarkerWindow","sizes","getGeolocation","busyLocation","geocoder","filteredInfoCity","address_component","formatted_address","searchCountry","setInfoWindow","searchPosition","finally","ZOOM_LEVEL","setMinimumZoom","panTo","subscription","unsubscribe","markerWindow","InfoWindow","pixelOffset","setPosition","setContent","closeMarkerWindow","clickOutsideSelector","getWorldBounds","SwiperGalleryDirective","_SwiperDirective","SwiperHomepageDirective","SwiperNewsPropositionDirective","inHomepage","breakpoints","768","1024","1440","1920","loopAdditionalSlides","SwiperProductsPropositionDirective","SwiperProjectsPropositionDirective","CartMiniComponent","onBuy","onRemoveAll","ErrorComponent","showDetail","onDetailToggle","FilesComponent","showFiles","onToggleFiles","onDownloadAll","link","click","MenuService","setMenu","menu$_","toggleMenu","currentMenu","menu$","HeaderComponent","menu","pictogram","scrolled","isCart","direction_","scrolled_","MenuDirective","preview","previewSrc","container","menu_","onExit","NewsletterPropositionComponent","onNewsletter","action","SearchService","search$_","items_","search$","SearchComponent","auditTime","SubmenuDirective","onload","Power4","TreeComponent","hasItems","UserAccessDataComponent","password","newPassword","UserDeleteComponent","UserDetailComponent","occupations","newsletterLanguages","gdpr","datas","onModalUserUpdate","onModalGdpr","legalNote","occupationName","newsletterLanguageName","UserEditPasswordComponent","tokenEncoded","UserEditComponent","responseMessage","UserForgotComponent","forgot","onSignIn","viewSignIn","onSignUp","viewSignUp","UserComponent","views","skipAutoClose","setView","onViewSignIn","onViewSignUp","onViewForgot","navTo","onForgot","UserModalComponent","_UserComponent","UserSigninComponent","viewForgot","UserSignupComponent","fieldName","formGroup","passwordConfirm","field","signUp","SharedModule","AppModule","CoreModule","FormModule","bootstrap","Browser"],"mappings":"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","file":"docs\\js\\main.min.js","sourcesContent":[null,"import { from, Subject } from 'rxjs';\r\nimport { map, switchMap, tap } from 'rxjs/operators';\r\n\r\nexport class ModalEvent {\r\n\r\n\tconstructor(data) {\r\n\t\tthis.data = data;\r\n\t}\r\n\r\n}\r\n\r\n// export class ModalLoadEvent extends ModalEvent { }\r\n// export class ModalLoadedEvent extends ModalEvent { }\r\nexport class ModalResolveEvent extends ModalEvent { }\r\nexport class ModalRejectEvent extends ModalEvent { }\r\n\r\nexport class ModalService {\r\n\r\n\tstatic hasModal = false;\r\n\r\n\tstatic open$(modal) {\r\n\t\tthis.busy$.next(true);\r\n\t\treturn this.getTemplate$(modal.src).pipe(\r\n\t\t\t// startWith(new ModalLoadEvent(Object.assign({}, modal.data, { $src: modal.src }))),\r\n\t\t\tmap(template => {\r\n\t\t\t\treturn { node: this.getNode(template), data: modal.data, modal: modal };\r\n\t\t\t}),\r\n\t\t\ttap(node => {\r\n\t\t\t\tthis.modal$.next(node);\r\n\t\t\t\tthis.hasModal = true;\r\n\t\t\t\tthis.busy$.next(false);\r\n\t\t\t\t// this.events$.next(new ModalLoadedEvent(Object.assign({}, modal.data, { $src: modal.src })));\r\n\t\t\t}),\r\n\t\t\tswitchMap(node => this.events$),\r\n\t\t\ttap(_ => this.hasModal = false)\r\n\t\t)\r\n\t}\r\n\r\n\tstatic load$(modal) {\r\n\r\n\t}\r\n\r\n\tstatic getTemplate$(url) {\r\n\t\treturn from(fetch(url).then(response => {\r\n\t\t\treturn response.text();\r\n\t\t}));\r\n\t}\r\n\r\n\tstatic getNode(template) {\r\n\t\tconst div = document.createElement('div');\r\n\t\tdiv.innerHTML = template;\r\n\t\tconst node = div.firstElementChild;\r\n\t\treturn node;\r\n\t}\r\n\r\n\tstatic reject(data) {\r\n\t\tthis.modal$.next(null);\r\n\t\tthis.events$.next(new ModalRejectEvent(data));\r\n\t}\r\n\r\n\tstatic resolve(data) {\r\n\t\tthis.modal$.next(null);\r\n\t\tthis.events$.next(new ModalResolveEvent(data));\r\n\t}\r\n\r\n}\r\n\r\nModalService.modal$ = new Subject();\r\nModalService.events$ = new Subject();\r\nModalService.busy$ = new Subject();\r\n","\r\nexport class Utils {\r\n\r\n\tstatic merge(target, source) {\r\n\t\tif (typeof source === 'object') {\r\n\t\t\tObject.keys(source).forEach(key => {\r\n\t\t\t\tconst value = source[key];\r\n\t\t\t\tif (typeof value === 'object' && !Array.isArray(value)) {\r\n\t\t\t\t\ttarget[key] = this.merge(target[key], value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttarget[key] = value;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn target;\r\n\t}\r\n\r\n}\r\n","import { Utils } from './common/utils/utils';\r\nimport { environmentServed } from './environment.served';\r\nimport { environmentStatic } from './environment.static';\r\n\r\nexport const NODE = (typeof module !== 'undefined' && module.exports);\r\nexport const PARAMS = NODE ? { get: () => { } } : new URLSearchParams(window.location.search);\r\nexport const DEBUG = false || (PARAMS.get('debug') != null);\r\nexport const BASE_HREF = NODE ? null : document.querySelector('base').getAttribute('href');\r\nexport const HEROKU = NODE ? false : (window && window.location.host.indexOf('herokuapp') !== -1);\r\nexport const STATIC = NODE ? false : (HEROKU || (window && (window.location.port === '48481' || window.location.port === '5000' || window.location.port === '6443' || window.location.host === 'actarian.github.io')));\r\nexport const DEVELOPMENT = NODE ? false : (window && ['localhost', '127.0.0.1', '0.0.0.0'].indexOf(window.location.host.split(':')[0]) !== -1);\r\nexport const PRODUCTION = !DEVELOPMENT;\r\nexport const ENV = {\r\n\tSTATIC,\r\n\tDEVELOPMENT,\r\n\tPRODUCTION\r\n};\r\n\r\nexport class Environment {\r\n\r\n\tget STATIC() {\r\n\t\treturn ENV.STATIC;\r\n\t}\r\n\tset STATIC(STATIC) {\r\n\t\tENV.STATIC = (STATIC === true || STATIC === 'true');\r\n\t\tconsole.log('Environment.STATIC.set', ENV.STATIC);\r\n\t}\r\n\r\n\tget href() {\r\n\t\tif (HEROKU) {\r\n\t\t\treturn this.githubDocs;\r\n\t\t} else {\r\n\t\t\treturn BASE_HREF;\r\n\t\t}\r\n\t}\r\n\r\n\tgetAbsoluteUrl(path, params) {\r\n\t\tlet url = `${window.location.origin}${path}`;\r\n\t\t// let url = `${window.location.protocol}//${window.location.host}${path}`;\r\n\t\tObject.keys(params).forEach(key => {\r\n\t\t\turl = url.replace(`$${key}`, params[key]);\r\n\t\t});\r\n\t\treturn url;\r\n\t}\r\n\r\n\tgetPath(path) {\r\n\t\treturn this.isLocal(path) ? (this.href + path) : path;\r\n\t}\r\n\r\n\tisLocal(path) {\r\n\t\treturn path.indexOf('://') === -1;\r\n\t}\r\n\r\n\tconstructor(options) {\r\n\t\tif (options) {\r\n\t\t\tObject.assign(this, options);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst defaultOptions = {\r\n\tport: 5000,\r\n\tflags: {\r\n\t\tproduction: false,\r\n\t\theroku: HEROKU,\r\n\t},\r\n\tslug: {},\r\n\tmarkets: ['IT', 'EU', 'AM', 'AS', 'IN'],\r\n\tdefaultMarket: 'IT',\r\n\tcurrentMarket: 'IT',\r\n\tlanguages: ['it', 'en'],\r\n\tdefaultLanguage: 'it',\r\n\tcurrentLanguage: 'it',\r\n\tlabels: {\r\n\t\tselect: 'Seleziona',\r\n\t\tbrowse: 'Sfoglia',\r\n\t\tcancel: 'Annulla',\r\n\t\terror_email: 'Email non valida',\r\n\t\terror_phoneNumber: 'Inserire un numero di telefono nel formato +39-xxx-xxxxxxx',\r\n\t\terror_match: 'I campi non corrispondono',\r\n\t\terror_required: 'Campo obbligatorio',\r\n\t\tloading: 'caricamento',\r\n\t\tremove: 'Rimuovi',\r\n\t\trequired: 'Richiesto',\r\n\t\tselect_file: 'Seleziona una file...',\r\n\t\tupdate: 'Aggiorna',\r\n\t\tupload: 'Carica',\r\n\t\tdrag_and_drop_images: 'Drag And Drop your images here',\r\n\t}\r\n};\r\n\r\nconst environmentOptions = window.STATIC ? environmentStatic : environmentServed;\r\n\r\nlet options = Object.assign(defaultOptions, environmentOptions);\r\noptions = Utils.merge(options, window.environment);\r\n\r\nexport const environment = new Environment(options);\r\n\r\nif (window.STATIC) {\r\n\tconsole.log('environment', environment);\r\n}\r\n","\r\nexport const environmentStatic = {\r\n\tflags: {\r\n\t\tproduction: false,\r\n\t\tcart: true,\r\n\t},\r\n\tmarkets: ['IT', 'EU', 'AM', 'AS', 'IN'],\r\n\tdefaultMarket: 'IT',\r\n\tcurrentMarket: 'IT',\r\n\tuserCountry: 'IT',\r\n\tuserMarket: 'IT',\r\n\tlanguages: ['it', 'en', 'de', 'ch'],\r\n\tdefaultLanguage: 'it',\r\n\tcurrentLanguage: 'it',\r\n\tdetectedCountry: 'Italia',\r\n\tapi: '/giorgetti/api',\r\n\tassets: '/giorgetti/',\r\n\tslug: {\r\n\t\tconfigureProduct: `/giorgetti/products-configure.html`,\r\n\t\tcart: `/giorgetti/cart.html`,\r\n\t\treservedArea: `/giorgetti/reserved-area.html`,\r\n\t},\r\n\ttemplate: {\r\n\t\tmodal: {\r\n\t\t\tcareersModal: '/giorgetti/partials/modals/careers-modal.html',\r\n\t\t\tgenericModal: '/giorgetti/partials/modals/generic-modal.html',\r\n\t\t\tmagazineRequestModal: '/giorgetti/partials/modals/magazine-request-modal.html',\r\n\t\t\tmarketsAndLanguagesModal: '/giorgetti/partials/modals/markets-and-languages-modal.html',\r\n\t\t\tmarketPropositionModal: '/giorgetti/partials/modals/market-proposition-modal.html',\r\n\t\t\tmaterialsModal: '/giorgetti/partials/modals/materials-modal.html',\r\n\t\t\tordersModal: '/giorgetti/partials/modals/orders-modal.html',\r\n\t\t\tprojectsRegistrationModal: '/giorgetti/partials/modals/projects-registration-modal.html',\r\n\t\t\tuserModal: '/giorgetti/partials/modals/user-modal.html',\r\n\t\t\tproductsDetailRequestModal: '/giorgetti/partials/modals/products-detail-request-modal.html',\r\n\t\t}\r\n\t},\r\n\tfacebook: {\r\n\t\tappId: 610048027052371,\r\n\t\tfields: 'id,name,first_name,last_name,email,gender,picture,cover,link',\r\n\t\tscope: 'public_profile, email', // publish_stream\r\n\t\ttokenClient: '951b013fe59b05cf471d869aae9ba6ba',\r\n\t\tversion: 'v11.0',\r\n\t},\r\n\tgoogle: {\r\n\t\tclientId: '760742757246-61qknlmthbmr54bh7ch19kjr0sftm4q3.apps.googleusercontent.com',\r\n\t},\r\n\tlinkedIn: {\r\n\t\tclientId: '77cg5ls5lgu3k3',\r\n\t\tclientSecret: 'gfBIl365EdckxCgK',\r\n\t\tscope: 'r_emailaddress r_liteprofile',\r\n\t},\r\n\tgoogleMaps: {\r\n\t\tapiKey: 'AIzaSyDvGw6iAoKdRv8mmaC9GeT-LWLPQtA8p60',\r\n\t},\r\n\tthron: {\r\n\t\tclientId: '',\r\n\t},\r\n\tworkers: {\r\n\t\timage: './js/workers/image.service.worker.js',\r\n\t\tprefetch: './js/workers/prefetch.service.worker.js',\r\n\t},\r\n\tgithubDocs: 'https://raw.githubusercontent.com/actarian/giorgetti/main/docs/',\r\n};\r\n\r\n// AIzaSyAIsa4g8z-HPPwohsf8jzVTbKw-DiI8k5w\r\n","\r\nexport const environmentServed = {\r\n\tflags: {\r\n\t\tproduction: true,\r\n\t\tcart: true,\r\n\t},\r\n\tmarkets: ['IT', 'EU', 'AM', 'AS', 'IN'],\r\n\tdefaultMarket: 'IT',\r\n\tcurrentMarket: 'IT',\r\n\tuserCountry: 'IT',\r\n\tuserMarket: 'IT',\r\n\tlanguages: ['it', 'en', 'de', 'ch'],\r\n\tdefaultLanguage: 'it',\r\n\tcurrentLanguage: 'it',\r\n\tdetectedCountry: 'Italia',\r\n\tapi: '/api',\r\n\tassets: '/Client/docs/',\r\n\tslug: {\r\n\t\tconfigureProduct: `/it/it/products-configure`,\r\n\t\tcart: `/it/it/cart`,\r\n\t\treservedArea: `/it/it/reserved-area`,\r\n\t},\r\n\ttemplate: {\r\n\t\tmodal: {\r\n\t\t\tcareersModal: '/template/modals/careers-modal.cshtml',\r\n\t\t\tgenericModal: '/template/modals/generic-modal.cshtml',\r\n\t\t\tmagazineRequestModal: '/template/modals/magazine-request-modal.cshtml',\r\n\t\t\tmarketsAndLanguagesModal: '/template/modals/markets-and-languages-modal.cshtml',\r\n\t\t\tmarketPropositionModal: '/template/modals/market-proposition-modal.cshtml',\r\n\t\t\tmaterialsModal: '/template/modals/materials-modal.cshtml',\r\n\t\t\tordersModal: '/template/modals/orders-modal.cshtml',\r\n\t\t\tprojectsRegistrationModal: '/template/modals/projects-registration-modal.cshtml',\r\n\t\t\tuserModal: '/template/modals/user-modal.cshtml',\r\n\t\t\tproductsDetailRequestModal: '/template/modals/products-detail-request-modal.cshtml',\r\n\t\t}\r\n\t},\r\n\tfacebook: {\r\n\t\tappId: 610048027052371,\r\n\t\tfields: 'id,name,first_name,last_name,email,gender,picture,cover,link',\r\n\t\tscope: 'public_profile, email', // publish_stream\r\n\t\ttokenClient: '951b013fe59b05cf471d869aae9ba6ba',\r\n\t\tversion: 'v11.0',\r\n\t},\r\n\tgoogle: {\r\n\t\tclientId: '760742757246-61qknlmthbmr54bh7ch19kjr0sftm4q3.apps.googleusercontent.com',\r\n\t},\r\n\tlinkedIn: {\r\n\t\tclientId: '77cg5ls5lgu3k3',\r\n\t\tclientSecret: 'gfBIl365EdckxCgK',\r\n\t\tscope: 'r_emailaddress r_liteprofile',\r\n\t},\r\n\tgoogleMaps: {\r\n\t\tapiKey: 'AIzaSyByTXqwtyFUcD6d4PY7ab4GBwS5IYjEVcc',\r\n\t},\r\n\tthron: {\r\n\t\tclientId: '',\r\n\t},\r\n\tworkers: {\r\n\t\timage: '/Client/docs/js/workers/image.service.worker.js',\r\n\t\tprefetch: '/Client/docs/js/workers/prefetch.service.worker.js',\r\n\t},\r\n\tgithubDocs: 'https://raw.githubusercontent.com/actarian/giorgetti/main/docs/',\r\n};\r\n","import { from, throwError } from 'rxjs';\r\nimport { catchError } from 'rxjs/operators';\r\n\r\nexport class HttpResponse {\r\n\r\n\tget static() {\r\n\t\treturn this.url.indexOf('.json') === this.url.length - 5;\r\n\t}\r\n\r\n\tconstructor(response) {\r\n\t\tthis.data = null;\r\n\t\tif (response) {\r\n\t\t\tthis.url = response.url;\r\n\t\t\tthis.status = response.status;\r\n\t\t\tthis.statusText = response.statusText;\r\n\t\t\tthis.ok = response.ok;\r\n\t\t\tthis.redirected = response.redirected;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class HttpService {\r\n\r\n\tstatic http$(method, url, data, format = 'json', userPass = null, options = {}) {\r\n\t\tconst methods = ['POST', 'PUT', 'PATCH'];\r\n\t\tlet response_ = null;\r\n\t\t// url = this.getUrl(url, format);\r\n\t\toptions = Object.assign({\r\n\t\t\tmethod: method,\r\n\t\t\theaders: {\r\n\t\t\t\t'Accept': 'application/json',\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t},\r\n\t\t}, options, {\r\n\t\t\tbody: methods.indexOf(method) !== -1 ? JSON.stringify(data) : undefined\r\n\t\t});\r\n\t\tif (userPass) {\r\n\t\t\t// options.mode = 'no-cors';\r\n\t\t\toptions.credentials = 'include';\r\n\t\t\tuserPass = window.btoa(userPass);\r\n\t\t\toptions.headers['Authorization'] = `Basic ${userPass}`;\r\n\t\t}\r\n\t\toptions.headers = new Headers(options.headers);\r\n\t\treturn from(fetch(url, options).then((response) => {\r\n\t\t\tresponse_ = response;\r\n\t\t\t// console.log(response);\r\n\t\t\ttry {\r\n\t\t\t\tconst contentType = response.headers.get('content-type');\r\n\t\t\t\tlet typedResponse;\r\n\t\t\t\tif (contentType && contentType.indexOf('application/json') !== -1) {\r\n\t\t\t\t\ttypedResponse = response.json();\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttypedResponse = response.text();\r\n\t\t\t\t}\r\n\t\t\t\tif (response.ok) {\r\n\t\t\t\t\treturn typedResponse;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn typedResponse.then(data => {\r\n\t\t\t\t\t\treturn Promise.reject(data);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tif (response.ok) {\r\n\t\t\t\t\tconsole.warn('HttpService.http$', 'Cannot parse response');\r\n\t\t\t\t\treturn Promise.resolve();\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn Promise.reject(error);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})).pipe(\r\n\t\t\tcatchError(error => {\r\n\t\t\t\treturn throwError(this.getError(error, response_));\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\t/*\r\n\t// !!! todo mapping response.data\r\n\tstatic http$(method, url, data, format = 'json') {\r\n\t\tconst methods = ['POST', 'PUT', 'PATCH'];\r\n\t\tconst body = (data && methods.indexOf(method) !== -1) ? JSON.stringify(data) : undefined;\r\n\t\tconst queryString = (data && methods.indexOf(method) !== -1) ? Object.keys(data).map(function(key) {\r\n\t\t\treturn key + '=' + encodeURI(data[key]);\r\n\t\t}).join('&') : undefined;\r\n\t\tif (queryString) {\r\n\t\t\turl = `${url}?${queryString}`;\r\n\t\t}\r\n\t\tlet response_ = null;\r\n\t\treturn from(fetch(url, {\r\n\t\t\tmethod: method,\r\n\t\t\theaders: {\r\n\t\t\t\t'Accept': 'application/json',\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t},\r\n\t\t\tbody: body,\r\n\t\t}).then((response) => {\r\n\t\t\tresponse_ = new HttpResponse(response);\r\n\t\t\ttry {\r\n\t\t\t\tconst contentType = response.headers.get('content-type');\r\n\t\t\t\tlet typedResponse;\r\n\t\t\t\tif (contentType && format === 'json' && contentType.indexOf('application/json') !== -1) {\r\n\t\t\t\t\ttypedResponse = response.json();\r\n\t\t\t\t} else if (format === 'blob') {\r\n\t\t\t\t\ttypedResponse = response.blob();\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttypedResponse = response.text();\r\n\t\t\t\t}\r\n\t\t\t\treturn typedResponse.then(data => {\r\n\t\t\t\t\tresponse_.data = data;\r\n\t\t\t\t\tif (response.ok) {\r\n\t\t\t\t\t\treturn Promise.resolve(response_);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn Promise.reject(response_);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} catch(error) {\r\n\t\t\t\tif (response.ok) {\r\n\t\t\t\t\tconsole.warn('HttpService.http$', 'Cannot parse response');\r\n\t\t\t\t\treturn Promise.resolve(response_);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn Promise.reject(this.getError(error, response_));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})).pipe(\r\n\t\t\tcatchError(error => {\r\n\t\t\t\treturn throwError(this.getError(error, response_));\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\t*/\r\n\r\n\tstatic get$(url, data, format) {\r\n\t\tconst query = this.query(data);\r\n\t\treturn this.http$('GET', `${url}${query}`, undefined, format);\r\n\t}\r\n\r\n\tstatic delete$(url) {\r\n\t\treturn this.http$('DELETE', url);\r\n\t}\r\n\r\n\tstatic post$(url, data) {\r\n\t\treturn this.http$('POST', url, data);\r\n\t}\r\n\r\n\tstatic put$(url, data) {\r\n\t\treturn this.http$('PUT', url, data);\r\n\t}\r\n\r\n\tstatic patch$(url, data) {\r\n\t\treturn this.http$('PATCH', url, data);\r\n\t}\r\n\r\n\tstatic query(data) {\r\n\t\treturn ''; // todo\r\n\t}\r\n\r\n\tstatic getError(object, response) {\r\n\t\tlet error = typeof object === 'object' ? object : {};\r\n\t\tif (!error.status) {\r\n\t\t\terror.status = response ? response.status : 0;\r\n\t\t}\r\n\t\tif (!error.statusCode) {\r\n\t\t\terror.statusCode = response ? response.status : 0;\r\n\t\t}\r\n\t\tif (!error.statusMessage) {\r\n\t\t\terror.statusMessage = response ? response.statusText : object;\r\n\t\t}\r\n\t\t// console.log('HttpService.getError', error, response);\r\n\t\treturn error;\r\n\t}\r\n\r\n}\r\n","import { Pipe } from 'rxcomp';\r\nimport { environment } from '../../environment';\r\nimport { Utils } from '../utils/utils';\r\n\r\nexport class LabelPipe extends Pipe {\r\n\r\n\tstatic transform(key) {\r\n\t\tconst labels = LabelPipe.labels_;\r\n\t\treturn labels[key] || key; // `#${key}#`;\r\n\t}\r\n\r\n\tstatic getKeys(...keys) {\r\n\t\treturn LabelPipe.transform(keys.map(x => x.replace('-', '_')).join('_'));\r\n\t}\r\n\r\n\tstatic setLabels() {\r\n\t\tconst LABELS = Utils.merge({\r\n\t\t\tselect: 'Seleziona',\r\n\t\t\tbrowse: 'Sfoglia',\r\n\t\t\tcancel: 'Annulla',\r\n\t\t\terror_email: 'Email non valida',\r\n\t\t\terror_phoneNumber: 'Inserire un numero di telefono nel formato +39-xxx-xxxxxxx',\r\n\t\t\terror_match: 'I campi non corrispondono',\r\n\t\t\terror_required: 'Campo obbligatorio',\r\n\t\t\tloading: 'caricamento',\r\n\t\t\tremove: 'Rimuovi',\r\n\t\t\trequired: 'Richiesto',\r\n\t\t\tselect_file: 'Seleziona una file...',\r\n\t\t\tupdate: 'Aggiorna',\r\n\t\t\tupload: 'Carica',\r\n\t\t\tdrag_and_drop_images: 'Drag And Drop your images here',\r\n\t\t}, environment.labels);\r\n\t\tthis.labels_ = LABELS;\r\n\t}\r\n}\r\n\r\nLabelPipe.setLabels();\r\n\r\nLabelPipe.meta = {\r\n\tname: 'label',\r\n};\r\n","export class LocationService {\r\n\r\n\tstatic has(key) {\r\n\t\tconst params = new URLSearchParams(window.location.search);\r\n\t\t// console.log('LocationService.has', params);\r\n\t\treturn params.has(key);\r\n\t}\r\n\r\n\tstatic get(key) {\r\n\t\tconst params = new URLSearchParams(window.location.search);\r\n\t\t// console.log('LocationService.get', params);\r\n\t\treturn params.get(key);\r\n\t}\r\n\r\n\tstatic set(keyOrValue, value) {\r\n\t\tconst params = new URLSearchParams(window.location.search);\r\n\t\tif (typeof keyOrValue === 'string') {\r\n\t\t\tparams.set(keyOrValue, value);\r\n\t\t} else {\r\n\t\t\tparams.set(keyOrValue, '');\r\n\t\t}\r\n\t\tthis.pushParams(params);\r\n\t\t// console.log('LocationService.set', params, keyOrValue, value);\r\n\t}\r\n\r\n\tstatic pushParams(params) {\r\n\t\tif (window.history && window.history.pushState) {\r\n\t\t\tconst title = document.title;\r\n\t\t\tconst url = `${window.location.href.split('?')[0]}?${params.toString()}`;\r\n\t\t\twindow.history.pushState(params.toString(), title, url);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic replace(from, to) {\r\n\t\tconst history = window.history;\r\n\t\tif (history && history.replaceState) {\r\n\t\t\tconst location = window.location;\r\n\t\t\tconst title = document.title;\r\n\t\t\tif (location.pathname === '/') {\r\n\t\t\t\tconst url = location.origin + to + location.search;\r\n\t\t\t\thistory.replaceState(history.state, title, url);\r\n\t\t\t} else if (location.href.indexOf(from) !== -1) {\r\n\t\t\t\tconst url = location.href.replace(from, to);\r\n\t\t\t\thistory.replaceState(history.state, title, url);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tstatic deserialize(key) {\r\n\t\tconst encoded = this.get('params');\r\n\t\treturn this.decode(key, encoded);\r\n\t}\r\n\r\n\tstatic serialize(keyOrValue, value) {\r\n\t\tconst params = this.deserialize();\r\n\t\tconst encoded = this.encode(keyOrValue, value, params);\r\n\t\tthis.set('params', encoded);\r\n\t}\r\n\r\n\tstatic decode(key, encoded) {\r\n\t\tlet decoded = null;\r\n\t\tif (encoded) {\r\n\t\t\tconst json = window.atob(encoded);\r\n\t\t\tdecoded = JSON.parse(json);\r\n\t\t}\r\n\t\tif (key && decoded) {\r\n\t\t\tdecoded = decoded[key];\r\n\t\t}\r\n\t\treturn decoded || null;\r\n\t}\r\n\r\n\tstatic encode(keyOrValue, value, params) {\r\n\t\tparams = params || {};\r\n\t\tlet encoded = null;\r\n\t\tif (typeof keyOrValue === 'string') {\r\n\t\t\tparams[keyOrValue] = value;\r\n\t\t} else {\r\n\t\t\tparams = keyOrValue;\r\n\t\t}\r\n\t\tconst json = JSON.stringify(params);\r\n\t\tencoded = window.btoa(json);\r\n\t\treturn encoded;\r\n\t}\r\n\r\n}\r\n","import { from } from 'rxjs';\r\nimport { tap } from 'rxjs/operators';\r\nimport { environment } from '../../environment';\r\nimport { LabelPipe } from '../label/label.pipe';\r\nimport { LocationService } from '../location/location.service';\r\nimport { Utils } from '../utils/utils';\r\n\r\nexport class LanguageService {\r\n\r\n\tstatic languages = this.getDefaultLanguages();\r\n\tstatic defaultLanguage = this.getDefaultLanguage();\r\n\tstatic selectedLanguage = this.defaultLanguage;\r\n\r\n\tstatic get hasLanguages() {\r\n\t\treturn this.languages.length > 1;\r\n\t}\r\n\r\n\tstatic get activeLanguage() {\r\n\t\treturn this.languages.find(language => language.lang === this.selectedLanguage);\r\n\t}\r\n\r\n\tstatic getDefaultLanguages() {\r\n\t\treturn environment.alternates || [];\r\n\t}\r\n\r\n\tstatic getDefaultLanguage() {\r\n\t\treturn environment.defaultLanguage || (this.languages ? this.languages[0].lang : null);\r\n\t}\r\n\r\n\tstatic setLanguage(language) {\r\n\t\tthis.selectedLanguage = language.lang;\r\n\t}\r\n\r\n\tstatic setLanguage$(language) {\r\n\t\treturn from(fetch(language.href).then(response => {\r\n\t\t\treturn response.text();\r\n\t\t})).pipe(\r\n\t\t\ttap(html => {\r\n\t\t\t\t// console.log('html', html);\r\n\t\t\t\tconst labelsMatch = /(window\\.labels\\s*=\\s*\\n*\\s*\\{((\\{.+?\\})|.)+?\\})/gms.exec(html);\r\n\t\t\t\tif (labelsMatch) {\r\n\t\t\t\t\t// console.log('labels', labelsMatch[0]);\r\n\t\t\t\t\tnew Function(labelsMatch[0]).call(window);\r\n\t\t\t\t\tLabelPipe.setLabels();\r\n\t\t\t\t}\r\n\t\t\t\tconst bhereMatch = /(window\\.bhere\\s*=\\s*\\n*\\s*\\{((\\{.+?\\})|.)+?\\})/gms.exec(html);\r\n\t\t\t\tif (bhereMatch) {\r\n\t\t\t\t\t// console.log('bhere', bhereMatch[0]);\r\n\t\t\t\t\tconst data = {};\r\n\t\t\t\t\tnew Function(bhereMatch[0].replace('window', 'this')).call(data);\r\n\t\t\t\t\tif (data.bhere) {\r\n\t\t\t\t\t\tUtils.merge(environment, data.bhere);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tLocationService.replace(this.activeLanguage.href, language.href);\r\n\t\t\t\t// console.log(window.labels);\r\n\t\t\t\tthis.selectedLanguage = language.lang;\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n\tstatic toggleLanguages() {\r\n\t\tthis.showLanguages = !this.showLanguages;\r\n\t\tthis.pushChanges();\r\n\t}\r\n\r\n}\r\n","import { environment } from '../../environment';\r\nimport { HttpService } from '../http/http.service';\r\nimport { LanguageService } from '../language/language.service';\r\n\r\nexport class ApiService extends HttpService {\r\n\r\n\tstatic currentLanguage = LanguageService.activeLanguage;\r\n\r\n\tstatic get$(url, data, format) {\r\n\t\treturn super.get$(`${environment.api}${url}`, data, format);\r\n\t}\r\n\r\n\tstatic delete$(url) {\r\n\t\treturn super.delete$(`${environment.api}${url}`);\r\n\t}\r\n\r\n\tstatic post$(url, data) {\r\n\t\treturn super.post$(`${environment.api}${url}`, data);\r\n\t}\r\n\r\n\tstatic put$(url, data) {\r\n\t\treturn super.put$(`${environment.api}${url}`, data);\r\n\t}\r\n\r\n\tstatic patch$(url, data) {\r\n\t\treturn super.patch$(`${environment.api}${url}`, data);\r\n\t}\r\n}\r\n","export class LocalStorageService {\r\n\r\n\tstatic delete(name) {\r\n\t\tif (this.isLocalStorageSupported()) {\r\n\t\t\twindow.localStorage.removeItem(name);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic exist(name) {\r\n\t\tif (this.isLocalStorageSupported()) {\r\n\t\t\treturn window.localStorage[name] !== undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic get(name) {\r\n\t\tlet value = null;\r\n\t\tif (this.isLocalStorageSupported() && window.localStorage[name] !== undefined) {\r\n\t\t\ttry {\r\n\t\t\t\tvalue = JSON.parse(window.localStorage[name]);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log('LocalStorageService.get.error parsing', name, e);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\tstatic set(name, value) {\r\n\t\tif (this.isLocalStorageSupported()) {\r\n\t\t\ttry {\r\n\t\t\t\tconst cache = [];\r\n\t\t\t\tconst json = JSON.stringify(value, function(key, value) {\r\n\t\t\t\t\tif (typeof value === 'object' && value !== null) {\r\n\t\t\t\t\t\tif (cache.indexOf(value) !== -1) {\r\n\t\t\t\t\t\t\t// Circular reference found, discard key\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcache.push(value);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn value;\r\n\t\t\t\t});\r\n\t\t\t\twindow.localStorage.setItem(name, json);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log('LocalStorageService.set.error serializing', name, value, e);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tstatic isLocalStorageSupported() {\r\n\t\tif (this.supported) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tlet supported = false;\r\n\t\ttry {\r\n\t\t\tsupported = 'localStorage' in window && window.localStorage !== null;\r\n\t\t\tif (supported) {\r\n\t\t\t\twindow.localStorage.setItem('test', '1');\r\n\t\t\t\twindow.localStorage.removeItem('test');\r\n\t\t\t} else {\r\n\t\t\t\tsupported = false;\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tsupported = false;\r\n\t\t}\r\n\t\tthis.supported = supported;\r\n\t\treturn supported;\r\n\t}\r\n}\r\n","import { BehaviorSubject } from 'rxjs';\r\n\r\nexport class HeaderService {\r\n\r\n\tstatic header$_ = new BehaviorSubject(-1);\r\n\r\n\tstatic get currentHeader() {\r\n\t\treturn this.header$_.getValue();\r\n\t}\r\n\r\n\tstatic setHeader(id) {\r\n\t\tthis.header$_.next(id);\r\n\t}\r\n\r\n\tstatic toggleHeader(id) {\r\n\t\tthis.header$_.next(this.currentHeader === id ? -1 : id);\r\n\t}\r\n\r\n\tstatic onBack() {\r\n\t\tthis.header$_.next(-1);\r\n\t}\r\n\r\n\tstatic header$() {\r\n\t\treturn this.header$_;\r\n\t}\r\n\r\n}\r\n","import { BehaviorSubject, of } from 'rxjs';\r\nimport { map, switchMap, tap } from 'rxjs/operators';\r\nimport { ApiService } from '../../common/api/api.service';\r\nimport { LocalStorageService } from '../../common/storage/local-storage.service';\r\nimport { environment } from '../../environment';\r\nimport { HeaderService } from '../header/header.service';\r\n\r\nexport class CartMiniService {\r\n\r\n\tstatic get STORAGE_KEY() {\r\n\t\treturn `cartItems_${environment.currentMarket}`;\r\n\t}\r\n\r\n\tstatic get STORAGE_PENDING_KEY() {\r\n\t\treturn `cartItems_pending_${environment.currentMarket}`;\r\n\t}\r\n\r\n\tstatic items$_ = new BehaviorSubject([]);\r\n\r\n\tstatic get currentItems() {\r\n\t\treturn CartMiniService.items$_.getValue();\r\n\t}\r\n\r\n\tstatic get count() {\r\n\t\treturn CartMiniService.currentItems.length;\r\n\t}\r\n\r\n\tstatic hasItem(item) {\r\n\t\tconst items = CartMiniService.currentItems;\r\n\t\tconst index = CartMiniService.indexOf(item, items);\r\n\t\treturn index !== -1;\r\n\t}\r\n\r\n\tstatic setItems(items, skip) {\r\n\t\tif (items) {\r\n\t\t\tLocalStorageService.set(CartMiniService.STORAGE_KEY, items);\r\n\t\t} else {\r\n\t\t\tLocalStorageService.delete(CartMiniService.STORAGE_KEY);\r\n\t\t}\r\n\t\tif (!skip) {\r\n\t\t\tCartMiniService.items$_.next(items);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic setPendingItems(items) {\r\n\t\tif (items) {\r\n\t\t\tLocalStorageService.set(CartMiniService.STORAGE_PENDING_KEY, items);\r\n\t\t\tLocalStorageService.delete(CartMiniService.STORAGE_KEY);\r\n\t\t} else {\r\n\t\t\tLocalStorageService.delete(CartMiniService.STORAGE_PENDING_KEY);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic resumePendingItems() {\r\n\t\tconst items = LocalStorageService.get(CartMiniService.STORAGE_PENDING_KEY);\r\n\t\tif (items) {\r\n\t\t\tthis.setPendingItems(null);\r\n\t\t\tthis.setItems(items);\r\n\t\t}\r\n\t\treturn items;\r\n\t}\r\n\r\n\tstatic items$() {\r\n\t\tconst localItems = LocalStorageService.get(CartMiniService.STORAGE_KEY) || [];\r\n\t\treturn of(localItems).pipe(\r\n\t\t\tswitchMap(items => {\r\n\t\t\t\tCartMiniService.setItems(items);\r\n\t\t\t\treturn CartMiniService.items$_;\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tstatic incrementItem$(item) {\r\n\t\treturn of(item).pipe(\r\n\t\t\tmap(item => {\r\n\t\t\t\tconst items = CartMiniService.currentItems.slice();\r\n\t\t\t\tconst item_ = CartMiniService.find(item, items);\r\n\t\t\t\tif (item_) {\r\n\t\t\t\t\titem_.qty++;\r\n\t\t\t\t\tCartMiniService.setItems(items);\r\n\t\t\t\t\treturn item_;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t)\r\n\t}\r\n\r\n\tstatic decrementItem$(item) {\r\n\t\treturn of(item).pipe(\r\n\t\t\tswitchMap(item => {\r\n\t\t\t\tconst items = CartMiniService.currentItems.slice();\r\n\t\t\t\tconst item_ = CartMiniService.find(item, items);\r\n\t\t\t\tif (item_) {\r\n\t\t\t\t\titem_.qty--;\r\n\t\t\t\t\tif (item_.qty > 0) {\r\n\t\t\t\t\t\tCartMiniService.setItems(items);\r\n\t\t\t\t\t\treturn of(item_);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn CartMiniService.removeItem$(item);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn of(null);\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t)\r\n\t}\r\n\r\n\tstatic addItem$(item, qty = 1) {\r\n\t\t// const count = CartMiniService.count;\r\n\t\treturn of(Object.assign({}, item, { qty })).pipe(\r\n\t\t\tmap(item => {\r\n\t\t\t\tconst items = CartMiniService.currentItems.slice();\r\n\t\t\t\tconst item_ = CartMiniService.find(item, items);\r\n\t\t\t\tif (item_) {\r\n\t\t\t\t\titem_.qty += item.qty;\r\n\t\t\t\t\titem_.price = item.price;\r\n\t\t\t\t\tCartMiniService.setItems(items);\r\n\t\t\t\t\treturn item_;\r\n\t\t\t\t} else {\r\n\t\t\t\t\titems.push(item);\r\n\t\t\t\t\tCartMiniService.setItems(items);\r\n\t\t\t\t\treturn item;\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttap(_ => {\r\n\t\t\t\t// if (count === 0) {\r\n\t\t\t\tHeaderService.setHeader('cart');\r\n\t\t\t\t// }\r\n\t\t\t}),\r\n\t\t)\r\n\t}\r\n\r\n\tstatic removeItem$(item) {\r\n\t\treturn of(item).pipe(\r\n\t\t\tmap(item => {\r\n\t\t\t\tconst items = CartMiniService.currentItems.slice();\r\n\t\t\t\tconst index = CartMiniService.indexOf(item, items);\r\n\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\titems.splice(index, 1);\r\n\t\t\t\t\tif (items.length === 0) {\r\n\t\t\t\t\t\tHeaderService.onBack();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tCartMiniService.setItems(items);\r\n\t\t\t\t\treturn item;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t)\r\n\t}\r\n\r\n\tstatic removeAll$() {\r\n\t\treturn of([]).pipe(\r\n\t\t\tmap(items => {\r\n\t\t\t\tHeaderService.onBack();\r\n\t\t\t\tCartMiniService.setItems(items);\r\n\t\t\t\treturn items;\r\n\t\t\t}),\r\n\t\t)\r\n\t}\r\n\r\n\tstatic getPrice$(item) {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.post$('/cart-mini/price', item);\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/cart-mini/price.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic getPriceAndAddItem$(item, qty = 1) {\r\n\t\treturn CartMiniService.getPrice$(item).pipe(\r\n\t\t\tswitchMap(item => CartMiniService.addItem$(item, qty)),\r\n\t\t);\r\n\t}\r\n\r\n\tstatic match(item, item_) {\r\n\t\treturn item_.id === item.id && item_.code === item.code && ((!item_.showefy && !item.showefy) || (item_.showefy && item.showefy && item_.showefy.internalstr === item.showefy.internalstr));\r\n\t}\r\n\r\n\tstatic find(item, items) {\r\n\t\treturn items.find(item_ => CartMiniService.match(item, item_));\r\n\t}\r\n\r\n\tstatic indexOf(item, items) {\r\n\t\treturn items.reduce((p, item_, i) => {\r\n\t\t\treturn p !== -1 ? p : (CartMiniService.match(item, item_) ? i : p);\r\n\t\t}, -1);\r\n\t}\r\n}\r\n","import { BehaviorSubject, of } from 'rxjs';\r\nimport { map, switchMap, tap } from 'rxjs/operators';\r\nimport { ApiService } from '../../common/api/api.service';\r\nimport { LocalStorageService } from '../../common/storage/local-storage.service';\r\nimport { environment } from '../../environment';\r\nimport { CartMiniService } from '../../shared/cart-mini/cart-mini.service';\r\n\r\nexport const CartSteps = {\r\n\tNone: 0,\r\n\tItems: 1,\r\n\tData: 2,\r\n\tDelivery: 3,\r\n\tRecap: 4,\r\n\tPayment: 5,\r\n\tComplete: 6,\r\n\tError: -1,\r\n};\r\n\r\n/*\r\nexport class Cart {\r\n\tconstructor() {\r\n\t\tthis.step = CartSteps.Items; // number\r\n\t\tthis.items = []; // CartItem[]\r\n\t\tthis.shipmentCountry = null; // number\r\n\t\tthis.user = null; // User\r\n\t\tthis.guest = null; // boolean\r\n\t\tthis.data = {\r\n\t\t\tfirstName: null, // string\r\n\t\t\tlastName: null, // string\r\n\t\t\temail: null, // string\r\n\t\t\ttelephone: null, // string\r\n\t\t\taddress: null, // string\r\n\t\t\tzipCode: null, // string\r\n\t\t\tcity: null, // string\r\n\t\t\tprovince: null, // string\r\n\t\t\tcountry: null, // number\r\n\t\t\tmessage: null, // string\r\n\t\t\tinvoice: null, // boolean\r\n\t\t\tinvoiceData: {\r\n\t\t\t\ttaxNumber: null, // string\r\n\t\t\t\tsdi: null, // string\r\n\t\t\t\tpec: null, // string\r\n\t\t\t},\r\n\t\t\tbilling: null, // boolean\r\n\t\t\tbillingData: {\r\n\t\t\t\tcompany: null, // string\r\n\t\t\t\tfirstName: null, // string\r\n\t\t\t\tlastName: null, // string\r\n\t\t\t\ttelephone: null, // string\r\n\t\t\t\taddress: null, // string\r\n\t\t\t\tzipCode: null, // string\r\n\t\t\t\tcity: null, // string\r\n\t\t\t\tprovince: null, // string\r\n\t\t\t\tcountry: null, // number\r\n\t\t\t},\r\n\t\t\tconditions: false, // boolean\r\n\t\t\tprivacy: false, // boolean\r\n\t\t\tterms: false, // boolean\r\n\t\t};\r\n\t\tthis.deliveryData = null; // {\r\n\t\t\tfirstName: null, // string\r\n\t\t\tlastName: null, // string\r\n\t\t\temail: null, // string\r\n\t\t\ttelephone: null, // string\r\n\t\t\taddress: null, // string\r\n\t\t\tzipCode: null, // string\r\n\t\t\tcity: null, // string\r\n\t\t\tprovince: null, // string\r\n\t\t\tcountry: null, // { id: number, name: string }\r\n\t\t}\r\n\t\tthis.billingData = null; // {\r\n\t\t\tfirstName: null, // string\r\n\t\t\tlastName: null, // string\r\n\t\t\taddress: null, // string\r\n\t\t\tzipCode: null, // string\r\n\t\t\tcity: null, // string\r\n\t\t\tprovince: null, // string\r\n\t\t\tcountry: null, // { id: number, name: string }\r\n\t\t}\r\n\t\tthis.deliveryType = null; // number\r\n\t\tthis.delivery = null; // { id: number, name: string }\r\n\t\tthis.discountCode = null; // string\r\n\t\tthis.discount = null; // { code: string, price: number }\r\n\t\tthis.paymentMethod = null; // number\r\n\t\tthis.store = null; // Store\r\n\t}\r\n}\r\n*/\r\n\r\nexport class CartService {\r\n\r\n\tstatic get STORAGE_KEY() {\r\n\t\treturn `cart_${environment.currentMarket}`;\r\n\t}\r\n\r\n\tstatic get STORAGE_PENDING_KEY() {\r\n\t\treturn `cart_pending_${environment.currentMarket}`;\r\n\t}\r\n\r\n\tstatic cart$_ = new BehaviorSubject(null);\r\n\r\n\tstatic get currentCart() {\r\n\t\treturn CartService.cart$_.getValue();\r\n\t}\r\n\r\n\tstatic setStep(step) {\r\n\t\tconst cart = CartService.currentCart;\r\n\t\tif (cart) {\r\n\t\t\tcart.step = step;\r\n\t\t\tCartService.setCart(cart);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic setCart(cart, skip) {\r\n\t\tif (cart) {\r\n\t\t\tLocalStorageService.set(CartService.STORAGE_KEY, cart);\r\n\t\t} else {\r\n\t\t\tLocalStorageService.delete(CartService.STORAGE_KEY);\r\n\t\t}\r\n\t\tif (!skip) {\r\n\t\t\tCartService.cart$_.next(cart);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic setPendingCart(cart) {\r\n\t\tif (cart) {\r\n\t\t\tLocalStorageService.set(CartService.STORAGE_PENDING_KEY, cart);\r\n\t\t\tLocalStorageService.delete(CartService.STORAGE_KEY);\r\n\t\t} else {\r\n\t\t\tLocalStorageService.delete(CartService.STORAGE_PENDING_KEY);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic hasPendingCart() {\r\n\t\tconst cart = LocalStorageService.get(CartService.STORAGE_PENDING_KEY);\r\n\t\treturn cart != null;\r\n\t}\r\n\r\n\tstatic resumePendingCart() {\r\n\t\tconst cart = LocalStorageService.get(CartService.STORAGE_PENDING_KEY);\r\n\t\tif (cart) {\r\n\t\t\tthis.setPendingCart(null);\r\n\t\t\tthis.setCart(cart);\r\n\t\t}\r\n\t\treturn cart;\r\n\t}\r\n\r\n\tstatic cart$() {\r\n\t\tconst localCart = LocalStorageService.get(CartService.STORAGE_KEY) || null;\r\n\t\treturn of(localCart).pipe(\r\n\t\t\tswitchMap(cart => {\r\n\t\t\t\tCartService.setCart(cart);\r\n\t\t\t\treturn CartService.cart$_;\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tstatic clear$() {\r\n\t\treturn of(null).pipe(\r\n\t\t\tmap(cart => {\r\n\t\t\t\tCartMiniService.setItems([]);\r\n\t\t\t\tCartService.setCart(cart);\r\n\t\t\t\treturn cart;\r\n\t\t\t}),\r\n\t\t)\r\n\t}\r\n\r\n\tstatic data$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/cart/data');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/cart/data.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic estimatedDelivery$(cart) {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.post$('/cart/estimated-delivery', cart);\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/cart/estimated-delivery.json').pipe(\r\n\t\t\t\tmap(x => {\r\n\t\t\t\t\tlet estimatedDelivery = new Date();\r\n\t\t\t\t\testimatedDelivery.setDate(estimatedDelivery.getDate() + 0);\r\n\t\t\t\t\tx.estimatedDelivery = estimatedDelivery;\r\n\t\t\t\t\treturn x;\r\n\t\t\t\t}),\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic getDeliveryType$(cart) {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.post$('/cart/delivery-type', cart);\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/cart/delivery-type.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic getStores$(cart) {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.post$('/cart/stores', cart);\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/cart/stores.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic getDiscount$(payload) {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.post$('/cart/discount', payload);\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/cart/discount.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic doPayment$(cart) {\r\n\t\treturn (environment.flags.production ? ApiService.post$('/cart/payment', cart) : ApiService.get$('/cart/payment.json')).pipe(\r\n\t\t\ttap(_ => {\r\n\t\t\t\t// setting local storage pending payment\r\n\t\t\t\tCartMiniService.setPendingItems(CartMiniService.currentItems);\r\n\t\t\t\tCartService.setPendingCart(CartService.currentCart);\r\n\t\t\t}),\r\n\t\t)\r\n\t}\r\n}\r\n","export class SessionStorageService {\r\n\r\n\tstatic delete(name) {\r\n\t\tif (this.isSessionStorageSupported()) {\r\n\t\t\twindow.sessionStorage.removeItem(name);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic exist(name) {\r\n\t\tif (this.isSessionStorageSupported()) {\r\n\t\t\treturn window.sessionStorage[name] !== undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic get(name) {\r\n\t\tlet value = null;\r\n\t\tif (this.isSessionStorageSupported() && window.sessionStorage[name] !== undefined) {\r\n\t\t\ttry {\r\n\t\t\t\tvalue = JSON.parse(window.sessionStorage[name]);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log('SessionStorageService.get.error parsing', name, e);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\tstatic set(name, value) {\r\n\t\tif (this.isSessionStorageSupported()) {\r\n\t\t\ttry {\r\n\t\t\t\tconst cache = [];\r\n\t\t\t\tconst json = JSON.stringify(value, function(key, value) {\r\n\t\t\t\t\tif (typeof value === 'object' && value !== null) {\r\n\t\t\t\t\t\tif (cache.indexOf(value) !== -1) {\r\n\t\t\t\t\t\t\t// Circular reference found, discard key\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcache.push(value);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn value;\r\n\t\t\t\t});\r\n\t\t\t\twindow.sessionStorage.setItem(name, json);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.log('SessionStorageService.set.error serializing', name, value, e);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tstatic isSessionStorageSupported() {\r\n\t\tif (this.supported) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tlet supported = false;\r\n\t\ttry {\r\n\t\t\tsupported = 'sessionStorage' in window && window.sessionStorage !== null;\r\n\t\t\tif (supported) {\r\n\t\t\t\twindow.sessionStorage.setItem('test', '1');\r\n\t\t\t\twindow.sessionStorage.removeItem('test');\r\n\t\t\t} else {\r\n\t\t\t\tsupported = false;\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tsupported = false;\r\n\t\t}\r\n\t\tthis.supported = supported;\r\n\t\treturn supported;\r\n\t}\r\n}\r\n","import { BehaviorSubject, of } from 'rxjs';\r\nimport { catchError, map, switchMap, tap } from 'rxjs/operators';\r\nimport { ApiService } from '../../common/api/api.service';\r\nimport { SessionStorageService } from '../../common/storage/session-storage.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport const UserViews = {\r\n\tSIGN_IN: 1,\r\n\tSIGN_UP: 2,\r\n\tFORGOTTEN: 3,\r\n\tEDIT: 4,\r\n};\r\n\r\nexport class User {\r\n\r\n\tget shortName() {\r\n\t\treturn (this.firstName || '?').substr(0, 1).toUpperCase() + (this.lastName || '?').substr(0, 1).toUpperCase();\r\n\t}\r\n\r\n\tget fullName() {\r\n\t\treturn this.firstName + ' ' + this.lastName;\r\n\t}\r\n\r\n\tconstructor(data) {\r\n\t\tif (data) {\r\n\t\t\tObject.assign(this, data);\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nexport class UserService {\r\n\r\n\tstatic user$_ = new BehaviorSubject(null);\r\n\r\n\tstatic get currentUser() {\r\n\t\treturn this.user$_.getValue();\r\n\t}\r\n\r\n\tstatic setUser(user) {\r\n\t\tif (user) {\r\n\t\t\tSessionStorageService.set('user', user);\r\n\t\t} else {\r\n\t\t\tSessionStorageService.delete('user');\r\n\t\t}\r\n\t\tthis.user$_.next(user);\r\n\t}\r\n\r\n\tstatic data$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/giorgetti/user/data');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/user/data.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic forgot$(payload) {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.post$('/giorgetti/user/forgot', payload);\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$(`/user/forgot.json`);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic me$() {\r\n\t\tif (UserService.busyMe) {\r\n\t\t\treturn this.user$_;\r\n\t\t} else {\r\n\t\t\tUserService.busyMe = true;\r\n\t\t\treturn of(1).pipe(\r\n\t\t\t\tswitchMap(_ => {\r\n\t\t\t\t\tif (environment.flags.production) {\r\n\t\t\t\t\t\treturn ApiService.get$(`/giorgetti/user/me`);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst sessionUser = SessionStorageService.get('user');\r\n\t\t\t\t\t\tif (sessionUser) {\r\n\t\t\t\t\t\t\treturn of(sessionUser);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn ApiService.get$(`/user/me.json`);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}),\r\n\t\t\t\tmap((user) => {\r\n\t\t\t\t\tconsole.log('UserService.user$', user);\r\n\t\t\t\t\treturn this.mapUser(user);\r\n\t\t\t\t}),\r\n\t\t\t\tcatchError(_ => of(null)),\r\n\t\t\t\tswitchMap(user => {\r\n\t\t\t\t\tthis.setUser(user);\r\n\t\t\t\t\treturn this.user$_;\r\n\t\t\t\t}),\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\r\n\tstatic signin$(payload) {\r\n\t\treturn (\r\n\t\t\tenvironment.flags.production ? ApiService.post$(`/giorgetti/user/signin`, payload) : ApiService.get$(`/user/signin.json`)\r\n\t\t).pipe(\r\n\t\t\tmap((response) => this.mapUser(response)),\r\n\t\t\ttap((user) => this.setUser(user)),\r\n\t\t);\r\n\t}\r\n\r\n\tstatic signout$() {\r\n\t\treturn (\r\n\t\t\tenvironment.flags.production ? ApiService.post$(`/giorgetti/user/signout`) : ApiService.get$(`/user/signout.json`)\r\n\t\t).pipe(\r\n\t\t\ttap((_) => this.setUser(null)),\r\n\t\t);\r\n\t}\r\n\r\n\tstatic signup$(payload) {\r\n\t\t// console.log('UserService.signup$', payload);\r\n\t\treturn (\r\n\t\t\tenvironment.flags.production ? ApiService.post$(`/giorgetti/user/signup`, payload) : ApiService.get$(`/user/signup.json`)\r\n\t\t).pipe(\r\n\t\t\tmap((response) => {\r\n\t\t\t\tresponse.user = this.mapUser(response.user);\r\n\t\t\t\treturn response;\r\n\t\t\t}),\r\n\t\t\ttap((response) => this.setUser(response.user)),\r\n\t\t\t//document.location.reload(),\r\n\t\t);\r\n\t}\r\n\r\n\tstatic edit$(payload) {\r\n\t\t// console.log('UserService.edit$', payload);\r\n\t\treturn (\r\n\t\t\tenvironment.flags.production ? ApiService.post$(`/giorgetti/user/edit`, payload) : ApiService.get$(`/user/edit.json`)\r\n\t\t).pipe(\r\n\t\t\tmap((response) => {\r\n\t\t\t\tresponse.user = this.mapUser(response.user);\r\n\t\t\t\treturn response;\r\n\t\t\t}),\r\n\t\t\ttap((response) => this.setUser(response.user)),\r\n\t\t\t//document.location.reload(),\r\n\t\t);\r\n\t}\r\n\r\n\tstatic editPassword$(payload) {\r\n\t\t// console.log('UserService.editPassword$', payload);\r\n\t\treturn (\r\n\t\t\tenvironment.flags.production ?\r\n\t\t\t\tApiService.post$(`/giorgetti/user/edit-password`, payload) :\r\n\t\t\t\tApiService.get$(`/user/edit-password.json`)\r\n\t\t);\r\n\t}\r\n\r\n\tstatic accessData$(payload) {\r\n\t\t// console.log('UserService.accessData$', payload);\r\n\t\treturn (\r\n\t\t\tenvironment.flags.production ?\r\n\t\t\t\tApiService.post$(`/giorgetti/user/access-data`, payload) :\r\n\t\t\t\tApiService.get$(`/user/access-data.json`)\r\n\t\t);\r\n\t}\r\n\r\n\tstatic delete$(payload) {\r\n\t\t// console.log('UserService.delete$', payload);\r\n\t\treturn (\r\n\t\t\tenvironment.flags.production ?\r\n\t\t\t\tApiService.post$(`/giorgetti/user/delete`, payload) :\r\n\t\t\t\tApiService.get$(`/user/delete.json`)\r\n\t\t);\r\n\t}\r\n\r\n\tstatic gdpr$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/giorgetti/user/gdpr');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/user/gdpr.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic tryFacebook$(me) {\r\n\t\treturn of(null);\r\n\t}\r\n\r\n\tstatic tryGoogle$(me) {\r\n\t\treturn of(null);\r\n\t}\r\n\r\n\tstatic tryLinkedin$(me) {\r\n\t\treturn of(null);\r\n\t}\r\n\r\n\tstatic sessionStorage$() {\r\n\t\treturn of(SessionStorageService.get('user') || null);\r\n\t}\r\n\r\n\tstatic mapUser(user) {\r\n\t\treturn user ? new User(user) : null;\r\n\t}\r\n\r\n\tstatic mapUsers(users) {\r\n\t\treturn users ? users.map(x => UserService.mapUser(x)) : [];\r\n\t}\r\n\r\n}\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { first, takeUntil } from 'rxjs/operators';\r\nimport { ModalResolveEvent, ModalService } from './common/modal/modal.service';\r\nimport { environment } from './environment';\r\nimport { CartService } from './pages/cart/cart.service';\r\nimport { CartMiniService } from './shared/cart-mini/cart-mini.service';\r\nimport { HeaderService } from './shared/header/header.service';\r\nimport { UserService } from './shared/user/user.service';\r\n\r\nexport class AppComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tnode.classList.remove('hidden');\r\n\t\t// console.log('AppComponent.onInit');\r\n\t\tthis.header = HeaderService.currentHeader;\r\n\t\tHeaderService.header$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe(header => {\r\n\t\t\tthis.header = header;\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t\tCartMiniService.items$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe(_ => this.pushChanges());\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.checkUserMarket();\r\n\t\t}, 2000);\r\n\t}\r\n\r\n\tcheckUserMarket() {\r\n\t\tif (environment.userMarket !== environment.currentMarket && document.cookie.indexOf('marketPropositionAccepted') === -1) {\r\n\t\t\tthis.onOpenMarketProposition();\r\n\t\t}\r\n\t}\r\n\r\n\tonOpenMarketProposition() {\r\n\t\tHeaderService.onBack();\r\n\t\tModalService.open$({ src: environment.template.modal.marketPropositionModal }).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(event => {\r\n\t\t\tconsole.log('AppComponent.onOpenMarketProposition', event);\r\n\t\t});\r\n\t}\r\n\r\n\tonOpenMarketAndLanguage() {\r\n\t\tHeaderService.onBack();\r\n\t\tModalService.open$({ src: environment.template.modal.marketsAndLanguagesModal }).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(event => {\r\n\t\t\tconsole.log('AppComponent.onOpenMarketAndLanguage', event);\r\n\t\t});\r\n\t}\r\n\r\n\tonLogin() {\r\n\t\tHeaderService.onBack();\r\n\t\tModalService.open$({ src: environment.template.modal.userModal, data: { view: 1 } }).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(event => {\r\n\t\t\tconsole.log('AppComponent.onLogin', event);\r\n\t\t\tif (event instanceof ModalResolveEvent) {\r\n\t\t\t\twindow.location.href = environment.slug.reservedArea;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tonLogout() {\r\n\t\tUserService.signout$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tonProjectRegistration(event) {\r\n\t\tModalService.open$({ src: environment.template.modal.projectsRegistrationModal }).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(event => {\r\n\t\t\tconsole.log('AppComponent.onProjectRegistration', event);\r\n\t\t\t/*\r\n\t\t\tif (event instanceof ModalResolveEvent) {\r\n\t\t\t\t// window.location.href = environment.slug.reservedArea;\r\n\t\t\t}\r\n\t\t\t*/\r\n\t\t});\r\n\t}\r\n\r\n\tonAddToCart(item) {\r\n\t\t// resetting purchase procedure\r\n\t\tCartService.setCart(null);\r\n\t\t// getting showefy price and adding to mini cart\r\n\t\tCartMiniService.getPriceAndAddItem$(item).pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe(_ => {\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t}\r\n\r\n\tonOpenMiniCart() {\r\n\t\tHeaderService.setHeader('cart');\r\n\t}\r\n\r\n}\r\n\r\nAppComponent.meta = {\r\n\tselector: '[app-component]',\r\n};\r\n","import { Directive, getContext } from 'rxcomp';\r\n\r\nexport class AltDirective extends Directive {\r\n\r\n\tonChanges() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tnode.setAttribute('alt', this.alt);\r\n\t}\r\n\r\n}\r\n\r\nAltDirective.meta = {\r\n\tselector: '[[alt]]',\r\n\tinputs: ['alt']\r\n};\r\n","import { Directive, getContext } from 'rxcomp';\r\nimport { fromEvent } from 'rxjs';\r\nimport { filter, shareReplay, takeUntil } from 'rxjs/operators';\r\n\r\nexport class ClickOutsideDirective extends Directive {\r\n\r\n\tonInit() {\r\n\t\tthis.initialFocus = false;\r\n\t\tconst { module, node, parentInstance, selector } = getContext(this);\r\n\t\tconst event$ = this.event$ = fromEvent(document, 'click').pipe(\r\n\t\t\tfilter(event => {\r\n\t\t\t\tconst target = event.target;\r\n\t\t\t\t// console.log('ClickOutsideDirective.onClick', this.element.nativeElement, target, this.element.nativeElement.contains(target));\r\n\t\t\t\t// const documentContained: boolean = Boolean(document.compareDocumentPosition(target) & Node.DOCUMENT_POSITION_CONTAINED_BY);\r\n\t\t\t\t// console.log(target, documentContained);\r\n\t\t\t\tconst clickedInside = node.contains(target) || !document.contains(target);\r\n\t\t\t\tif (!clickedInside) {\r\n\t\t\t\t\tif (this.initialFocus) {\r\n\t\t\t\t\t\tthis.initialFocus = false;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.initialFocus = true;\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tshareReplay(1)\r\n\t\t);\r\n\t\tconst expression = node.getAttribute(`(clickOutside)`);\r\n\t\tif (expression) {\r\n\t\t\tconst outputFunction = module.makeFunction(expression, ['$event']);\r\n\t\t\tevent$.pipe(\r\n\t\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t\t).subscribe(event => {\r\n\t\t\t\tmodule.resolve(outputFunction, parentInstance, event);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tparentInstance.clickOutside$ = event$;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nClickOutsideDirective.meta = {\r\n\tselector: `[(clickOutside)]`,\r\n};\r\n","import { Pipe } from 'rxcomp';\r\nimport { environment } from '../../environment';\r\n\r\nexport class DatePipe extends Pipe {\r\n\r\n\tstatic transform(value, options = {}, language = null) { // = 'en-IN'\r\n\t\tif (value != null) { // !!! keep losing\r\n\t\t\tlanguage = language || environment.currentLanguage;\r\n\t\t\treturn new Intl.DateTimeFormat(language, options).format(value instanceof Date ? value : new Date(value));\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\tstatic transform(value, locale = 'it-IT-u-ca-gregory', options = {\r\n\t\tdateStyle: 'short',\r\n\t\ttimeStyle: 'short',\r\n\t}) {\r\n\t\tconst localeDateString = new Date(value).toLocaleDateString(locale, options);\r\n\t\treturn localeDateString;\r\n\t}\r\n\t*/\r\n\r\n}\r\n\r\nDatePipe.meta = {\r\n\tname: 'date',\r\n};\r\n","import { Directive, getContext } from 'rxcomp';\r\n\r\nexport class DownloadDirective extends Directive {\r\n\r\n\tonChanges() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tnode.setAttribute('download', this.download);\r\n\t}\r\n\r\n}\r\n\r\nDownloadDirective.meta = {\r\n\tselector: '[[download]]',\r\n\tinputs: ['download']\r\n};\r\n","import { fromEvent, ReplaySubject } from 'rxjs';\r\nimport { delay, switchMap } from 'rxjs/operators';\r\n\r\nexport class LocomotiveScrollService {\r\n\r\n\tstatic scroll$ = new ReplaySubject(1);\r\n\tstatic scroll(scroll) {\r\n\t\t// console.log('LocomotiveScrollService.scroll', scroll);\r\n\t\tthis.scroll$.next(scroll);\r\n\t}\r\n\r\n\tstatic init(node, options) {\r\n\t\toptions = Object.assign({\r\n\t\t\tuseKeyboard: true,\r\n\t\t\tsmoothMobile: true,\r\n\t\t\tinertia: 0.5,\r\n\t\t\t// name:'scroll',\r\n\t\t\t// offset: [0,0], // bottom top\r\n\t\t\t// repeat: false,\r\n\t\t\tsmooth: true,\r\n\t\t\t// initPosition: { x: 0, y: 0 }\r\n\t\t\t// direction: 'vertical',\r\n\t\t\tlerp: 0.01,\r\n\t\t\tgetDirection: true, // add direction to scroll event\r\n\t\t\tgetSpeed: true, // add speed to scroll event\r\n\t\t\t// class: 'is-inview',\r\n\t\t\tinitClass: 'has-scroll-init',\r\n\t\t\tscrollingClass: 'has-scroll-scrolling',\r\n\t\t\tdraggingClass: 'has-scroll-dragging',\r\n\t\t\tsmoothClass: 'has-scroll-smooth',\r\n\t\t\tscrollbarContainer: false,\r\n\t\t\tscrollbarClass: 'c-scrollbar',\r\n\t\t\tmultiplier: 1,\r\n\t\t\tfirefoxMultiplier: 50,\r\n\t\t\ttouchMultiplier: 2,\r\n\t\t\tscrollFromAnywhere: true,\r\n\t\t\tgestureDirection: 'vertical',\r\n\t\t\treloadOnContextChange: false,\r\n\t\t\tresetNativeScroll: true,\r\n\t\t}, options, {\r\n\t\t\tel: node,\r\n\t\t});\r\n\t\tif (this.useLocomotiveScroll()) {\r\n\t\t\tconst instance = new LocomotiveScroll(options);\r\n\t\t\tLocomotiveScrollService.instance = instance;\r\n\t\t\treturn instance;\r\n\t\t} else {\r\n\t\t\tdocument.querySelector('html').classList.add('has-scroll-init');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic useLocomotiveScroll() {\r\n\t\treturn window.innerWidth >= 768 && !this.isTouchDevice();\r\n\t}\r\n\r\n\tstatic isTouchDevice() {\r\n\t\tconst userAgent = navigator.userAgent.toLowerCase();\r\n\t\tconst isTablet = /(mac|ipad|tablet|(android(?!.*mobile))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(userAgent);\r\n\t\tconst isSmartphone = /(ipod|iphone|(android(?!.*mobile))|(windows(?!.*phone)(.*touch)))/.test(userAgent);\r\n\t\treturn isTablet || isSmartphone;\r\n\t}\r\n\r\n\tstatic isMacLike() {\r\n\t\tconst isMacLike = /(Mac|iPhone|iPod|iPad)/i.test(navigator.platform);\r\n\t\treturn isMacLike;\r\n\t}\r\n\r\n\tstatic isIOS() {\r\n\t\tconst isIOS = /(iPhone|iPod|iPad)/i.test(navigator.platform);\r\n\t\treturn isIOS;\r\n\t}\r\n\r\n\tstatic isMacOs() {\r\n\t\tconst isMacOs = navigator.platform.toLowerCase().indexOf('mac') >= 0;\r\n\t\treturn isMacOs;\r\n\t}\r\n\r\n\tstatic isSafari() {\r\n\t\tconst isSafari = navigator.vendor.match(/apple/i) &&\r\n\t\t\t!navigator.userAgent.match(/crios/i) &&\r\n\t\t\t!navigator.userAgent.match(/fxios/i);\r\n\t\treturn isSafari;\r\n\t}\r\n\r\n\tstatic init$(node) {\r\n\t\treturn fromEvent(window, 'DOMContentLoaded').pipe(\r\n\t\t\tdelay(1),\r\n\t\t\tswitchMap(_ => {\r\n\t\t\t\t// setTimeout(() => {\r\n\t\t\t\tconst instance = LocomotiveScrollService.init(node);\r\n\t\t\t\tif (instance) {\r\n\t\t\t\t\tconst showefy = document.querySelector('#showefy');\r\n\t\t\t\t\tinstance.on('scroll', instance => {\r\n\t\t\t\t\t\tLocomotiveScrollService.scroll(instance);\r\n\t\t\t\t\t\tif (showefy) {\r\n\t\t\t\t\t\t\tconst isShowefyDisabled = instance.speed > 0.1;\r\n\t\t\t\t\t\t\tif (isShowefyDisabled) {\r\n\t\t\t\t\t\t\t\tif (showefy.style.pointerEvents !== 'none') {\r\n\t\t\t\t\t\t\t\t\tshowefy.style.pointerEvents = 'none';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (showefy.style.pointerEvents === 'none') {\r\n\t\t\t\t\t\t\t\t\tshowefy.style.pointerEvents = 'auto';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst event = { direction: null, scroll: { x: 0, y: 0 }, speed: 0 };\r\n\t\t\t\t\tconst body = document.querySelector('body');\r\n\t\t\t\t\tlet previousY = body.scrollTop; // window.pageYOffset; // body.scrollTop;\r\n\t\t\t\t\tbody.addEventListener('scroll', () => {\r\n\t\t\t\t\t\tconst y = body.scrollTop; // window.pageYOffset; // body.scrollTop;\r\n\t\t\t\t\t\tconst direction = y >= previousY ? 'down' : 'up';\r\n\t\t\t\t\t\tif (Math.abs(y - previousY) > 90) {\r\n\t\t\t\t\t\t\t// console.log('scroll', y, direction);\r\n\t\t\t\t\t\t\tpreviousY = y;\r\n\t\t\t\t\t\t\tevent.direction = direction;\r\n\t\t\t\t\t\t\tevent.scroll.y = y;\r\n\t\t\t\t\t\t\tLocomotiveScrollService.scroll(event);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, true);\r\n\t\t\t\t}\r\n\t\t\t\treturn LocomotiveScrollService.scroll$;\r\n\t\t\t\t// }, 1);\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tstatic update() {\r\n\t\tif (this.instance) {\r\n\t\t\tthis.instance.update();\r\n\t\t}\r\n\t}\r\n\r\n\tstatic stop() {\r\n\t\tif (this.instance) {\r\n\t\t\tthis.instance.stop();\r\n\t\t}\r\n\t}\r\n\r\n\tstatic start() {\r\n\t\tif (this.instance) {\r\n\t\t\tthis.instance.start();\r\n\t\t}\r\n\t}\r\n\r\n\tstatic scrollTo(target, options = { offset: -130 }) {\r\n\t\tif (this.instance) {\r\n\t\t\tthis.instance.scrollTo(target, options);\r\n\t\t} else {\r\n\t\t\tconst body = document.querySelector('body');\r\n\t\t\tconst currentTop = body.scrollTop; // window.pageYOffset; // body.scrollTop;\r\n\t\t\tconst targetTop = currentTop + target.getBoundingClientRect().top + options.offset;\r\n\t\t\tconst distance = targetTop - currentTop;\r\n\t\t\tconst o = { pow: 0 };\r\n\t\t\tgsap.set(body, {\r\n\t\t\t\t'scroll-behavior': 'auto'\r\n\t\t\t});\r\n\t\t\tif (options.disableLerp) {\r\n\t\t\t\tgsap.set(body, {\r\n\t\t\t\t\t'scrollTop': currentTop + distance\r\n\t\t\t\t});\r\n\t\t\t\tgsap.set(body, {\r\n\t\t\t\t\t'scroll-behavior': 'smooth'\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tgsap.to(o, {\r\n\t\t\t\t\tduration: Math.abs(distance) / 2000,\r\n\t\t\t\t\tpow: 1,\r\n\t\t\t\t\tease: Quad.easeOut,\r\n\t\t\t\t\toverwrite: 'all',\r\n\t\t\t\t\tonUpdate: () => {\r\n\t\t\t\t\t\tgsap.set(body, {\r\n\t\t\t\t\t\t\t'scrollTop': currentTop + distance * o.pow\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// window.scrollTo(0, currentTop + distance * o.pow);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonComplete: () => {\r\n\t\t\t\t\t\tgsap.set(body, {\r\n\t\t\t\t\t\t\t'scroll-behavior': 'smooth'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t// target.scrollIntoView();\r\n\t\t}\r\n\t}\r\n\r\n\tstatic scrollToSelector(selector, options) {\r\n\t\tconst target = document.querySelector(selector);\r\n\t\tif (target) {\r\n\t\t\tLocomotiveScrollService.scrollTo(target, options);\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { Directive, getContext } from 'rxcomp';\r\nimport { BehaviorSubject } from 'rxjs';\r\nimport { takeUntil } from 'rxjs/operators';\r\n\r\nlet DROPDOWN_ID = 1000000;\r\n\r\nexport class DropdownDirective extends Directive {\r\n\r\n\tget id() {\r\n\t\treturn this.dropdown || this.id_ || (this.id_ = DropdownDirective.nextId());\r\n\t}\r\n\r\n\tonInit() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst trigger = node.getAttribute('dropdown-trigger');\r\n\t\tthis.trigger = trigger ? node.querySelector(trigger) : node;\r\n\t\tthis.opened = null;\r\n\t\tthis.onClick = this.onClick.bind(this);\r\n\t\tthis.onDocumentClick = this.onDocumentClick.bind(this);\r\n\t\tthis.openDropdown = this.openDropdown.bind(this);\r\n\t\tthis.closeDropdown = this.closeDropdown.bind(this);\r\n\t\tthis.addListeners();\r\n\t\tDropdownDirective.dropdown$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(id => {\r\n\t\t\t// console.log('DropdownDirective', id, this['dropdown-item']);\r\n\t\t\tif (this.id === id) {\r\n\t\t\t\tnode.classList.add('dropped');\r\n\t\t\t} else {\r\n\t\t\t\tnode.classList.remove('dropped');\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tonClick(event) {\r\n\t\tconst { node } = getContext(this);\r\n\t\tif (this.opened === null) {\r\n\t\t\tthis.openDropdown();\r\n\t\t} else {\r\n\t\t\tconst dropdownItemNode = node.querySelector('[dropdown-item]');\r\n\t\t\t// console.log('dropdownItemNode', dropdownItemNode);\r\n\t\t\tif (!dropdownItemNode) { // if (this.trigger !== node) {\r\n\t\t\t\tthis.closeDropdown();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tonDocumentClick(event) {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst clickedInside = node === event.target || node.contains(event.target);\r\n\t\tif (!clickedInside) {\r\n\t\t\tthis.closeDropdown();\r\n\t\t}\r\n\t}\r\n\r\n\topenDropdown() {\r\n\t\tif (this.opened === null) {\r\n\t\t\tthis.opened = true;\r\n\t\t\tthis.addDocumentListeners();\r\n\t\t\tDropdownDirective.dropdown$.next(this.id);\r\n\t\t\tthis.dropped.next(this.id);\r\n\t\t}\r\n\t}\r\n\r\n\tcloseDropdown() {\r\n\t\tif (this.opened !== null) {\r\n\t\t\tthis.removeDocumentListeners();\r\n\t\t\tthis.opened = null;\r\n\t\t\tif (DropdownDirective.dropdown$.getValue() === this.id) {\r\n\t\t\t\tDropdownDirective.dropdown$.next(null);\r\n\t\t\t\tthis.dropped.next(null);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\taddListeners() {\r\n\t\tthis.trigger.addEventListener('click', this.onClick);\r\n\t}\r\n\r\n\taddDocumentListeners() {\r\n\t\tdocument.addEventListener('click', this.onDocumentClick);\r\n\t}\r\n\r\n\tremoveListeners() {\r\n\t\tthis.trigger.removeEventListener('click', this.onClick);\r\n\t}\r\n\r\n\tremoveDocumentListeners() {\r\n\t\tdocument.removeEventListener('click', this.onDocumentClick);\r\n\t}\r\n\r\n\tonDestroy() {\r\n\t\tthis.removeListeners();\r\n\t\tthis.removeDocumentListeners();\r\n\t}\r\n\r\n\tstatic nextId() {\r\n\t\treturn DROPDOWN_ID++;\r\n\t}\r\n\r\n}\r\n\r\nDropdownDirective.meta = {\r\n\tselector: '[dropdown]',\r\n\tinputs: ['dropdown', 'dropdown-trigger'],\r\n\toutputs: ['dropped']\r\n};\r\n\r\nDropdownDirective.dropdown$ = new BehaviorSubject(null);\r\n","import { Directive, getContext } from 'rxcomp';\r\nimport { fromEvent } from 'rxjs';\r\nimport { takeUntil, tap } from 'rxjs/operators';\r\nimport { LocomotiveScrollService } from '../locomotive-scroll/locomotive-scroll.service';\r\nimport { DropdownDirective } from './dropdown.directive';\r\n\r\nexport class DropdownItemDirective extends Directive {\r\n\r\n\tget id() {\r\n\t\treturn this['dropdown-item'];\r\n\t}\r\n\r\n\tonInit() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tnode.classList.add('dropdown-item');\r\n\t\tDropdownDirective.dropdown$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(id => {\r\n\t\t\t// console.log('DropdownItemDirective', id, this['dropdown-item']);\r\n\t\t\tif (this.id === id) {\r\n\t\t\t\tnode.classList.add('dropped');\r\n\t\t\t\t// LocomotiveScrollService.stop();\r\n\t\t\t} else {\r\n\t\t\t\tnode.classList.remove('dropped');\r\n\t\t\t\t// LocomotiveScrollService.start();\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.enter$(node).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe();\r\n\t\tthis.leave$(node).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe();\r\n\t\t// this.addListeners();\r\n\t}\r\n\r\n\tenter$(node) {\r\n\t\t// const { node } = getContext(this);\r\n\t\treturn fromEvent(node, 'mouseenter').pipe(\r\n\t\t\ttap(event => {\r\n\t\t\t\tLocomotiveScrollService.stop();\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n\tleave$(node) {\r\n\t\t// const { node } = getContext(this);\r\n\t\treturn fromEvent(node, 'mouseleave').pipe(\r\n\t\t\ttap(event => {\r\n\t\t\t\tLocomotiveScrollService.start();\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n\t/*\r\n\tonDestroy() {\r\n\t\tthis.removeListeners();\r\n\t}\r\n\r\n\tonEnter(event) {\r\n\t\tLocomotiveScrollService.stop();\r\n\t}\r\n\r\n\tonLeave(event) {\r\n\t\tLocomotiveScrollService.start();\r\n\t}\r\n\r\n\taddListeners() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tnode.addEventListener('mouseenter', this.onEnter);\r\n\t\tnode.addEventListener('mouseleave', this.onLeave);\r\n\t}\r\n\r\n\tremoveListeners() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tnode.removeEventListener('mouseenter', this.onEnter);\r\n\t\tnode.removeEventListener('mouseleave', this.onLeave);\r\n\t}\r\n\t*/\r\n}\r\n\r\nDropdownItemDirective.meta = {\r\n\tselector: '[dropdown-item], [[dropdown-item]]',\r\n\tinputs: ['dropdown-item']\r\n};\r\n","import { Pipe } from 'rxcomp';\r\nimport { environment } from '../../environment';\r\n\r\nexport class EnvPipe extends Pipe {\r\n\r\n\tstatic transform(keypath) {\r\n\t\tlet env = environment;\r\n\t\tconst keys = keypath.split('.');\r\n\t\tlet k = keys.shift();\r\n\t\twhile (keys.length > 0 && env[k]) {\r\n\t\t\tenv = env[k];\r\n\t\t\tk = keys.shift();\r\n\t\t}\r\n\t\tconst value = env[k] || null;\r\n\t\treturn value;\r\n\t}\r\n\r\n}\r\n\r\nEnvPipe.meta = {\r\n\tname: 'env',\r\n};\r\n","import { Component } from 'rxcomp';\r\nimport { LocomotiveScrollService } from '../locomotive-scroll/locomotive-scroll.service';\r\n\r\nexport class FilterItemComponent extends Component {\r\n\r\n\tcloseFilter() {\r\n\t\tthis.filter.active = false;\r\n\t\tthis.change.next();\r\n\t\t// this.pushChanges();\r\n\t}\r\n\r\n\ttoggleFilter(filter) {\r\n\t\tObject.keys(this.filters).forEach(key => {\r\n\t\t\tconst f = this.filters[key];\r\n\t\t\tif (f === filter) {\r\n\t\t\t\tf.active = !f.active;\r\n\t\t\t} else {\r\n\t\t\t\tf.active = false;\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.change.next();\r\n\t\t// this.pushChanges();\r\n\t}\r\n\r\n\tclearFilter(event, filter) {\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopImmediatePropagation();\r\n\t\tfilter.clear();\r\n\t\tthis.change.next();\r\n\t\t// this.pushChanges();\r\n\t}\r\n\r\n\tonEnter() {\r\n\t\tLocomotiveScrollService.stop();\r\n\t}\r\n\r\n\tonLeave() {\r\n\t\tLocomotiveScrollService.start();\r\n\t}\r\n\r\n\tonClick(item) {\r\n\t\tthis.filter.set(item);\r\n\t\tLocomotiveScrollService.start();\r\n\t}\r\n}\r\n\r\nFilterItemComponent.meta = {\r\n\tselector: '[filter], [[filter]]',\r\n\toutputs: ['change'],\r\n\tinputs: ['filter', 'filters', 'name'],\r\n\ttemplate: /* html */`\r\n\t\t<div class=\"group--filter\" (click)=\"toggleFilter(filter)\" (clickOutside)=\"closeFilter(filter)\">\r\n\t\t\t<span class=\"label\" [innerHTML]=\"filter.getLabel() || name\"></span>\r\n\t\t\t<svg class=\"caret-down\" *if=\"!filter.hasAny()\"><use xlink:href=\"#caret-down\"></use></svg>\r\n\t\t\t<svg class=\"close-sm\" *if=\"filter.hasAny()\" (click)=\"clearFilter($event, filter)\"><use xlink:href=\"#close-sm\"></use></svg>\r\n\t\t</div>\r\n\t\t<div class=\"options\" *if=\"filter.active\" (mouseenter)=\"onEnter()\" (mouseleave)=\"onLeave()\">\r\n\t\t\t<div class=\"category\" [innerHTML]=\"name\"></div>\r\n\t\t\t<ul class=\"nav--options\">\r\n\t\t\t\t<li class=\"nav--options__item\" [class]=\"{ active: filter.has(item), disabled: item.disabled, empty: !item.value }\" *for=\"let item of filter.options\">\r\n\t\t\t\t\t<span class=\"option\" (click)=\"onClick(item)\">\r\n\t\t\t\t\t\t<span class=\"name\" [innerHTML]=\"item.label | label\"></span>\r\n\t\t\t\t\t\t<!-- <span class=\"count\" [innerHTML]=\"item.count || ''\"></span> -->\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t</div>\r\n\t\t`,\r\n};\r\n","import { Pipe } from 'rxcomp';\r\nimport { environment } from '../../environment';\r\n\r\nexport class FlagPipe extends Pipe {\r\n\r\n\tstatic transform(key) {\r\n\t\tconst flags = environment.flags;\r\n\t\treturn flags[key] || false;\r\n\t}\r\n\r\n}\r\n\r\nFlagPipe.meta = {\r\n\tname: 'flag',\r\n};\r\n","\r\nimport { Pipe } from 'rxcomp';\r\n\r\nexport class HighlightPipe extends Pipe {\r\n\r\n\tstatic transform(text, query) {\r\n\t\tif (!query) {\r\n\t\t\treturn text;\r\n\t\t}\r\n\t\tif (!Array.isArray(query)) {\r\n\t\t\tquery = [query];\r\n\t\t}\r\n\t\t// text = HighlightPipe.encodeHTML(text);\r\n\t\tconst escapedQuery = query.map(x => HighlightPipe.escapeRegexChars(x));\r\n\t\tconst regExp = new RegExp(`(\\<[^\\>]+\\>)|(${escapedQuery.join('|')})`, 'gmi');\r\n\t\t// const regExp = new RegExp(`(?<!\\<)${escapedQuery.join('(?![\\w\\s]*[\\>])|(?<!\\<)')}(?![\\w\\s]*[\\>])`, 'gmi');\r\n\t\t// const regExp = new RegExp('&[^;]+;|' + escapedQuery.join('|'), 'gi');\r\n\t\ttext = text.replace(regExp, function(match, g1, g2) {\r\n\t\t\tif (g1) {\r\n\t\t\t\treturn g1;\r\n\t\t\t} else {\r\n\t\t\t\treturn '<b>' + g2 + '</b>';\r\n\t\t\t}\r\n\t\t\t// return match.toLowerCase() === x.toLowerCase() ? '<strong>' + match + '</strong>' : match;\r\n\t\t});\r\n\t\t// text = HighlightPipe.decodeHTML(text);\r\n\t\t// console.log(text, query);\r\n\t\treturn text;\r\n\t}\r\n\r\n\tstatic escapeRegexChars(text) {\r\n\t\treturn text.replace(/([.?*+^$[\\]\\\\(){}|-])/g, '\\\\$1');\r\n\t}\r\n\r\n\tstatic safeToString(text) {\r\n\t\treturn text === undefined || text === null ? '' : text.toString().trim();\r\n\t}\r\n\r\n\tstatic encodeHTML(text) {\r\n\t\treturn this.safeToString(text)\r\n\t\t\t.replace(/&/g, '&amp;')\r\n\t\t\t.replace(/</g, '&lt;')\r\n\t\t\t.replace(/>/g, '&gt;');\r\n\t}\r\n\r\n\tstatic decodeHTML(text) {\r\n\t\treturn text\r\n\t\t\t.replace(/&amp;/g, '&')\r\n\t\t\t.replace(/&lt;/g, '<')\r\n\t\t\t.replace(/&gt;/g, '>');\r\n\t}\r\n\r\n}\r\n\r\nHighlightPipe.meta = {\r\n\tname: 'highlight',\r\n};\r\n\r\n","import { Pipe } from 'rxcomp';\r\n\r\n/*\r\n['quot', 'amp', 'apos', 'lt', 'gt', 'nbsp', 'iexcl', 'cent', 'pound', 'curren', 'yen', 'brvbar', 'sect', 'uml', 'copy', 'ordf', 'laquo', 'not', 'shy', 'reg', 'macr', 'deg', 'plusmn', 'sup2', 'sup3', 'acute', 'micro', 'para', 'middot', 'cedil', 'sup1', 'ordm', 'raquo', 'frac14', 'frac12', 'frac34', 'iquest', 'Agrave', 'Aacute', 'Acirc', 'Atilde', 'Auml', 'Aring', 'AElig', 'Ccedil', 'Egrave', 'Eacute', 'Ecirc', 'Euml', 'Igrave', 'Iacute', 'Icirc', 'Iuml', 'ETH', 'Ntilde', 'Ograve', 'Oacute', 'Ocirc', 'Otilde', 'Ouml', 'times', 'Oslash', 'Ugrave', 'Uacute', 'Ucirc', 'Uuml', 'Yacute', 'THORN', 'szlig', 'agrave', 'aacute', 'atilde', 'auml', 'aring', 'aelig', 'ccedil', 'egrave', 'eacute', 'ecirc', 'euml', 'igrave', 'iacute', 'icirc', 'iuml', 'eth', 'ntilde', 'ograve', 'oacute', 'ocirc', 'otilde', 'ouml', 'divide', 'oslash', 'ugrave', 'uacute', 'ucirc', 'uuml', 'yacute', 'thorn', 'yuml', 'amp', 'bull', 'deg', 'infin', 'permil', 'sdot', 'plusmn', 'dagger', 'mdash', 'not', 'micro', 'perp', 'par', 'euro', 'pound', 'yen', 'cent', 'copy', 'reg', 'trade', 'alpha', 'beta', 'gamma', 'delta', 'epsilon', 'zeta', 'eta', 'theta', 'iota', 'kappa', 'lambda', 'mu', 'nu', 'xi', 'omicron', 'pi', 'rho', 'sigma', 'tau', 'upsilon', 'phi', 'chi', 'psi', 'omega', 'Alpha', 'Beta', 'Gamma', 'Delta', 'Epsilon', 'Zeta', 'Eta', 'Theta', 'Iota', 'Kappa', 'Lambda', 'Mu', 'Nu', 'Xi', 'Omicron', 'Pi', 'Rho', 'Sigma', 'Tau', 'Upsilon', 'Phi', 'Chi', 'Psi', 'Omega'];\r\n['\"', '&', ''', '<', '>', ' ', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '&', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''];\r\n*/\r\n\r\nexport class HtmlPipe extends Pipe {\r\n\r\n\tstatic transform(value) {\r\n\t\tif (value) {\r\n\t\t\tvalue = value.replace(/&#(\\d+);/g, function(m, n) {\r\n\t\t\t\treturn String.fromCharCode(parseInt(n));\r\n\t\t\t});\r\n\t\t\tconst escapes = ['quot', 'amp', 'apos', 'lt', 'gt', 'nbsp', 'iexcl', 'cent', 'pound', 'curren', 'yen', 'brvbar', 'sect', 'uml', 'copy', 'ordf', 'laquo', 'not', 'shy', 'reg', 'macr', 'deg', 'plusmn', 'sup2', 'sup3', 'acute', 'micro', 'para', 'middot', 'cedil', 'sup1', 'ordm', 'raquo', 'frac14', 'frac12', 'frac34', 'iquest', 'Agrave', 'Aacute', 'Acirc', 'Atilde', 'Auml', 'Aring', 'AElig', 'Ccedil', 'Egrave', 'Eacute', 'Ecirc', 'Euml', 'Igrave', 'Iacute', 'Icirc', 'Iuml', 'ETH', 'Ntilde', 'Ograve', 'Oacute', 'Ocirc', 'Otilde', 'Ouml', 'times', 'Oslash', 'Ugrave', 'Uacute', 'Ucirc', 'Uuml', 'Yacute', 'THORN', 'szlig', 'agrave', 'aacute', 'atilde', 'auml', 'aring', 'aelig', 'ccedil', 'egrave', 'eacute', 'ecirc', 'euml', 'igrave', 'iacute', 'icirc', 'iuml', 'eth', 'ntilde', 'ograve', 'oacute', 'ocirc', 'otilde', 'ouml', 'divide', 'oslash', 'ugrave', 'uacute', 'ucirc', 'uuml', 'yacute', 'thorn', 'yuml', 'amp', 'bull', 'deg', 'infin', 'permil', 'sdot', 'plusmn', 'dagger', 'mdash', 'not', 'micro', 'perp', 'par', 'euro', 'pound', 'yen', 'cent', 'copy', 'reg', 'trade', 'alpha', 'beta', 'gamma', 'delta', 'epsilon', 'zeta', 'eta', 'theta', 'iota', 'kappa', 'lambda', 'mu', 'nu', 'xi', 'omicron', 'pi', 'rho', 'sigma', 'tau', 'upsilon', 'phi', 'chi', 'psi', 'omega', 'Alpha', 'Beta', 'Gamma', 'Delta', 'Epsilon', 'Zeta', 'Eta', 'Theta', 'Iota', 'Kappa', 'Lambda', 'Mu', 'Nu', 'Xi', 'Omicron', 'Pi', 'Rho', 'Sigma', 'Tau', 'Upsilon', 'Phi', 'Chi', 'Psi', 'Omega'];\r\n\t\t\tconst unescapes = ['\"', '&', '\\'', '<', '>', ' ', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '&', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', ''];\r\n\t\t\tconst rx = new RegExp(`(&${escapes.join(';)|(&')};)`, 'g');\r\n\t\t\tvalue = value.replace(rx, function() {\r\n\t\t\t\tfor (let i = 1; i < arguments.length; i++) {\r\n\t\t\t\t\tif (arguments[i]) {\r\n\t\t\t\t\t\t// console.log(arguments[i], unescapes[i - 1]);\r\n\t\t\t\t\t\treturn unescapes[i - 1];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t// console.log(value);\r\n\t\t\treturn value;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nHtmlPipe.meta = {\r\n\tname: 'html',\r\n};\r\n","import { Directive, getContext } from 'rxcomp';\r\n\r\nexport class IdDirective extends Directive {\r\n\r\n\tonChanges() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tnode.setAttribute('id', this.id);\r\n\t}\r\n\r\n}\r\n\r\nIdDirective.meta = {\r\n\tselector: '[[id]]',\r\n\tinputs: ['id']\r\n};\r\n","import { Directive, getContext } from 'rxcomp';\r\n\r\nexport class LabelForDirective extends Directive {\r\n\r\n\tonChanges() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tnode.setAttribute('for', this.labelFor);\r\n\t}\r\n\r\n}\r\n\r\nLabelForDirective.meta = {\r\n\tselector: '[[labelFor]]',\r\n\tinputs: ['labelFor']\r\n};\r\n","import { Directive, getContext } from 'rxcomp';\r\nimport { takeUntil, tap } from 'rxjs/operators';\r\nimport { LocomotiveScrollService } from './locomotive-scroll.service';\r\n\r\nexport class LocomotiveScrollStickyDirective extends Directive {\r\n\r\n\tsticked_ = false;\r\n\tget sticked() {\r\n\t\treturn this.sticked_;\r\n\t}\r\n\tset sticked(sticked) {\r\n\t\tif (this.sticked_ !== sticked) {\r\n\t\t\tthis.sticked_ = sticked;\r\n\t\t\tif (this.targetNode) {\r\n\t\t\t\tsticked ? this.targetNode.classList.add('sticked') : this.targetNode.classList.remove('sticked');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tonInit() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tthis.targetNode = (this.target ? (node.querySelector(this.target) || node) : node);\r\n\t\tthis.until = this.until ? document.querySelector(this.until) : null;\r\n\t\tthis.sticky$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe(event => {\r\n\t\t\t// console.log('LocomotiveScrollStickyDirective', event);\r\n\t\t});\r\n\t\twindow.addEventListener(\"orientationchange\", function (event) {\r\n\t\t\tvar width = window.screen.width;\t\t\t\r\n\t\t\tvar nav = document.querySelector('.nav--secondary');\t\t\t\r\n\t\t\tvar materials = document.querySelector('.section--materials');\r\n\t\t\tvar secReserved = document.querySelector('.reserved-section--secondary');\t\r\n\t\t\t\t\r\n\t\t\tif (materials !== null) {\r\n\t\t\t\tif (width < 1024) {\r\n\t\t\t\t\tnav.removeAttribute('style');\r\n\t\t\t\t\tnav.classList.remove('nav-fixed-position');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar footer = document.querySelector('.group--prefooter');\r\n\t\t\t\t\tconst headerHeight = document.querySelector('.header').offsetHeight\r\n\t\t\t\t\tvar footerOffset = footer.getBoundingClientRect();\r\n\t\t\t\t\tvar topFooter = footerOffset.top;\r\n\t\t\t\t\tvar materialsOffset = materials.getBoundingClientRect();\r\n\t\t\t\t\tvar topMaterials = materialsOffset.top;\r\n\r\n\r\n\t\t\t\t\tif ((topMaterials - headerHeight) < 0 && (topFooter > 0)) {\r\n\t\t\t\t\t\tnav.classList.add('nav-fixed-position');\r\n\t\t\t\t\t\tnav.style.top = headerHeight + 'px';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnav.removeAttribute('style');\r\n\t\t\t\t\t\tnav.classList.remove('nav-fixed-position');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (secReserved !== null) {\t\t\t\t\r\n\t\t\t\tif (width < 1024) {\r\n\t\t\t\t\tnav.removeAttribute('style');\r\n\t\t\t\t\tnav.classList.remove('nav-fixed-position');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar footer = document.querySelector('.group--prefooter');\r\n\t\t\t\t\tconst headerHeight = document.querySelector('.header').offsetHeight\r\n\t\t\t\t\tvar footerOffset = footer.getBoundingClientRect();\r\n\t\t\t\t\tvar topFooter = footerOffset.top;\r\n\t\t\t\t\tvar materialsOffset = secReserved.getBoundingClientRect();\r\n\t\t\t\t\tvar topMaterials = materialsOffset.top;\r\n\r\n\r\n\t\t\t\t\tif ((topMaterials - headerHeight) < 0 && (topFooter > 0)) {\r\n\t\t\t\t\t\tnav.classList.add('nav-fixed-position');\r\n\t\t\t\t\t\tnav.style.top = headerHeight + 'px';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnav.removeAttribute('style');\r\n\t\t\t\t\t\tnav.classList.remove('nav-fixed-position');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tisTouchDevice() {\r\n\t\tconst userAgent = navigator.userAgent.toLowerCase();\r\n\t\tconst isTablet = /(mac|ipad|tablet|(android(?!.*mobile))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(userAgent);\r\n\t\tconst isSmartphone = /(ipod|iphone|(android(?!.*mobile))|(windows(?!.*phone)(.*touch)))/.test(userAgent);\r\n\t\treturn isTablet || isSmartphone;\r\n\t}\r\n\t\r\n\r\n\tisSafari() {\r\n\t\tconst isSafari = navigator.vendor.match(/apple/i) &&\r\n\t\t\t!navigator.userAgent.match(/crios/i) &&\r\n\t\t\t!navigator.userAgent.match(/fxios/i);\r\n\t\treturn isSafari;\r\n\t}\r\n\r\n\tsticky$() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst targetNode = this.targetNode;\r\n\t\tconst until = this.until;\r\n\t\treturn LocomotiveScrollService.scroll$.pipe(\r\n\t\t\ttap(event => {\t\t\t\t\t\r\n\t\t\t\tif (!this.isTouchDevice() && !this.isSafari()) {\t\t\t\t\t\r\n\t\t\t\t\tconst rect = node.getBoundingClientRect();\r\n\t\t\t\t\tlet y = 0;\r\n\t\t\t\t\tif (this.bottom) {\r\n\t\t\t\t\t\tconst bottom = window.innerHeight - targetNode.offsetHeight;\r\n\t\t\t\t\t\tif (window.innerWidth >= 1024 && rect.y > bottom) {\r\n\t\t\t\t\t\t\ty = bottom - rect.y;\r\n\t\t\t\t\t\t\tthis.sticked = true;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.sticked = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst top = event.direction === 'down' ? 80 : 135;\r\n\t\t\t\t\t\tif (window.innerWidth >= 1024 && rect.y < top) {\r\n\t\t\t\t\t\t\ty = top - rect.y;\r\n\t\t\t\t\t\t\tif (until) {\r\n\t\t\t\t\t\t\t\tconst untilRect = until.getBoundingClientRect();\r\n\t\t\t\t\t\t\t\tconst height = untilRect.y - rect.y;\r\n\t\t\t\t\t\t\t\ty = Math.min(height, y);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.sticked = true;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.sticked = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// console.log(rect.height - targetNode.offsetHeight);\r\n\t\t\t\t\tgsap.set(targetNode, { y });\r\n\r\n\t\t\t\t} else {\t\t\t\t\t\r\n\t\t\t\t\tvar body = document.querySelector('body');\r\n\t\t\t\t\tbody.addEventListener('scroll', function (event) {\r\n\r\n\t\t\t\t\t\tvar nav = document.querySelector('.nav--secondary');\r\n\t\t\t\t\t\tvar materials = document.querySelector('.section--materials');\r\n\t\t\t\t\t\tvar secReserved = document.querySelector('.reserved-section--secondary');\r\n\r\n\t\t\t\t\t\tif (materials !== null) {\r\n\t\t\t\t\t\t\tif (window.innerWidth >= 1024) {\r\n\t\t\t\t\t\t\t\tvar footer = document.querySelector('.group--prefooter');\r\n\t\t\t\t\t\t\t\tconst headerHeight = document.querySelector('.header').offsetHeight\r\n\t\t\t\t\t\t\t\tvar footerOffset = footer.getBoundingClientRect();\r\n\t\t\t\t\t\t\t\tvar topFooter = footerOffset.top;\r\n\t\t\t\t\t\t\t\tvar materialsOffset = materials.getBoundingClientRect();\r\n\t\t\t\t\t\t\t\tvar topMaterials = materialsOffset.top;\r\n\r\n\t\t\t\t\t\t\t\tif ((topMaterials - headerHeight) < 0 && (topFooter > 0)) {\r\n\t\t\t\t\t\t\t\t\tnav.classList.add('nav-fixed-position');\r\n\t\t\t\t\t\t\t\t\tnav.style.top = headerHeight + 'px';\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tnav.removeAttribute('style');\r\n\t\t\t\t\t\t\t\t\tnav.classList.remove('nav-fixed-position');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tnav.removeAttribute('style');\r\n\t\t\t\t\t\t\t\tnav.classList.remove('nav-fixed-position');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (secReserved !== null) {\r\n\t\t\t\t\t\t\tif (window.innerWidth >= 1024) {\r\n\t\t\t\t\t\t\t\tvar footer = document.querySelector('.group--prefooter');\r\n\t\t\t\t\t\t\t\tconst headerHeight = document.querySelector('.header').offsetHeight\r\n\t\t\t\t\t\t\t\tvar footerOffset = footer.getBoundingClientRect();\r\n\t\t\t\t\t\t\t\tvar topFooter = footerOffset.top;\r\n\t\t\t\t\t\t\t\tvar materialsOffset = secReserved.getBoundingClientRect();\r\n\t\t\t\t\t\t\t\tvar topMaterials = materialsOffset.top;\r\n\r\n\t\t\t\t\t\t\t\tif ((topMaterials - headerHeight) < 0 && (topFooter > 0)) {\r\n\t\t\t\t\t\t\t\t\tnav.classList.add('nav-fixed-position');\r\n\t\t\t\t\t\t\t\t\tnav.style.top = headerHeight + 'px';\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tnav.removeAttribute('style');\r\n\t\t\t\t\t\t\t\t\tnav.classList.remove('nav-fixed-position');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tnav.removeAttribute('style');\r\n\t\t\t\t\t\t\t\tnav.classList.remove('nav-fixed-position');\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, false);\r\n\t\t\t\t\t\r\n\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nLocomotiveScrollStickyDirective.meta = {\r\n\tselector: '[locomotive-scroll-sticky],[[locomotive-scroll-sticky]]',\r\n\tinputs: ['target', 'until', 'bottom'],\r\n};\r\n","import { Directive, getContext } from 'rxcomp';\r\nimport { fromEvent } from 'rxjs';\r\nimport { takeUntil, tap } from 'rxjs/operators';\r\nimport { LocomotiveScrollService } from './locomotive-scroll.service';\r\n\r\nexport class LocomotiveScrollToDirective extends Directive {\r\n\r\n\tonInit() {\r\n\t\tthis.initialFocus = false;\r\n\t\tconst { module, node } = getContext(this);\r\n\t\tconst expression = this.expression = node.getAttribute(`(locomotiveScrollTo)`);\r\n\t\tthis.outputFunction = module.makeFunction(expression, ['$event']);\r\n\t\tthis.scrollTo$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tscrollTo$() {\r\n\t\tconst { module, node, parentInstance } = getContext(this);\r\n\t\treturn fromEvent(node, 'click').pipe(\r\n\t\t\ttap(event => {\r\n\t\t\t\tif (event) {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t\tconst selector = module.resolve(this.outputFunction, parentInstance, event);\r\n\t\t\t\tif (typeof selector === 'string') {\r\n\t\t\t\t\tconst target = node.querySelector(selector) || document.querySelector(selector);\r\n\t\t\t\t\tif (target) {\r\n\t\t\t\t\t\tconst offset = this.offset;\r\n\t\t\t\t\t\tconst options = offset ? { offset } : undefined;\r\n\t\t\t\t\t\tLocomotiveScrollService.scrollTo(target, options);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nLocomotiveScrollToDirective.meta = {\r\n\tselector: `[(locomotiveScrollTo)]`,\r\n\tinputs: ['offset']\r\n};\r\n","import { Directive, getContext } from 'rxcomp';\r\nimport { takeUntil } from 'rxjs/operators';\r\nimport { LocomotiveScrollService } from './locomotive-scroll.service';\r\n\r\nexport class LocomotiveScrollDirective extends Directive {\r\n\r\n\tonInit() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tLocomotiveScrollService.init$(node).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe(event => {\r\n\t\t\t// console.log('LocomotiveScrollDirective', event);\r\n\t\t});\r\n\t\tif ('ResizeObserver' in window) {\r\n\t\t\tconst resizeObserver = new ResizeObserver(entries => {\r\n\t\t\t\t// console.log('LocomotiveScrollDirective.ResizeObserver', entries[0].target.clientHeight);\r\n\t\t\t\tLocomotiveScrollService.update();\r\n\t\t\t});\r\n\t\t\tresizeObserver.observe(node);\r\n\t\t}\r\n\t\t/*\r\n\t\tconst images = Array.prototype.slice.call(document.querySelectorAll('img'));\r\n\t\timages.forEach(image => {\r\n\t\t\timage.onload = () => {\r\n\t\t\t\tconsole.log(update);\r\n\t\t\t\tinstance.update();\r\n\t\t\t};\r\n\t\t});\r\n\t\t*/\r\n\t\t/*\r\n\t\twindow.onload = () => {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tconst instance = LocomotiveScrollService.init(node);\r\n\t\t\t\tif (instance) {\r\n\t\t\t\t\tinstance.on('scroll', instance => {\r\n\t\t\t\t\t\tLocomotiveScrollService.scroll(instance.scroll.y);\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst body = document.querySelector('body');\r\n\t\t\t\t\twindow.addEventListener('scroll', () => {\r\n\t\t\t\t\t\tconst y = body.scrollTop; // window.pageYOffset\r\n\t\t\t\t\t\tLocomotiveScrollService.scroll(y);\r\n\t\t\t\t\t}, true);\r\n\t\t\t\t}\r\n\t\t\t}, 1);\r\n\t\t};\r\n\t\t*/\r\n\t}\r\n\r\n}\r\n\r\nLocomotiveScrollDirective.meta = {\r\n\tselector: '[locomotive-scroll],[[locomotive-scroll]]'\r\n};\r\n","import { Directive, getContext } from 'rxcomp';\r\nimport { takeUntil, tap } from 'rxjs/operators';\r\nimport { LocomotiveScrollService } from './locomotive-scroll.service';\r\n\r\nexport class ScrollDirective extends Directive {\r\n\r\n\tonInit() {\r\n\t\tif (LocomotiveScrollService.useLocomotiveScroll()) {\r\n\t\t\tthis.scroll$().pipe(\r\n\t\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t\t).subscribe(event => {\r\n\t\t\t\t// console.log('ScrollDirective', event);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tscroll$() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst speed = this.scrollSpeed ? parseFloat(this.scrollSpeed) : 1.5;\r\n\t\treturn LocomotiveScrollService.scroll$.pipe(\r\n\t\t\ttap(scroll => {\r\n\t\t\t\tconst wh = window.innerHeight;\r\n\t\t\t\tconst rect = node.getBoundingClientRect();\r\n\t\t\t\tconst currentY = gsap.getProperty(node, 'y');\r\n\t\t\t\tconst top = rect.top - currentY;\r\n\t\t\t\tconst height = rect.height;\r\n\t\t\t\tconst space = wh + height;\r\n\t\t\t\tlet pow;\r\n\t\t\t\tif (top > -height && top < wh) {\r\n\t\t\t\t\tpow = (top + height) / space;\r\n\t\t\t\t\tpow = 1 - pow * 2;\r\n\t\t\t\t\tconst y = pow * speed * -100;\r\n\t\t\t\t\tgsap.set(node, { y });\r\n\t\t\t\t}\r\n\t\t\t\t/*\r\n\t\t\t\tconst wh2 = wh / 2;\r\n\t\t\t\tconst bottom = rect.bottom - currentY;\r\n\t\t\t\tif (top < wh && bottom > 0) {\r\n\t\t\t\t\tpow = (top - wh2) / wh2;\r\n\t\t\t\t\tconst y = pow * speed * 40;\r\n\t\t\t\t\tgsap.set(node, { y });\r\n\t\t\t\t}\r\n\t\t\t\t*/\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nScrollDirective.meta = {\r\n\tselector: '[scroll]',\r\n\tinputs: ['scrollSpeed'],\r\n};\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { takeUntil } from 'rxjs/operators';\r\nimport { ModalService } from './modal.service';\r\n\r\nexport class ModalOutletComponent extends Component {\r\n\r\n\tget modal() {\r\n\t\treturn this.modal_;\r\n\t}\r\n\r\n\tset modal(modal) {\r\n\t\t// console.log('ModalOutletComponent set modal', modal, this);\r\n\t\tconst { module } = getContext(this);\r\n\t\tif (this.modal_ && this.modal_.node) {\r\n\t\t\tmodule.remove(this.modal_.node, this);\r\n\t\t\tthis.modalNode.removeChild(this.modal_.node);\r\n\t\t}\r\n\t\tif (modal && modal.node) {\r\n\t\t\tthis.modal_ = modal;\r\n\t\t\tthis.modalNode.appendChild(modal.node);\r\n\t\t\tconst instances = module.compile(modal.node);\r\n\t\t}\r\n\t\tthis.modal_ = modal;\r\n\t\tthis.pushChanges();\r\n\t}\r\n\r\n\tget busy() {\r\n\t\treturn this.busy_;\r\n\t}\r\n\r\n\tset busy(busy) {\r\n\t\t// console.log('ModalOutletComponent set busy', busy, this);\r\n\t\tif (this.busy_ !== busy) {\r\n\t\t\tthis.busy_ = busy;\r\n\t\t\tthis.pushChanges();\r\n\t\t}\r\n\t}\r\n\r\n\tonInit() {\r\n\t\tthis.busy_ = false;\r\n\t\tconst { node } = getContext(this);\r\n\t\tthis.modalNode = node.querySelector('.modal-outlet__modal');\r\n\t\tModalService.modal$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(modal => this.modal = modal);\r\n\t\tModalService.busy$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(busy => this.busy = busy);\r\n\t}\r\n\r\n\treject(event) {\r\n\t\tModalService.reject();\r\n\t}\r\n\r\n}\r\n\r\nModalOutletComponent.meta = {\r\n\tselector: '[modal-outlet]',\r\n\ttemplate: /* html */ `\r\n\t<div class=\"modal-outlet__container\" [class]=\"{ active: modal, busy: busy }\">\r\n\t\t<div class=\"modal-outlet__background\" (click)=\"reject($event)\"></div>\r\n\t\t<div class=\"modal-outlet__modal\"></div>\r\n\t\t<!-- spinner -->\r\n\t\t<div class=\"spinner spinner--contrasted\" *if=\"busy\"></div>\r\n\t</div>\r\n\t`\r\n};\r\n","import { Directive, getContext } from 'rxcomp';\r\n\r\nexport class NameDirective extends Directive {\r\n\r\n\tonChanges() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tnode.setAttribute('name', this.name);\r\n\t}\r\n\r\n}\r\n\r\nNameDirective.meta = {\r\n\tselector: '[[name]]',\r\n\tinputs: ['name']\r\n};\r\n","import { Pipe } from 'rxcomp';\r\nimport { environment } from '../../environment';\r\n\r\nexport class NumberPipe extends Pipe {\r\n\r\n\tstatic transform(value, options = {}, language = null) { // = 'en-IN'\r\n\t\tif (value != null) { // !!! keep losing\r\n\t\t\tlanguage = language || environment.currentLanguage;\r\n\t\t\treturn new Intl.NumberFormat(language, options).format(value);\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nNumberPipe.meta = {\r\n\tname: 'number',\r\n};\r\n","import { Pipe } from 'rxcomp';\r\nimport { environment } from '../../environment';\r\n\r\nconst DIVISIONS = [\r\n\t{ amount: 60, name: 'seconds' },\r\n\t{ amount: 60, name: 'minutes' },\r\n\t{ amount: 24, name: 'hours' },\r\n\t{ amount: 7, name: 'days' },\r\n\t{ amount: 4.34524, name: 'weeks' },\r\n\t{ amount: 12, name: 'months' },\r\n\t{ amount: Number.POSITIVE_INFINITY, name: 'years' }\r\n];\r\n\r\nconst useWeeks = true;\r\n\r\nexport class RelativeDatePipe extends Pipe {\r\n\r\n\tstatic transform(value, options = { numeric: 'auto' }, language = null) { // = 'en-IN'\r\n\t\tif (value != null) { // !!! keep losing\r\n\t\t\tconst date = value instanceof Date ? value : new Date(value);\r\n\t\t\tlanguage = language || environment.currentLanguage;\r\n\t\t\tconst formatter = new Intl.RelativeTimeFormat(language, options);\r\n\t\t\tlet duration = (date - new Date()) / 1000;\r\n\t\t\tif (useWeeks) {\r\n\t\t\t\treturn formatter.format(Math.round(duration / 60 / 60 / 24 / 7), 'weeks');\r\n\t\t\t}\r\n\t\t\tfor (let i = 0; i <= DIVISIONS.length; i++) {\r\n\t\t\t\tconst division = DIVISIONS[i];\r\n\t\t\t\tif (Math.abs(duration) < division.amount) {\r\n\t\t\t\t\treturn formatter.format(Math.round(duration), division.name);\r\n\t\t\t\t}\r\n\t\t\t\tduration /= division.amount;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nRelativeDatePipe.meta = {\r\n\tname: 'relativeDate',\r\n};\r\n","import { Directive, getContext } from 'rxcomp';\r\nimport { fromEvent } from 'rxjs';\r\nimport { takeUntil, tap } from 'rxjs/operators';\r\n\r\nexport class ShareDirective extends Directive {\r\n\r\n\tget href() {\r\n\t\tswitch (this.share) {\r\n\t\t\tcase 'facebook':\r\n\t\t\t\treturn this.facebookUrl;\r\n\t\t\tcase 'pinterest':\r\n\t\t\t\treturn this.pinterestUrl;\r\n\t\t\tcase 'linkedIn':\r\n\t\t\t\treturn this.linkedInUrl;\r\n\t\t\tcase 'twitter':\r\n\t\t\t\treturn this.twitterUrl;\r\n\t\t\tcase 'whatsapp':\r\n\t\t\t\treturn this.whatsappUrl;\r\n\t\t\tcase 'mailTo':\r\n\t\t\t\treturn this.mailToUrl;\r\n\t\t}\r\n\t}\r\n\r\n\tget facebookUrl() {\r\n\t\treturn `https://www.facebook.com/sharer/sharer.php?u=${this.url}`;\r\n\t}\r\n\r\n\tget pinterestUrl() {\r\n\t\treturn `https://www.pinterest.com/pin/create/button/?url=${this.url}&media=&description=${this.title}`;\r\n\t}\r\n\r\n\tget linkedInUrl() {\r\n\t\treturn `https://www.linkedin.com/shareArticle?mini=true&url=${this.url}&title=${this.title}`;\r\n\t}\r\n\r\n\tget twitterUrl() {\r\n\t\treturn `https://twitter.com/intent/tweet?text=${this.title}%20${this.url}`;\r\n\t}\r\n\r\n\tget whatsappUrl() {\r\n\t\treturn `https://api.whatsapp.com/send?text=${this.url}`;\r\n\t}\r\n\r\n\tget mailToUrl() {\r\n\t\treturn `mailto:?subject=${this.title}&body=${this.url}`;\r\n\t}\r\n\r\n\tget title() {\r\n\t\tconst title = this.shareTitle ? this.shareTitle : document.title;\r\n\t\treturn this.encodeURI(title);\r\n\t}\r\n\r\n\tget url() {\r\n\t\tlet url = this.shareUrl;\r\n\t\tif (url) {\r\n\t\t\tif (url.indexOf(window.location.origin) === -1) {\r\n\t\t\t\turl = window.location.origin + (url.indexOf('/') === 0 ? url : ('/' + url));\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\turl = window.location.href;\r\n\t\t}\r\n\t\treturn this.encodeURI(url);\r\n\t}\r\n\r\n\tonInit() {\r\n\t\t// console.log('ShareComponent.onInit', this.share, this.title);\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst href = this.href;\r\n\t\tnode.setAttribute('href', href);\r\n\t\tif (this.share !== 'mailTo') {\r\n\t\t\tnode.setAttribute('target', '_blank');\r\n\t\t\tfromEvent(node, 'click').pipe(\r\n\t\t\t\ttap(event => {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\twindow.open(href, 'ShareWindow', window.innerWidth >= 768 ? 'width=640,height=480' : '');\r\n\t\t\t\t}),\r\n\t\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t\t).subscribe();\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\tonChanges() {\r\n\t\tconsole.log('ShareComponent.onChanges', this.share, this.shareTitle);\r\n\t}\r\n\t*/\r\n\r\n\tencodeURI(text) {\r\n\t\treturn encodeURIComponent(text).replace(/[!'()*]/g, function(c) {\r\n\t\t\treturn '%' + c.charCodeAt(0).toString(16);\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\nShareDirective.meta = {\r\n\tselector: '[share]',\r\n\tinputs: ['share', 'shareUrl', 'shareTitle'],\r\n};\r\n","import { Pipe } from 'rxcomp';\r\nimport { environment } from '../../environment';\r\n\r\nexport class SlugPipe extends Pipe {\r\n\r\n\tstatic transform(key) {\r\n\t\tconst slug = environment.slug;\r\n\t\treturn slug[key] || `#${key}`;\r\n\t}\r\n\r\n}\r\n\r\nSlugPipe.meta = {\r\n\tname: 'slug',\r\n};\r\n","import { getContext, Structure } from 'rxcomp';\r\n\r\nexport class SvgIconStructure extends Structure {\r\n\tonInit() {\r\n\t\tthis.update();\r\n\t}\r\n\tonChanges() {\r\n\t\tthis.update();\r\n\t}\r\n\tupdate() {\r\n\t\tif (this.name_ !== this.name) {\r\n\t\t\tthis.name_ = this.name;\r\n\t\t\tconst { node } = getContext(this);\r\n\t\t\tif (node.parentNode) {\r\n\t\t\t\tconst xmlns = 'http://www.w3.org/2000/svg';\r\n\t\t\t\tconst element = document.createElementNS(xmlns, `svg`);\r\n\t\t\t\tconst w = this.width || 24;\r\n\t\t\t\tconst h = this.height || 24;\r\n\t\t\t\telement.setAttribute('class', `icon--${this.name}`);\r\n\t\t\t\t// element.setAttributeNS(null, 'width', w);\r\n\t\t\t\t// element.setAttributeNS(null, 'height', h);\r\n\t\t\t\telement.setAttributeNS(null, 'viewBox', `0 0 ${w} ${h}`);\r\n\t\t\t\telement.innerHTML = `<use xlink:href=\"#${this.name}\"></use>`;\r\n\t\t\t\telement.rxcompId = node.rxcompId;\r\n\t\t\t\telement.classList.add(...node.classList);\r\n\t\t\t\tnode.parentNode.replaceChild(element, node);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nSvgIconStructure.meta = {\r\n\tselector: 'svg-icon',\r\n\tinputs: ['name', 'width', 'height']\r\n};\r\n\r\n/*\r\n<svg class=\"copy\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><use xlink:href=\"#copy\"></use></svg>\r\n*/\r\n","import { Component, getContext, getContextByNode } from 'rxcomp';\r\nimport { Subject } from 'rxjs';\r\n\r\nlet UID = 0;\r\n\r\nexport class SwiperDirective extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.options = {\r\n\t\t\tslidesPerView: 'auto',\r\n\t\t\tspaceBetween: 0,\r\n\t\t\tcenteredSlides: true,\r\n\t\t\tspeed: 600,\r\n\t\t\t/*\r\n\t\t\tautoplay: {\r\n\t\t\t\tdelay: 5000,\r\n\t\t\t},\r\n\t\t\t*/\r\n\t\t\tkeyboardControl: true,\r\n\t\t\tmousewheelControl: false,\r\n\t\t\tpagination: {\r\n\t\t\t\tel: '.swiper-pagination',\r\n\t\t\t\tclickable: true,\r\n\t\t\t},\r\n\t\t\tkeyboard: {\r\n\t\t\t\tenabled: true,\r\n\t\t\t\tonlyInViewport: true,\r\n\t\t\t},\r\n\t\t};\r\n\t\tthis.init_();\r\n\t}\r\n\r\n\tget enabled() {\r\n\t\treturn !window.matchMedia('print').matches;\r\n\t}\r\n\r\n\tonChanges() {\r\n\t\tthis.swiperInitOrUpdate_();\r\n\t}\r\n\r\n\tonDestroy() {\r\n\t\tthis.removeListeners_();\r\n\t\tthis.swiperDestroy_();\r\n\t}\r\n\r\n\tonBeforePrint() {\r\n\t\tthis.swiperDestroy_();\r\n\t}\r\n\r\n\tslideToIndex(index) {\r\n\t\t// console.log('SwiperDirective.slideToIndex', index);\r\n\t\tif (this.swiper) {\r\n\t\t\tthis.swiper.slideTo(index);\r\n\t\t}\r\n\t}\r\n\r\n\thasPrev() {\r\n\t\tconst swiper = this.swiper;\r\n\t\tif (swiper) {\r\n\t\t\t// console.log('SwiperDirective.hasPrev', swiper.activeIndex, swiper.realIndex, swiper.slides.length);\r\n\t\t\tif (swiper.activeIndex > 0 && swiper.slides.length > swiper.activeIndex) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\thasNext() {\r\n\t\tconst swiper = this.swiper;\r\n\t\tif (swiper) {\r\n\t\t\tconst slidesPerView = swiper.params.slidesPerView === 'auto' ? 1 : (swiper.params.slidesPerView || 1);\r\n\t\t\t// console.log('SwiperDirective.hasNext', swiper.slides.length, slidesPerView, swiper.activeIndex);\r\n\t\t\tif (swiper.activeIndex < swiper.slides.length - slidesPerView) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tslidePrev() {\r\n\t\tconst swiper = this.swiper;\r\n\t\tif (this.hasPrev()) {\r\n\t\t\t// console.log('SwiperDirective.slidePrev', swiper.activeIndex, swiper.realIndex, swiper.slides);\r\n\t\t\tswiper.slideTo(swiper.activeIndex - 1);\r\n\t\t}\r\n\t}\r\n\r\n\tslideNext() {\r\n\t\tconst swiper = this.swiper;\r\n\t\tif (this.hasNext()) {\r\n\t\t\t// console.log('SwiperDirective.slideNext', swiper.activeIndex, swiper.realIndex, swiper.slides);\r\n\t\t\tswiper.slideTo(swiper.activeIndex + 1);\r\n\t\t}\r\n\t}\r\n\r\n\tinit_(target) {\r\n\t\tthis.events$ = new Subject();\r\n\t\tif (this.enabled) {\r\n\t\t\tconst { node } = getContext(this);\r\n\t\t\ttarget = target || node;\r\n\t\t\tthis.target = target;\r\n\t\t\tgsap.set(target, { opacity: 0 });\r\n\t\t\tthis.index = 0;\r\n\t\t\tconst on = this.options.on || {};\r\n\t\t\tconst self = this;\r\n\t\t\ton.slideChange = () => {\r\n\t\t\t\tconst swiper = this.swiper;\r\n\t\t\t\tif (swiper) {\r\n\t\t\t\t\t// console.log('SwiperDirective.onSlideChange', swiper.activeIndex);\r\n\r\n\t\t\t\t\tconst slide = swiper.slides[swiper.realIndex];\r\n\t\t\t\t\tif (slide.classList.contains('swiper-slide--video')) {\r\n\t\t\t\t\t\tswiper.el.classList.add('swiper-container--video');\r\n\t\t\t\t\t\tswiper.params.touchRatio = 0;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tswiper.el.classList.remove('swiper-container--video');\r\n\t\t\t\t\t\tswiper.params.touchRatio = 1;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.index = swiper.activeIndex;\r\n\t\t\t\t\tthis.events$.next(this.index);\r\n\t\t\t\t\tthis.pushChanges();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ton.slideChangeTransitionStart = function() {\r\n\t\t\t\tconst swiper = this;\r\n\t\t\t\tself.slideChangeTransitionStart(swiper);\r\n\t\t\t};\r\n\t\t\ton.slideChangeTransitionEnd = function() {\r\n\t\t\t\tconst swiper = this;\r\n\t\t\t\tself.slideChangeTransitionEnd(swiper);\r\n\t\t\t};\r\n\r\n\t\t\tthis.options.on = on;\r\n\t\t\tthis.addListeners_();\r\n\t\t}\r\n\t}\r\n\r\n\tslideChangeTransitionStart(swiper) {\r\n\t\tthis.onToggleVideo(swiper);\r\n\t}\r\n\r\n\tslideChangeTransitionEnd(swiper) {\r\n\t\tthis.onCheckAutoplay();\r\n\t}\r\n\r\n\tonToggleVideo(swiper) {\r\n\t\tArray.from(swiper.slides).forEach(slide => {\r\n\t\t\tconst target = slide.querySelector('video, [thron]');\r\n\t\t\tif (target) {\r\n\t\t\t\tif (slide.classList.contains('swiper-slide-active')) {\r\n\t\t\t\t\tif (target.hasAttribute('thron')) {\r\n\t\t\t\t\t\tconst context = getContextByNode(target);\r\n\t\t\t\t\t\tcontext.instance.playVideo();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttarget.play();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (target.hasAttribute('thron')) {\r\n\t\t\t\t\t\tconst context = getContextByNode(target);\r\n\t\t\t\t\t\tcontext.instance.pauseVideo();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttarget.pause();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t/*\r\n\t\tArray.from(swiper.slides).forEach(slide => {\r\n\t\t\tconst node = slide.querySelector('video, [thron]');\r\n\t\t\tif (node) {\r\n\t\t\t\tif (node.hasAttribute('thron')) {\r\n\t\t\t\t\tconst context = getContextByNode(node);\r\n\t\t\t\t\tcontext.instance.pauseVideo();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnode.pause();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t*/\r\n\t}\r\n\r\n\tonCheckAutoplay() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tif (!node.hasAttribute('autoplay')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.to) {\r\n\t\t\tclearTimeout(this.to);\r\n\t\t}\r\n\t\t// console.log('onCheckAutoplay', Array.prototype.slice.call(node.querySelectorAll('.swiper-slide')).map(x => x.classList.toString()).join(', '));\r\n\t\tconst video = node.querySelector('.swiper-slide-active video, .swiper-slide-active [thron]');\r\n\t\t// console.log('onCheckAutoplay.video', video);\r\n\t\tif (!video) {\r\n\t\t\tthis.to = setTimeout(() => {\r\n\t\t\t\tthis.onNext();\r\n\t\t\t}, 5000);\r\n\t\t}\r\n\t}\r\n\r\n\tonNext() {\r\n\t\tconst swiper = this.swiper;\r\n\t\tif (swiper) {\r\n\t\t\tif (swiper.realIndex == swiper.slides.length - 1) {\r\n\t\t\t\tswiper.slideTo(0);\r\n\t\t\t} else {\r\n\t\t\t\tswiper.slideNext();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tonThronReady(event) {\r\n\t\t// console.log('onThronReady', event);\r\n\t\tif (this.swiper) {\r\n\t\t\tthis.onToggleVideo(this.swiper);\r\n\t\t}\r\n\t}\r\n\r\n\tonThronComplete(event) {\r\n\t\t// console.log('onThronComplete');\r\n\t\tthis.onNext();\r\n\t}\r\n\r\n\taddListeners_() {\r\n\t\tthis.onBeforePrint = this.onBeforePrint.bind(this);\r\n\t\twindow.addEventListener('beforeprint', this.onBeforePrint);\r\n\t\t/*\r\n\t\tscope.$on('onResize', ($scope) => {\r\n\t\t\tthis.onResize(scope, element, attributes);\r\n\t\t});\r\n\t\t*/\r\n\t}\r\n\r\n\tremoveListeners_() {\r\n\t\twindow.removeEventListener('beforeprint', this.onBeforePrint);\r\n\t}\r\n\r\n\tswiperInitOrUpdate_() {\r\n\t\tif (this.enabled) {\r\n\t\t\tconst target = this.target;\r\n\t\t\tlet swiper = this.swiper;\r\n\t\t\tif (swiper) {\r\n\t\t\t\tswiper.update();\r\n\t\t\t\t// swiper.slideTo(0, 0);\r\n\t\t\t} else {\r\n\t\t\t\tthis.id = ++UID;\r\n\t\t\t\ttarget.setAttribute('swiper-id', this.id);\r\n\t\t\t\tif (this.options.pagination && this.options.pagination.el) {\r\n\t\t\t\t\tthis.options.pagination.el = `[swiper-id=\"${this.id}\"] ${this.options.pagination.el}`;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.options.navigation && this.options.navigation.nextEl) {\r\n\t\t\t\t\tthis.options.navigation.nextEl = `[swiper-id=\"${this.id}\"] ${this.options.navigation.nextEl}`;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.options.navigation && this.options.navigation.prevEl) {\r\n\t\t\t\t\tthis.options.navigation.prevEl = `[swiper-id=\"${this.id}\"] ${this.options.navigation.prevEl}`;\r\n\t\t\t\t}\r\n\t\t\t\t// console.log(this.options);\r\n\t\t\t\tconst on = this.options.on || (this.options.on = {});\r\n\t\t\t\tconst callback = on.init;\r\n\t\t\t\tif (!on.init || !on.init.swiperDirectiveInit) {\r\n\t\t\t\t\ton.init = () => {\r\n\t\t\t\t\t\tgsap.to(target, {\r\n\t\t\t\t\t\t\tduration: 0.4,\r\n\t\t\t\t\t\t\topacity: 1,\r\n\t\t\t\t\t\t\tease: Power2.easeOut,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tif (typeof callback === 'function') {\r\n\t\t\t\t\t\t\t\tcallback.apply(this, [swiper, element, scope]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.onCheckAutoplay();\r\n\t\t\t\t\t\t}, 1);\r\n\t\t\t\t\t};\r\n\t\t\t\t\ton.init.swiperDirectiveInit = true;\r\n\t\t\t\t}\r\n\t\t\t\tgsap.set(target, { opacity: 1 });\r\n\t\t\t\tswiper = new Swiper(target, this.options);\r\n\t\t\t\t// swiper.slideTo(0, 0);\r\n\t\t\t\t// console.log(swiper);\r\n\t\t\t\tthis.swiper = swiper;\r\n\t\t\t\tswiper._opening = true;\r\n\t\t\t\ttarget.classList.add('swiper-init');\r\n\t\t\t}\r\n\t\t\tconst { node } = getContext(this);\r\n\t\t\tconst images = Array.prototype.slice.call(node.querySelectorAll('img'));\r\n\t\t\timages.forEach(x => {\r\n\t\t\t\tconst onLoad = () => {\r\n\t\t\t\t\tx.removeEventListener('load', onLoad);\r\n\t\t\t\t\tif (swiper.activeIndex > 0) {\r\n\t\t\t\t\t\t// console.log('SwiperDirective.imgOnLoad', swiper.activeIndex);\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tswiper.slideTo(0, 0);\r\n\t\t\t\t\t\t}, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tx.addEventListener('load', onLoad);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tswiperDestroy_() {\r\n\t\tif (this.swiper) {\r\n\t\t\tthis.swiper.destroy();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nSwiperDirective.meta = {\r\n\tselector: '[swiper]',\r\n\tinputs: ['consumer']\r\n};\r\n","import { fromEvent, of } from 'rxjs';\r\nimport { map, shareReplay } from 'rxjs/operators';\r\n\r\n// <!-- <script id=ta_bootstrapper src='https://gruppoconcorde-cdn.thron.com/shared/plugins/tracking/current/bootstrapper-min.js'></script> -->\r\n// <script src='https://gruppoconcorde-cdn.thron.com/shared/ce/bootstrap/1/scripts/embeds-min.js'></script>\r\n\r\nexport class ThronService {\r\n\r\n\tstatic thron$() {\r\n\t\tlet thron = window.THRONContentExperience || window.THRONPlayer;\r\n\t\tif (thron) {\r\n\t\t\treturn of(thron);\r\n\t\t} else {\r\n\t\t\tconst script = document.createElement('script');\r\n\t\t\tscript.setAttribute('type', 'text/javascript');\r\n\t\t\tscript.setAttribute('src', 'https://gruppoconcorde-cdn.thron.com/shared/ce/bootstrap/1/scripts/embeds-min.js')\r\n\t\t\tconst loaded$ = fromEvent(script, 'load').pipe(\r\n\t\t\t\t// tap(event => console.log(event, window.THRONContentExperience || window.THRONPlayer)),\r\n\t\t\t\tmap(event => window.THRONContentExperience || window.THRONPlayer),\r\n\t\t\t\tshareReplay(1),\r\n\t\t\t);\r\n\t\t\treturn document.head.appendChild(script) && loaded$;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { first, tap } from 'rxjs/operators';\r\nimport { ThronService } from './thron.service';\r\n\r\nlet ID = 0;\r\n\r\nexport class ThronComponent extends Component {\r\n\r\n\tplaying_ = false;\r\n\tget playing() {\r\n\t\treturn this.playing_;\r\n\t}\r\n\tset playing(playing) {\r\n\t\tif (this.playing_ !== playing) {\r\n\t\t\tthis.playing_ = playing;\r\n\t\t\tconst { node } = getContext(this);\r\n\t\t\tif (node) {\r\n\t\t\t\tplaying ? node.classList.add('playing') : node.classList.remove('playing');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tonInit() {\r\n\t\t// console.log('ThronComponent.onInit');\r\n\t\tthis.init$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tinit$() {\r\n\t\treturn ThronService.thron$().pipe(\r\n\t\t\ttap(THRON => {\r\n\t\t\t\t// const THRON = window.THRONContentExperience || window.THRONPlayer;\r\n\t\t\t\tif (!THRON) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t// console.log('THRONContentExperience', window.THRONContentExperience, 'THRONPlayer', window.THRONPlayer);\r\n\t\t\t\tconst { node } = getContext(this);\r\n\t\t\t\tconst target = this.target = node.querySelector('.video > .thron');\r\n\t\t\t\tconst id = target.id = `thron-${++ID}`;\r\n\t\t\t\tlet media = this.thron;\r\n\t\t\t\tif (media.indexOf('pkey=') === -1) {\r\n\t\t\t\t\tconst splitted = media.split('/');\r\n\t\t\t\t\tconst clientId = splitted[6];\r\n\t\t\t\t\tconst xcontentId = splitted[7];\r\n\t\t\t\t\tconst pkey = splitted[8];\r\n\t\t\t\t\tmedia = `https://gruppoconcorde-view.thron.com/api/xcontents/resources/delivery/getContentDetail?clientId=${clientId}&xcontentId=${xcontentId}&pkey=${pkey}`;\r\n\t\t\t\t}\r\n\t\t\t\tconst controls = this.controls = node.hasAttribute('controls') ? true : false,\r\n\t\t\t\t\tloop = this.loop = node.hasAttribute('loop') ? true : false,\r\n\t\t\t\t\tautoplay = this.autoplay = node.hasAttribute('autoplay') ? true : false;\r\n\t\t\t\tconst player = this.player = THRON(id, {\r\n\t\t\t\t\tmedia: media,\r\n\t\t\t\t\tloop: loop,\r\n\t\t\t\t\tautoplay: autoplay,\r\n\t\t\t\t\tmuted: !controls,\r\n\t\t\t\t\tdisplayLinked: 'close',\r\n\t\t\t\t\tnoSkin: !controls,\r\n\t\t\t\t\t// lockBitrate: 'max',\r\n\t\t\t\t});\r\n\t\t\t\tthis.onReady = this.onReady.bind(this);\r\n\t\t\t\tthis.onCanPlay = this.onCanPlay.bind(this);\r\n\t\t\t\tthis.onPlaying = this.onPlaying.bind(this);\r\n\t\t\t\tthis.onPlay = this.onPlay.bind(this);\r\n\t\t\t\tthis.onPause = this.onPause.bind(this);\r\n\t\t\t\tthis.onComplete = this.onComplete.bind(this);\r\n\t\t\t\tplayer.on('ready', this.onReady);\r\n\t\t\t\tplayer.on('canPlay', this.onCanPlay);\r\n\t\t\t\tplayer.on('playing', this.onPlaying);\r\n\t\t\t\tplayer.on('play', this.onPlay);\r\n\t\t\t\tplayer.on('pause', this.onPause);\r\n\t\t\t\tplayer.on('complete', this.onComplete);\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tonReady() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst id = this.target.id;\r\n\t\tconst player = this.player;\r\n\t\tif (node.hasAttribute('autoplay')) {\r\n\t\t\tconst mediaContainer = player.mediaContainer();\r\n\t\t\tconst video = mediaContainer.querySelector('video');\r\n\t\t\tvideo.setAttribute('playsinline', 'true');\r\n\t\t\tvideo.setAttribute('autoplay', 'true');\r\n\t\t}\r\n\t\tthis.ready.next(id);\r\n\t\t// video.setAttribute('autoplay', 'true');\r\n\t};\r\n\r\n\tonCanPlay() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst id = this.target.id;\r\n\t\t// console.log('ThronDirective.onCanPlay', id);\r\n\t\tthis.canPlay.next(id);\r\n\t}\r\n\r\n\tonPlaying() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst id = this.target.id;\r\n\t\tconst player = this.player;\r\n\t\tplayer.off('playing', this.onPlaying);\r\n\t\tif (!this.controls) {\r\n\t\t\tconst qualities = player.qualityLevels();\r\n\t\t\t// console.log('ThronDirective.onPlaying', id, qualities);\r\n\t\t\tif (qualities.length) {\r\n\t\t\t\tconst highestQuality = qualities[qualities.length - 1].index;\r\n\t\t\t\tconst lowestQuality = qualities[0].index;\r\n\t\t\t\tplayer.currentQuality(highestQuality);\r\n\t\t\t\t// console.log('ThronDirective.onPlaying', id, 'currentQuality', player.currentQuality());\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tonPlay() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst id = this.target.id;\r\n\t\t// console.log('ThronDirective.onComplete', id);\r\n\t\tthis.playing = true;\r\n\t\tthis.play.next(id);\r\n\t}\r\n\r\n\tonPause() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst id = this.target.id;\r\n\t\t// console.log('ThronDirective.onComplete', id);\r\n\t\tthis.playing = false;\r\n\t\tthis.pause.next(id);\r\n\t}\r\n\r\n\tonComplete() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst id = this.target.id;\r\n\t\t// console.log('ThronDirective.onComplete', id);\r\n\t\tthis.playing = false;\r\n\t\tthis.complete.next(id);\r\n\t}\r\n\r\n\tplayVideo() {\r\n\t\tif (this.target) {\r\n\t\t\tconst { node } = getContext(this);\r\n\t\t\tconst id = this.target.id;\r\n\t\t\tconst player = this.player;\r\n\t\t\tconst status = player.status();\r\n\t\t\t// console.log('ThronDirective.playVideo', id, status);\r\n\t\t\tif (status && !status.playing) {\r\n\t\t\t\tplayer.play();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tpauseVideo() {\r\n\t\tif (this.target) {\r\n\t\t\tconst { node } = getContext(this);\r\n\t\t\tconst id = this.target.id;\r\n\t\t\tconst player = this.player;\r\n\t\t\tconst status = player.status();\r\n\t\t\t// console.log('ThronDirective.pauseVideo', id, status);\r\n\t\t\tif (status && status.playing) {\r\n\t\t\t\tplayer.pause();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\ttoggle() {\r\n\t\tif (this.target) {\r\n\t\t\tconst { node } = getContext(this);\r\n\t\t\tconst id = this.target.id;\r\n\t\t\tconst player = this.player;\r\n\t\t\tconst status = player.status();\r\n\t\t\t// console.log('ThronDirective.pauseVideo', id, status);\r\n\t\t\tif (status && status.playing) {\r\n\t\t\t\tplayer.pause();\r\n\t\t\t} else {\r\n\t\t\t\tplayer.play();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tplay(id) {\r\n\t\t// console.log('ThronDirective.play', id, id, id === id);\r\n\t\tconst { node } = getContext(this);\r\n\t\tif (id === this.target.id) {\r\n\t\t\tthis.playVideo();\r\n\t\t}\r\n\t}\r\n\r\n\tpause(id) {\r\n\t\t// console.log('ThronDirective.pause', id, id, id === id);\r\n\t\tconst { node } = getContext(this);\r\n\t\tif (id === this.target.id) {\r\n\t\t\tthis.pauseVideo();\r\n\t\t}\r\n\t}\r\n\r\n\tonDestroy() {\r\n\t\tconst player = this.player;\r\n\t\tif (player) {\r\n\t\t\tplayer.off('ready', this.onReady);\r\n\t\t\tplayer.off('canPlay', this.onCanPlay);\r\n\t\t\tplayer.off('playing', this.onPlaying);\r\n\t\t\tplayer.off('play', this.onPlay);\r\n\t\t\tplayer.off('pause', this.onPause);\r\n\t\t\tplayer.off('complete', this.onComplete);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nThronComponent.meta = {\r\n\tselector: '[thron],[[thron]]',\r\n\toutputs: ['ready', 'canPlay', 'play', 'pause', 'complete'],\r\n\tinputs: ['thron', 'm3u8'],\r\n\ttemplate: /* html */``,\r\n};\r\n","import { Directive, getContext } from 'rxcomp';\r\n\r\nexport class TitleDirective extends Directive {\r\n\tset title(title) {\r\n\t\tif (this.title_ !== title) {\r\n\t\t\tthis.title_ = title;\r\n\t\t\tconst { node } = getContext(this);\r\n\t\t\ttitle ? node.setAttribute('title', title) : node.removeAttribute('title');\r\n\t\t}\r\n\t}\r\n\tget title() {\r\n\t\treturn this.title_;\r\n\t}\r\n}\r\n\r\nTitleDirective.meta = {\r\n\tselector: '[[title]]',\r\n\tinputs: ['title'],\r\n};\r\n","import { Module } from 'rxcomp';\r\nimport { AltDirective } from './alt/alt.directive';\r\nimport { ClickOutsideDirective } from './click-outside/click-outside.directive';\r\nimport { DatePipe } from './date/date.pipe';\r\nimport { DownloadDirective } from './download/download.directive';\r\nimport { DropdownItemDirective } from './dropdown/dropdown-item.directive';\r\nimport { DropdownDirective } from './dropdown/dropdown.directive';\r\nimport { EnvPipe } from './env/env.pipe';\r\nimport { FilterItemComponent } from './filter/filter-item.component';\r\nimport { FlagPipe } from './flag/flag.pipe';\r\nimport { HighlightPipe } from './highlight/highlight.pipe';\r\nimport { HtmlPipe } from './html/html.pipe';\r\nimport { IdDirective } from './id/id.directive';\r\nimport { LabelForDirective } from './label-for/label-for.directive';\r\nimport { LabelPipe } from './label/label.pipe';\r\nimport { LocomotiveScrollStickyDirective } from './locomotive-scroll/locomotive-scroll-sticky.directive';\r\nimport { LocomotiveScrollToDirective } from './locomotive-scroll/locomotive-scroll-to.directive';\r\nimport { LocomotiveScrollDirective } from './locomotive-scroll/locomotive-scroll.directive';\r\nimport { ScrollDirective } from './locomotive-scroll/scroll.directive';\r\nimport { ModalOutletComponent } from './modal/modal-outlet.component';\r\nimport { NameDirective } from './name/name.directive';\r\nimport { NumberPipe } from './number/number.pipe';\r\nimport { RelativeDatePipe } from './relative-date/relative-date.pipe';\r\nimport { ShareDirective } from './share/share.directive';\r\nimport { SlugPipe } from './slug/slug.pipe';\r\nimport { SvgIconStructure } from './svg/svg-icon.structure';\r\nimport { SwiperDirective } from './swiper/swiper.directive';\r\nimport { ThronComponent } from './thron/thron.component';\r\nimport { TitleDirective } from './title/title.directive';\r\n\r\nconst factories = [\r\n\tAltDirective,\r\n\tClickOutsideDirective,\r\n\tDownloadDirective,\r\n\t// DropDirective,\r\n\tDropdownDirective,\r\n\tDropdownItemDirective,\r\n\t// DropdownItemDirective,\r\n\tFilterItemComponent,\r\n\tIdDirective,\r\n\tLabelForDirective,\r\n\t// LanguageComponent,\r\n\t// LazyDirective,\r\n\tLocomotiveScrollDirective,\r\n\tLocomotiveScrollStickyDirective,\r\n\tLocomotiveScrollToDirective,\r\n\t// ModalComponent,\r\n\tModalOutletComponent,\r\n\tNameDirective,\r\n\tScrollDirective,\r\n\tShareDirective,\r\n\tSvgIconStructure,\r\n\tSwiperDirective,\r\n\tThronComponent,\r\n\tTitleDirective,\r\n\t// UploadItemComponent,\r\n\t// VirtualStructure\r\n];\r\n\r\nconst pipes = [\r\n\tDatePipe,\r\n\tEnvPipe,\r\n\tFlagPipe,\r\n\tHighlightPipe,\r\n\tHtmlPipe,\r\n\tLabelPipe,\r\n\tNumberPipe,\r\n\tRelativeDatePipe,\r\n\tSlugPipe,\r\n];\r\n\r\nexport class CommonModule extends Module { }\r\n\r\nCommonModule.meta = {\r\n\timports: [\r\n\t],\r\n\tdeclarations: [\r\n\t\t...factories,\r\n\t\t...pipes,\r\n\t],\r\n\texports: [\r\n\t\t...factories,\r\n\t\t...pipes,\r\n\t],\r\n};\r\n","import { Component, getContext } from 'rxcomp';\r\n\r\nlet UID = 10000;\r\n\r\nexport class ControlComponent extends Component {\r\n\r\n\tget uniqueId() {\r\n\t\treturn this.control.name + this.uid;\r\n\t}\r\n\r\n\tonInit() {\r\n\t\tthis.uid = ++UID;\r\n\t\tthis.label = this.label || 'label';\r\n\t}\r\n\r\n\tonChanges() {\r\n\t\tconst { node } = getContext(this);\r\n\t\t// console.log(this, node, this.control);\r\n\t\tconst control = this.control;\r\n\t\tconst flags = control.flags;\r\n\t\tObject.keys(flags).forEach((key) => {\r\n\t\t\tflags[key] ? node.classList.add(key) : node.classList.remove(key);\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\nControlComponent.meta = {\r\n\tselector: '[control]',\r\n\tinputs: ['control']\r\n};\r\n","import { getContext } from 'rxcomp';\r\nimport { fromEvent, merge, of } from 'rxjs';\r\nimport { distinctUntilChanged, map, switchMap, takeUntil, tap } from 'rxjs/operators';\r\nimport { ControlComponent } from './control.component';\r\n\r\nexport class ControlAutocompleteComponent extends ControlComponent {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tconst { node } = getContext(this);\r\n\t\tthis.input = node.querySelector('input');\r\n\t\tthis.disabled = this.disabled || false;\r\n\t\tthis.items = [];\r\n\t\tthis.control.changes$.pipe(\r\n\t\t\ttap(value => {\r\n\t\t\t\tthis.setInputValue(value);\r\n\t\t\t}),\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe();\r\n\t\tthis.query$().pipe(\r\n\t\t\tswitchMap(query => {\r\n\t\t\t\tif (typeof this.source === 'function') {\r\n\t\t\t\t\treturn this.source(query);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn of([]);\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\ttap(items => {\r\n\t\t\t\tthis.items = items;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t}),\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tquery$() {\r\n\t\tconst input = this.input;\r\n\t\treturn merge(\r\n\t\t\tfromEvent(input, 'input'),\r\n\t\t\tfromEvent(input, 'change'),\r\n\t\t).pipe(\r\n\t\t\tmap(event => {\r\n\t\t\t\tconst value = input.value === '' ? null : input.value;\r\n\t\t\t\t// console.log('ControlAutocompleteComponent.query$', value);\r\n\t\t\t\treturn value;\r\n\t\t\t}),\r\n\t\t\tdistinctUntilChanged(),\r\n\t\t);\r\n\t}\r\n\r\n\tsetInputValue(value) {\r\n\t\tconst input = this.input;\r\n\t\tinput.value = value ? value.name : null;\r\n\t}\r\n\r\n\tsetOption(item) {\r\n\t\t// console.log('setOption', item);\r\n\t\tlet value = item.id;\r\n\t\tthis.control.value = item;\r\n\t\tthis.items = [];\r\n\t\tthis.pushChanges();\r\n\t\tthis.change.next(item);\r\n\t}\r\n\r\n\tonClick(event) {\r\n\t\tthis.setInputValue(null);\r\n\t}\r\n\r\n\tonClickOutside(event) {\r\n\t\tif (!this.control.value) {\r\n\t\t\tthis.setInputValue(null);\r\n\t\t}\r\n\t\tthis.items = [];\r\n\t\tthis.pushChanges();\r\n\t}\r\n\r\n\tonReset(event) {\r\n\t\tthis.control.value = null;\r\n\t\tthis.change.next(null);\r\n\t\tif (this.items.length) {\r\n\t\t\tthis.items = [];\r\n\t\t\tthis.pushChanges();\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nControlAutocompleteComponent.meta = {\r\n\tselector: '[control-autocomplete]',\r\n\toutputs: ['change'],\r\n\tinputs: ['control', 'label', 'disabled', 'source'],\r\n\ttemplate: /* html */ `\r\n\t\t<div class=\"group--form\" [class]=\"{ required: control.validators.length, disabled: disabled }\" (click)=\"onClick($event)\">\r\n\t\t\t<label [labelFor]=\"uniqueId\"><span [innerHTML]=\"label\"></span> <span class=\"required__sign\">*</span></label>\r\n\t\t\t<input [id]=\"uniqueId\" type=\"text\" class=\"control--text\" [placeholder]=\"label\" [disabled]=\"disabled\" />\r\n\t\t\t<button type=\"button\" class=\"btn--reset\" (click)=\"onReset($event)\" *if=\"control.value\"><svg class=\"close-sm\"><use xlink:href=\"#close-sm\"></use></svg></button>\r\n\t\t\t<!-- <svg class=\"caret-down\"><use xlink:href=\"#caret-down\"></use></svg> -->\r\n\t\t\t<span class=\"required__badge\" [innerHTML]=\"'required' | label\"></span>\r\n\t\t</div>\r\n\t\t<errors-component [control]=\"control\"></errors-component>\r\n\t\t<div class=\"dropdown\" [class]=\"{ dropped: items.length }\" (clickOutside)=\"onClickOutside($event)\">\r\n\t\t\t<div class=\"category\" [innerHTML]=\"label\"></div>\r\n\t\t\t<ul class=\"nav--dropdown\">\r\n\t\t\t\t<li (click)=\"setOption(item)\" [class]=\"{ empty: item.id == null }\" *for=\"let item of items\">\r\n\t\t\t\t\t<span [innerHTML]=\"item.name | label\"></span>\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t</div>\r\n\t`\r\n};\r\n","import { getContext } from 'rxcomp';\r\nimport { from, fromEvent, merge } from 'rxjs';\r\nimport { switchMap, takeUntil, tap } from 'rxjs/operators';\r\nimport { ModalService } from '../common/modal/modal.service';\r\nimport { environment } from '../environment';\r\nimport { ControlComponent } from './control.component';\r\n\r\nexport class ControlCheckboxComponent extends ControlComponent {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tif (this.target === 'modal') {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.link$().pipe(\r\n\t\t\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t\t\t).subscribe();\r\n\t\t\t}, 1);\r\n\t\t}\r\n\t}\r\n\r\n\tlink$() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst anchors = Array.prototype.slice.call(node.querySelectorAll('a'));\r\n\t\t// console.log(anchors, node.innerHTML);\r\n\t\treturn merge(...anchors.map(anchor => fromEvent(anchor, 'click'))).pipe(\r\n\t\t\tswitchMap(event => {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t// console.log('UserDetailComponent.onModalUserUpdate');\r\n\t\t\t\tconst anchor = event.target;\r\n\t\t\t\tconst href = anchor.getAttribute('href');\r\n\t\t\t\t// console.log('ControlCheckboxComponent.link$.href', href);\r\n\t\t\t\treturn from(fetch(href).then(response => response.text()));\r\n\t\t\t}),\r\n\t\t\ttap(html => {\r\n\t\t\t\t// console.log('ControlCheckboxComponent.link$.html', html);\r\n\t\t\t\tconst parser = new DOMParser();\r\n\t\t\t\tconst htmlDocument = parser.parseFromString(html, 'text/html');\r\n\t\t\t\t// console.log('ControlCheckboxComponent.link$.htmlDocument', htmlDocument);\r\n\t\t\t\tlet title = htmlDocument.querySelector('.section--intro-sm .title');\r\n\t\t\t\ttitle = title ? title.innerHTML : null;\r\n\t\t\t\tlet abstract = htmlDocument.querySelector('.section--intro-sm .descritpion');\r\n\t\t\t\tabstract = abstract ? abstract.innerHTML : null;\r\n\t\t\t\tlet description = htmlDocument.querySelector('.section--text .col-md-6');\r\n\t\t\t\tdescription = description ? description.innerHTML : null;\r\n\t\t\t\tModalService.open$({ src: environment.template.modal.genericModal, data: { title: title, abstract: abstract, description: description } }).pipe(\r\n\t\t\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t\t\t).subscribe(event => {\r\n\t\t\t\t\t// console.log('ControlCheckboxComponent.link$.genericModal', event);\r\n\t\t\t\t});\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nControlCheckboxComponent.meta = {\r\n\tselector: '[control-checkbox]',\r\n\tinputs: ['control', 'label', 'target'],\r\n\ttemplate: /* html */ `\r\n\t\t<div class=\"group--form--checkbox\" [class]=\"{ required: control.validators.length }\">\r\n\t\t\t<input [id]=\"uniqueId\" type=\"checkbox\" class=\"control--checkbox\" [formControl]=\"control\" [value]=\"true\" />\r\n\t\t\t<label [labelFor]=\"uniqueId\">\r\n\t\t\t\t<svg class=\"icon icon--checkbox\"><use xlink:href=\"#checkbox\"></use></svg>\r\n\t\t\t\t<svg class=\"icon icon--checkbox-checked\"><use xlink:href=\"#checkbox-checked\"></use></svg>\r\n\t\t\t\t<span [innerHTML]=\"label | html\"></span>\r\n\t\t\t\t<span class=\"required__sign\">*</span>\r\n\t\t\t</label>\r\n\t\t\t<span class=\"required__badge\" [innerHTML]=\"'required' | label\"></span>\r\n\t\t</div>\r\n\t\t<errors-component [control]=\"control\"></errors-component>\r\n\t`\r\n};\r\n","import { fromEvent, merge } from 'rxjs';\r\nimport { filter, map, shareReplay, startWith } from 'rxjs/operators';\r\n\r\nexport class KeyboardService {\r\n\r\n\tstatic keys = {};\r\n\r\n\tstatic keydown$() {\r\n\t\tif (!this.keydown$_) {\r\n\t\t\tthis.keydown$_ = fromEvent(window, 'keydown').pipe(\r\n\t\t\t\tshareReplay(1),\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn this.keydown$_;\r\n\t}\r\n\r\n\tstatic keyup$() {\r\n\t\tif (!this.keyup$_) {\r\n\t\t\tthis.keyup$_ = fromEvent(window, 'keyup').pipe(\r\n\t\t\t\tshareReplay(1),\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn this.keyup$_;\r\n\t}\r\n\r\n\tstatic keys$() {\r\n\t\tif (!this.keys$_) {\r\n\t\t\tthis.keys$_ = merge(this.keydown$(), this.keyup$()).pipe(\r\n\t\t\t\tmap(event => {\r\n\t\t\t\t\tconst keys = this.keys;\r\n\t\t\t\t\tif (event.type === 'keydown') {\r\n\t\t\t\t\t\tkeys[event.key] = true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdelete keys[event.key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn this.keys;\r\n\t\t\t\t}),\r\n\t\t\t\tstartWith(this.keys),\r\n\t\t\t\tshareReplay(1),\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn this.keys$_;\r\n\t}\r\n\r\n\tstatic key$() {\r\n\t\tif (!this.key$_) {\r\n\t\t\tconst regexp = /\\w/;\r\n\t\t\tthis.key$_ = this.keydown$().pipe(\r\n\t\t\t\tfilter(event => event.key && event.key.match(regexp)),\r\n\t\t\t\tmap(event => event.key),\r\n\t\t\t\tshareReplay(1),\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn this.key$_;\r\n\t}\r\n\r\n\tstatic typing$() {\r\n\t\tif (!this.typing$_) {\r\n\t\t\tlet typing = '',\r\n\t\t\t\tto;\r\n\t\t\tthis.typing$_ = this.key$().pipe(\r\n\t\t\t\tmap(key => {\r\n\t\t\t\t\tif (to) {\r\n\t\t\t\t\t\tclearTimeout(to);\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttyping += key;\r\n\t\t\t\t\tto = setTimeout(() => {\r\n\t\t\t\t\t\ttyping = '';\r\n\t\t\t\t\t}, 1500);\r\n\t\t\t\t\treturn typing;\r\n\t\t\t\t}),\r\n\t\t\t\tshareReplay(1),\r\n\t\t\t)\r\n\t\t}\r\n\t\treturn this.typing$_;\r\n\t}\r\n\r\n}\r\n","import { getContext } from 'rxcomp';\r\nimport { takeUntil } from 'rxjs/operators';\r\nimport { DropdownDirective } from '../common/dropdown/dropdown.directive';\r\nimport { KeyboardService } from '../common/keyboard/keyboard.service';\r\nimport { ControlComponent } from './control.component';\r\n\r\nexport class ControlCustomSelectComponent extends ControlComponent {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tthis.dropped = false;\r\n\t\tthis.dropdownId = DropdownDirective.nextId();\r\n\t\tKeyboardService.typing$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(word => {\r\n\t\t\tthis.scrollToWord(word);\r\n\t\t});\r\n\t\t/*\r\n\t\tKeyboardService.key$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(key => {\r\n\t\t\tthis.scrollToKey(key);\r\n\t\t});\r\n\t\t*/\r\n\t}\r\n\r\n\t/*\r\n\tonChanges() {\r\n\t\t// console.log('ControlCustomSelectComponent.onChanges');\r\n\t}\r\n\t*/\r\n\r\n\tscrollToWord(word) {\r\n\t\t// console.log('ControlCustomSelectComponent.scrollToWord', word);\r\n\t\tconst items = this.control.options || [];\r\n\t\tlet index = -1;\r\n\t\tfor (let i = 0; i < items.length; i++) {\r\n\t\t\tconst x = items[i];\r\n\t\t\tif (x.name.toLowerCase().indexOf(word.toLowerCase()) === 0) {\r\n\t\t\t\t// console.log(word, x.name);\r\n\t\t\t\tindex = i;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (index !== -1) {\r\n\t\t\tconst { node } = getContext(this);\r\n\t\t\tconst dropdown = node.querySelector('.dropdown');\r\n\t\t\tconst navDropdown = node.querySelector('.nav--dropdown');\r\n\t\t\tconst item = navDropdown.children[index];\r\n\t\t\tdropdown.scrollTo(0, item.offsetTop);\r\n\t\t}\r\n\t}\r\n\r\n\tsetOption(item) {\r\n\t\tconsole.log('setOption', item, this.isMultiple);\r\n\t\tlet value;\r\n\t\tif (this.isMultiple) {\r\n\t\t\tconst value = this.control.value || [];\r\n\t\t\tconst index = value.indexOf(item.id);\r\n\t\t\tif (index !== -1) {\r\n\t\t\t\t// if (value.length > 1) {\r\n\t\t\t\tvalue.splice(index, 1);\r\n\t\t\t\t// }\r\n\t\t\t} else {\r\n\t\t\t\tvalue.push(item.id);\r\n\t\t\t}\r\n\t\t\tvalue = value.length ? value.slice() : null;\r\n\t\t} else {\r\n\t\t\tvalue = item.id;\r\n\t\t\t// DropdownDirective.dropdown$.next(null);\r\n\t\t}\r\n\t\tthis.control.value = value;\r\n\t\tthis.change.next(value);\r\n\t}\r\n\r\n\thasOption(item) {\r\n\t\tif (this.isMultiple) {\r\n\t\t\tconst values = this.control.value || [];\r\n\t\t\treturn values.indexOf(item.id) !== -1;\r\n\t\t} else {\r\n\t\t\treturn this.control.value === item.id;\r\n\t\t}\r\n\t}\r\n\r\n\tgetLabel() {\r\n\t\tlet value = this.control.value;\r\n\t\tconst items = this.control.options || [];\r\n\t\tif (this.isMultiple) {\r\n\t\t\tvalue = value || [];\r\n\t\t\tif (value.length) {\r\n\t\t\t\treturn value.map(v => {\r\n\t\t\t\t\tconst item = items.find(x => x.id === v || x.name === v);\r\n\t\t\t\t\treturn item ? item.name : '';\r\n\t\t\t\t}).join(', ');\r\n\t\t\t} else {\r\n\t\t\t\treturn this.select || 'select'; // LabelPipe.transform('select');\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconst item = value ? items.find(x => x.id === value || x.name === value) : null;\r\n\t\t\tif (item) {\r\n\t\t\t\treturn item.name;\r\n\t\t\t} else {\r\n\t\t\t\treturn this.select || 'select'; // LabelPipe.transform('select');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tonDropped($event) {\r\n\t\t// console.log('ControlCustomSelectComponent.onDropped', id);\r\n\t\tif (this.dropped && $event === null) {\r\n\t\t\tthis.control.touched = true;\r\n\t\t}\r\n\t\tthis.dropped = $event === this.dropdownId;\r\n\t}\r\n\r\n\tget isMultiple() {\r\n\t\treturn this.multiple && this.multiple !== false && this.multiple !== 'false';\r\n\t}\r\n\r\n}\r\n\r\nControlCustomSelectComponent.meta = {\r\n\tselector: '[control-custom-select]',\r\n\toutputs: ['change'],\r\n\tinputs: ['control', 'label', 'multiple', 'select'],\r\n\ttemplate: /* html */ `\r\n\t\t<div class=\"group--form--select\" [class]=\"{ required: control.validators.length, multiple: isMultiple }\" [dropdown]=\"dropdownId\" (dropped)=\"onDropped($event)\">\r\n\t\t\t<label><span [innerHTML]=\"label\"></span> <span class=\"required__sign\">*</span></label>\r\n\t\t\t<span class=\"control--custom-select\" [innerHTML]=\"getLabel() | label\"></span>\r\n\t\t\t<svg class=\"caret-down\"><use xlink:href=\"#caret-down\"></use></svg>\r\n\t\t\t<span class=\"required__badge\" [innerHTML]=\"'required' | label\"></span>\r\n\t\t</div>\r\n\t\t<errors-component [control]=\"control\"></errors-component>\r\n\t\t<div class=\"dropdown\" [dropdown-item]=\"dropdownId\">\r\n\t\t\t<div class=\"category\" [innerHTML]=\"label\"></div>\r\n\t\t\t<ul class=\"nav--dropdown\" [class]=\"{ multiple: isMultiple }\">\r\n\t\t\t\t<li (click)=\"setOption(item)\" [class]=\"{ empty: item.id == null }\" *for=\"let item of control.options\">\r\n\t\t\t\t\t<span [class]=\"{ active: hasOption(item) }\" [innerHTML]=\"item.name | label\"></span>\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t</div>\r\n\t`\r\n};\r\n","import { ControlComponent } from './control.component';\r\n\r\nexport class ControlEmailComponent extends ControlComponent {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t}\r\n\r\n}\r\n\r\nControlEmailComponent.meta = {\r\n\tselector: '[control-email]',\r\n\tinputs: ['control', 'label'],\r\n\ttemplate: /* html */ `\r\n\t\t<div class=\"group--form\" [class]=\"{ required: control.validators.length }\">\r\n\t\t\t<label [labelFor]=\"uniqueId\"><span [innerHTML]=\"label\"></span> <span class=\"required__sign\">*</span></label>\r\n\t\t\t<input [id]=\"uniqueId\" type=\"text\" class=\"control--text\" [formControl]=\"control\" [placeholder]=\"label\" required email />\r\n\t\t\t<span class=\"required__badge\" [innerHTML]=\"'required' | label\"></span>\r\n\t\t</div>\r\n\t\t<errors-component [control]=\"control\"></errors-component>\r\n\t`\r\n};\r\n","import { ControlComponent } from './control.component';\r\n\r\nexport class ControlFileComponent extends ControlComponent {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tthis.labels = window.labels || {};\r\n\t\tthis.file = null;\r\n\t\tthis.onReaderComplete = this.onReaderComplete.bind(this);\r\n\t}\r\n\r\n\tonInputDidChange(event) {\r\n\t\tconst input = event.target;\r\n\t\tconst file = input.files[0];\r\n\t\tthis.file = {\r\n\t\t\tname: file.name,\r\n\t\t\tlastModified: file.lastModified,\r\n\t\t\tlastModifiedDate: file.lastModifiedDate,\r\n\t\t\tsize: file.size,\r\n\t\t\ttype: file.type,\r\n\t\t}\r\n\t\tconst reader = new FileReader();\r\n\t\treader.addEventListener('load', this.onReaderComplete);\r\n\t\treader.readAsDataURL(file);\r\n\t\t// reader.readAsArrayBuffer() // Starts reading the contents of the specified Blob, once finished, the result attribute contains an ArrayBuffer representing the file's data.\r\n\t\t// reader.readAsBinaryString() // Starts reading the contents of the specified Blob, once finished, the result attribute contains the raw binary data from the file as a string.\r\n\t\t// reader.readAsDataURL() // Starts reading the contents of the specified Blob, once finished, the result attribute contains a data: URL representing the file's data.\r\n\t\t// reader.readAsText() // Starts reading the contents of the specified Blob, once finished, the result attribute contains the contents of the file as a text string. An optional encoding name can be specified.\r\n\t}\r\n\r\n\tonReaderComplete(event) {\r\n\t\tconst content = event.target.result;\r\n\t\tthis.file.content = content;\r\n\t\tthis.control.value = this.file;\r\n\t\t// console.log('ControlFileComponent.onReaderComplete', this.file);\r\n\t\t// image/*,\r\n\t}\r\n\r\n}\r\n\r\nControlFileComponent.meta = {\r\n\tselector: '[control-file]',\r\n\tinputs: ['control', 'label'],\r\n\ttemplate: /* html */ `\r\n\t\t<div class=\"group--form--file\" [class]=\"{ required: control.validators.length }\">\r\n\t\t\t<label for=\"file\"><span [innerHTML]=\"label\"></span> <span class=\"required__sign\">*</span></label>\r\n\t\t\t<span class=\"control--text\" [innerHTML]=\"file?.name || labels.select_file\"></span>\r\n\t\t\t<svg class=\"upload\"><use xlink:href=\"#upload\"></use></svg>\r\n\t\t\t<span class=\"required__badge\" [innerHTML]=\"'required' | label\"></span>\r\n\t\t\t<input name=\"file\" type=\"file\" accept=\".pdf,.doc,.docx,*.txt\" class=\"control--file\" (change)=\"onInputDidChange($event)\" />\r\n\t\t</div>\r\n\t\t<errors-component [control]=\"control\"></errors-component>\r\n\t`\r\n};\r\n","import { getContext } from 'rxcomp';\r\nimport { ControlComponent } from './control.component';\r\n\r\nexport class ControlPasswordComponent extends ControlComponent {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tconst { node } = getContext(this);\r\n\t\tif (node.hasAttribute('secure')) {\r\n\t\t\t// const name = [...\"abcdefghijklmnopqrsuvwxyz0123456789\"].map((c, i, a) => a[Math.floor(Math.random() * a.length)]).join('');\r\n\t\t\tconst input = node.querySelector('input');\r\n\t\t\tinput.setAttribute('autocomplete', 'new-password');\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nControlPasswordComponent.meta = {\r\n\tselector: '[control-password]',\r\n\tinputs: ['control', 'label'],\r\n\ttemplate: /* html */ `\r\n\t\t<div class=\"group--form\" [class]=\"{ required: control.validators.length }\">\r\n\t\t\t<label [labelFor]=\"uniqueId\"><span [innerHTML]=\"label\"></span> <span class=\"required__sign\">*</span></label>\r\n\t\t\t<input [id]=\"uniqueId\" type=\"password\" class=\"control--text\" [formControl]=\"control\" [placeholder]=\"label\" />\r\n\t\t\t<span class=\"required__badge\" [innerHTML]=\"'required' | label\"></span>\r\n\t\t</div>\r\n\t\t<errors-component [control]=\"control\"></errors-component>\r\n\t`\r\n};\r\n","import { getContext } from 'rxcomp';\r\nimport { from, fromEvent, merge } from 'rxjs';\r\nimport { switchMap, takeUntil, tap } from 'rxjs/operators';\r\nimport { ModalService } from '../common/modal/modal.service';\r\nimport { environment } from '../environment';\r\nimport { ControlComponent } from './control.component';\r\n\r\nexport class ControlPrivacyComponent extends ControlComponent {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tif (this.target === 'modal') {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.link$().pipe(\r\n\t\t\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t\t\t).subscribe();\r\n\t\t\t}, 1);\r\n\t\t}\r\n\t}\r\n\r\n\tonChanges() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst inputs = Array.prototype.slice.call(node.querySelectorAll('input'));\r\n\t\tinputs.forEach((input, i) => {\r\n\t\t\t(this.control.value === true && i === 0) || (this.control.value === false && i === 1) ? input.setAttribute('checked', '') : input.removeAttribute('checked');\r\n\t\t});\r\n\t}\r\n\r\n\tonSelect(value) {\r\n\t\tthis.control.value = value;\r\n\t}\r\n\r\n\tlink$() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst anchors = Array.prototype.slice.call(node.querySelectorAll('a'));\r\n\t\t// console.log(anchors, node.innerHTML);\r\n\t\treturn merge(...anchors.map(anchor => fromEvent(anchor, 'click'))).pipe(\r\n\t\t\tswitchMap(event => {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t// console.log('UserDetailComponent.onModalUserUpdate');\r\n\t\t\t\tconst anchor = event.target;\r\n\t\t\t\tconst href = anchor.getAttribute('href');\r\n\t\t\t\t// console.log('ControlPrivacyComponent.link$.href', href);\r\n\t\t\t\treturn from(fetch(href).then(response => response.text()));\r\n\t\t\t}),\r\n\t\t\ttap(html => {\r\n\t\t\t\t// console.log('ControlPrivacyComponent.link$.html', html);\r\n\t\t\t\tconst parser = new DOMParser();\r\n\t\t\t\tconst htmlDocument = parser.parseFromString(html, 'text/html');\r\n\t\t\t\t// console.log('ControlPrivacyComponent.link$.htmlDocument', htmlDocument);\r\n\t\t\t\tlet title = htmlDocument.querySelector('.section--intro-sm .title');\r\n\t\t\t\ttitle = title ? title.innerHTML : null;\r\n\t\t\t\tlet abstract = htmlDocument.querySelector('.section--intro-sm .descritpion');\r\n\t\t\t\tabstract = abstract ? abstract.innerHTML : null;\r\n\t\t\t\tlet description = htmlDocument.querySelector('.section--text .col-md-6');\r\n\t\t\t\tdescription = description ? description.innerHTML : null;\r\n\t\t\t\tModalService.open$({ src: environment.template.modal.genericModal, data: { title: title, abstract: abstract, description: description } }).pipe(\r\n\t\t\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t\t\t).subscribe(event => {\r\n\t\t\t\t\t// console.log('ControlPrivacyComponent.link$.genericModal', event);\r\n\t\t\t\t});\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nControlPrivacyComponent.meta = {\r\n\tselector: '[control-privacy]',\r\n\tinputs: ['control', 'label', 'target'],\r\n\ttemplate: /* html */ `\r\n\t\t<div class=\"group--form--privacy\" [class]=\"{ required: control.validators.length }\">\r\n\t\t\t<div class=\"group--inputs\">\r\n\t\t\t\t<input type=\"radio\" class=\"control--checkbox\" [id]=\"uniqueId + '_true'\" [name]=\"uniqueId\" [value]=\"true\" (change)=\"onSelect(true)\" />\r\n\t\t\t\t<label [labelFor]=\"uniqueId + '_true'\">\r\n\t\t\t\t\t<svg class=\"icon icon--checkbox\"><use xlink:href=\"#checkbox\"></use></svg>\r\n\t\t\t\t\t<svg class=\"icon icon--checkbox-checked\"><use xlink:href=\"#checkbox-checked\"></use></svg>\r\n\t\t\t\t\t<span [innerHTML]=\"labels.acconsento\"></span>\r\n\t\t\t\t</label>\r\n\t\t\t\t<input type=\"radio\" class=\"control--checkbox\" [id]=\"uniqueId + '_false'\" [name]=\"uniqueId\" [value]=\"false\" (change)=\"onSelect(false)\" />\r\n\t\t\t\t<label [labelFor]=\"uniqueId + '_false'\">\r\n\t\t\t\t\t<svg class=\"icon icon--checkbox\"><use xlink:href=\"#checkbox\"></use></svg>\r\n\t\t\t\t\t<svg class=\"icon icon--checkbox-checked\"><use xlink:href=\"#checkbox-checked\"></use></svg>\r\n\t\t\t\t\t<span [innerHTML]=\"labels.non_acconsento\"></span>\r\n\t\t\t\t</label>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"description\">\r\n\t\t\t\t<span [innerHTML]=\"label | html\"></span>\r\n\t\t\t\t<span class=\"required__sign\">*</span>\r\n\t\t\t</div>\r\n\t\t\t<span class=\"required__badge\" [innerHTML]=\"'required' | label\"></span>\r\n\t\t</div>\r\n\t\t<errors-component [control]=\"control\"></errors-component>\r\n\t`\r\n};\r\n","import { getContext } from 'rxcomp';\r\nimport { ControlComponent } from './control.component';\r\n\r\nexport class ControlSearchComponent extends ControlComponent {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tthis.disabled = this.disabled || false;\r\n\t}\r\n\r\n\tonFocus(event) {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst input = node.querySelector('.control--text');\r\n\t\tif (input) {\r\n\t\t\tinput.setSelectionRange(0, 1000);\r\n\t\t\tinput.focus();\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nControlSearchComponent.meta = {\r\n\tselector: '[control-search]',\r\n\tinputs: ['control', 'label', 'disabled'],\r\n\ttemplate: /* html */ `\r\n\t\t<div class=\"group--form\" [class]=\"{ required: control.validators.length, disabled: disabled }\">\r\n\t\t\t<svg class=\"search\" (click)=\"onFocus($event)\"><use xlink:href=\"#search\"></use></svg>\r\n\t\t\t<input type=\"text\" class=\"control--text\" [formControl]=\"control\" [placeholder]=\"label\" [disabled]=\"disabled\" />\r\n\t\t</div>\r\n\t`\r\n};\r\n","import { ControlComponent } from './control.component';\r\n\r\nexport class ControlTextComponent extends ControlComponent {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tthis.disabled = this.disabled || false;\r\n\t}\r\n\r\n}\r\n\r\nControlTextComponent.meta = {\r\n\tselector: '[control-text]',\r\n\tinputs: ['control', 'label', 'disabled'],\r\n\ttemplate: /* html */ `\r\n\t\t<div class=\"group--form\" [class]=\"{ required: control.validators.length, disabled: disabled }\">\r\n\t\t\t<label [labelFor]=\"uniqueId\"><span [innerHTML]=\"label\"></span> <span class=\"required__sign\">*</span></label>\r\n\t\t\t<span class=\"required__badge\" [innerHTML]=\"'required' | label\"></span>\r\n\t\t\t<input [id]=\"uniqueId\" type=\"text\" class=\"control--text\" [formControl]=\"control\" [placeholder]=\"label\" [disabled]=\"disabled\" />\r\n\t\t</div>\r\n\t\t<errors-component [control]=\"control\"></errors-component>\r\n\t`\r\n};\r\n","import { ControlComponent } from './control.component';\r\n\r\nexport class ControlTextareaComponent extends ControlComponent {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tthis.disabled = this.disabled || false;\r\n\t}\r\n\r\n}\r\n\r\nControlTextareaComponent.meta = {\r\n\tselector: '[control-textarea]',\r\n\tinputs: ['control', 'label', 'disabled'],\r\n\ttemplate: /* html */ `\r\n\t\t<div class=\"group--form--textarea\" [class]=\"{ required: control.validators.length, disabled: disabled }\">\r\n\t\t\t<label [labelFor]=\"uniqueId\"><span [innerHTML]=\"label\"></span> <span class=\"required__sign\">*</span></label>\r\n\t\t\t<textarea [id]=\"uniqueId\" class=\"control--text\" [formControl]=\"control\" [placeholder]=\"label\" [innerHTML]=\"label\" rows=\"4\" [disabled]=\"disabled\"></textarea>\r\n\t\t\t<span class=\"required__badge\" [innerHTML]=\"'required' | label\"></span>\r\n\t\t</div>\r\n\t\t<errors-component [control]=\"control\"></errors-component>\r\n\t`\r\n};\r\n","import { LabelPipe } from '../common/label/label.pipe';\r\nimport { ControlComponent } from './control.component';\r\n\r\nexport class ErrorsComponent extends ControlComponent {\r\n\r\n\tgetLabel(key, value) {\r\n\t\tconst label = LabelPipe.transform(`error_${key}`);\r\n\t\treturn label;\r\n\t}\r\n\r\n}\r\n\r\nErrorsComponent.meta = {\r\n\tselector: 'errors-component',\r\n\tinputs: ['control'],\r\n\ttemplate: /* html */ `\r\n\t<div class=\"inner\" [style]=\"{ display: control.invalid && control.touched ? 'block' : 'none' }\">\r\n\t\t<div class=\"error\" *for=\"let [key, value] of control.errors\">\r\n\t\t\t<span [innerHTML]=\"getLabel(key, value)\"></span>\r\n\t\t\t<!-- <span class=\"key\" [innerHTML]=\"key\"></span> <span class=\"value\" [innerHTML]=\"value | json\"></span> -->\r\n\t\t</div>\r\n\t</div>\r\n\t`\r\n};\r\n","import { Component } from 'rxcomp';\r\n\r\nexport class TestComponent extends Component {\r\n\r\n\tonTest(event) {\r\n\t\tthis.test.next(event);\r\n\t}\r\n\r\n\tonReset(event) {\r\n\t\tthis.reset.next(event);\r\n\t}\r\n\r\n}\r\n\r\nTestComponent.meta = {\r\n\tselector: 'test-component',\r\n\tinputs: ['form'],\r\n\toutputs: ['test', 'reset'],\r\n\ttemplate: /* html */ `\r\n\t<div class=\"test-component\" *if=\"!('production' | flag)\">\r\n\t\t<div class=\"test-component__title\">development mode</div>\r\n\t\t<code [innerHTML]=\"form.value | json\"></code>\r\n\t\t<button type=\"button\" class=\"btn--submit\" (click)=\"onTest($event)\"><span>test</span></button>\r\n\t\t<button type=\"button\" class=\"btn--submit\" (click)=\"onReset($event)\"><span>reset</span></button>\r\n\t</div>\r\n\t`\r\n};\r\n","import { Module } from 'rxcomp';\r\nimport { ControlAutocompleteComponent } from './control-autocomplete.component';\r\nimport { ControlCheckboxComponent } from './control-checkbox.component';\r\nimport { ControlCustomSelectComponent } from './control-custom-select.component';\r\nimport { ControlEmailComponent } from './control-email.component';\r\nimport { ControlFileComponent } from './control-file.component';\r\nimport { ControlPasswordComponent } from './control-password.component';\r\nimport { ControlPrivacyComponent } from './control-privacy.component';\r\nimport { ControlSearchComponent } from './control-search.component';\r\nimport { ControlTextComponent } from './control-text.component';\r\nimport { ControlTextareaComponent } from './control-textarea.component';\r\nimport { ErrorsComponent } from './errors.component';\r\nimport { TestComponent } from './test.component';\r\n\r\nconst factories = [\r\n\tControlAutocompleteComponent,\r\n\tControlCheckboxComponent,\r\n\tControlCustomSelectComponent,\r\n\tControlEmailComponent,\r\n\tControlFileComponent,\r\n\tControlPasswordComponent,\r\n\tControlPrivacyComponent,\r\n\t// ControlSelectComponent,\r\n\tControlSearchComponent,\r\n\tControlTextareaComponent,\r\n\tControlTextComponent,\r\n\t// DisabledDirective,\r\n\tErrorsComponent,\r\n\tTestComponent,\r\n\t// ValueDirective,\r\n];\r\n\r\nconst pipes = [\r\n];\r\n\r\nexport class ControlsModule extends Module { }\r\n\r\nControlsModule.meta = {\r\n\timports: [\r\n\t],\r\n\tdeclarations: [\r\n\t\t...factories,\r\n\t\t...pipes,\r\n\t],\r\n\texports: [\r\n\t\t...factories,\r\n\t\t...pipes,\r\n\t],\r\n};\r\n","import { BehaviorSubject } from 'rxjs';\r\n\r\nexport const FilterMode = {\r\n\tSELECT: 'select',\r\n\tAND: 'and',\r\n\tOR: 'or',\r\n\tQUERY: 'query',\r\n};\r\n\r\nexport class FilterItem {\r\n\r\n\tconstructor(filter) {\r\n\t\tthis.change$ = new BehaviorSubject();\r\n\t\tthis.mode = FilterMode.SELECT;\r\n\t\tthis.filter = 'Filter';\r\n\t\tthis.placeholder = null;\r\n\t\tthis.values = [];\r\n\t\tthis.options = [];\r\n\t\tif (filter) {\r\n\t\t\tObject.assign(this, filter);\r\n\t\t}\r\n\t\tif (filter.mode === FilterMode.SELECT) {\r\n\t\t\tfilter.options.unshift({\r\n\t\t\t\tlabel: 'select',\r\n\t\t\t\tvalue: undefined,\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfilter(item, value) {\r\n\t\treturn item.options.indexOf(value) !== -1;\r\n\t}\r\n\r\n\tmatch(item) {\r\n\t\tlet match;\r\n\t\tif (this.mode === FilterMode.OR) {\r\n\t\t\tmatch = this.values.length ? false : true;\r\n\t\t\tthis.values.forEach(value => {\r\n\t\t\t\tmatch = match || this.filter(item, value);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tmatch = true;\r\n\t\t\tthis.values.forEach(value => {\r\n\t\t\t\tmatch = match && this.filter(item, value);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn match;\r\n\t}\r\n\r\n\tgetLabel() {\r\n\t\tif (this.hasAny()) {\r\n\t\t\treturn this.options.filter(x => x.value && this.values.indexOf(x.value) !== -1).map(x => x.label).join(', ');\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\t/*\r\n\t\tif (this.mode === FilterMode.QUERY) {\r\n\t\t\treturn this.label;\r\n\t\t\t// return this.placeholder || this.label;\r\n\t\t} else if (this.mode === FilterMode.SELECT) {\r\n\t\t\tif (this.hasAny()) {\r\n\t\t\t\treturn this.options.filter(x => x.value && this.values.indexOf(x.value) !== -1).map(x => x.label).join(', ');\r\n\t\t\t} else {\r\n\t\t\t\treturn this.label;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn this.label;\r\n\t\t}\r\n\t\t*/\r\n\t}\r\n\r\n\thasAny() {\r\n\t\treturn this.values.length > 0;\r\n\t}\r\n\r\n\thas(item) {\r\n\t\treturn this.values.indexOf(item.value) !== -1;\r\n\t}\r\n\r\n\tset(item) {\r\n\t\tif (this.mode === FilterMode.QUERY) {\r\n\t\t\tthis.values = item ? [item] : [];\r\n\t\t\t// this.placeholder = item;\r\n\t\t} else {\r\n\t\t\tif (this.mode === FilterMode.SELECT) {\r\n\t\t\t\tthis.values = [];\r\n\t\t\t}\r\n\t\t\tconst index = this.values.indexOf(item.value);\r\n\t\t\tif (index === -1) {\r\n\t\t\t\tif (item.value != null) {\r\n\t\t\t\t\tthis.values.push(item.value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t/*\r\n\t\t\tif (this.mode === FilterMode.SELECT) {\r\n\t\t\t\tthis.placeholder = item.label;\r\n\t\t\t}\r\n\t\t\t*/\r\n\t\t}\r\n\t\t// console.log('FilterItem.set', item);\r\n\t\tthis.change$.next();\r\n\t}\r\n\r\n\tremove(item) {\r\n\t\tconst index = this.values.indexOf(item.value);\r\n\t\tif (index !== -1) {\r\n\t\t\tthis.values.splice(index, 1);\r\n\t\t}\r\n\t\t/*\r\n\t\tif (this.mode === FilterMode.SELECT) {\r\n\t\t\tconst first = this.options[0];\r\n\t\t\tthis.placeholder = first.label;\r\n\t\t}\r\n\t\t*/\r\n\t\t// console.log('FilterItem.remove', item);\r\n\t\tthis.change$.next();\r\n\t}\r\n\r\n\ttoggle(item) {\r\n\t\tif (this.has(item)) {\r\n\t\t\tthis.remove(item);\r\n\t\t} else {\r\n\t\t\tthis.set(item);\r\n\t\t}\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.values = [];\r\n\t\t/*\r\n\t\tif (this.mode === FilterMode.SELECT) {\r\n\t\t\tconst first = this.options[0];\r\n\t\t\tthis.placeholder = first.label;\r\n\t\t}\r\n\t\t*/\r\n\t\tthis.change$.next();\r\n\t}\r\n}\r\n","import { merge, of, Subject } from 'rxjs';\r\nimport { map, tap } from 'rxjs/operators';\r\nimport { LocationService } from '../location/location.service';\r\nimport { FilterItem } from './filter-item';\r\n\r\nexport class FilterService {\r\n\r\n\tconstructor(options, initialParams, callback) {\r\n\t\tconst filters = {};\r\n\t\tif (options) {\r\n\t\t\tObject.keys(options).forEach(key => {\r\n\t\t\t\tconst filter = new FilterItem(options[key]);\r\n\t\t\t\tif (typeof callback === 'function') {\r\n\t\t\t\t\tcallback(key, filter);\r\n\t\t\t\t}\r\n\t\t\t\tfilters[key] = filter;\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.filter$ = new Subject();\r\n\t\tthis.filters = filters;\r\n\t\tthis.deserialize(this.filters, initialParams);\r\n\t}\r\n\r\n\tgetParamsCount(params) {\r\n\t\tif (params) {\r\n\t\t\tconst paramsCount = Object.keys(params).reduce((p, c, i) => {\r\n\t\t\t\tconst values = params[c];\r\n\t\t\t\treturn p + (values ? values.length : 0);\r\n\t\t\t}, 0);\r\n\t\t\treturn paramsCount;\r\n\t\t} else {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t}\r\n\r\n\tdeserialize(filters, initialParams) {\r\n\t\tlet params;\r\n\t\tif (initialParams && this.getParamsCount(initialParams)) {\r\n\t\t\tparams = initialParams;\r\n\t\t}\r\n\t\tconst locationParams = LocationService.deserialize('filters');\r\n\t\tif (locationParams && this.getParamsCount(locationParams)) {\r\n\t\t\tparams = locationParams;\r\n\t\t}\r\n\t\tif (params) {\r\n\t\t\tObject.keys(filters).forEach(key => {\r\n\t\t\t\tfilters[key].values = params[key] || [];\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn filters;\r\n\t}\r\n\r\n\tserialize(filters) {\r\n\t\tlet params = {};\r\n\t\tlet any = false;\r\n\t\tObject.keys(filters).forEach(x => {\r\n\t\t\tconst filter = filters[x];\r\n\t\t\tif (filter.value !== null) {\r\n\t\t\t\tparams[x] = filter.values;\r\n\t\t\t\tany = true;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (!any) {\r\n\t\t\tparams = null;\r\n\t\t}\r\n\t\t// console.log('ReferenceCtrl.serialize', params);\r\n\t\tLocationService.serialize('filters', params);\r\n\t\treturn params;\r\n\t}\r\n\r\n\titems$(items) {\r\n\t\tconst filters = this.filters;\r\n\t\tconst changes = Object.keys(filters).map(key => filters[key].change$);\r\n\t\tif (changes.length === 0) {\r\n\t\t\treturn of(this.filterItems(items));\r\n\t\t}\r\n\t\treturn merge(...changes, this.filter$).pipe(\r\n\t\t\t// tap(() => console.log(filters)),\r\n\t\t\ttap(() => this.serialize(filters)),\r\n\t\t\tmap(() => this.filterItems(items)),\r\n\t\t\ttap(() => this.updateFilterStates(filters, items))\r\n\t\t);\r\n\t}\r\n\r\n\tfilterItems(items, skipFilter) {\r\n\t\tconst filters = Object.keys(this.filters).map((x) => this.filters[x]).filter(x => x.value !== null);\r\n\t\titems = items.filter(item => {\r\n\t\t\tlet has = true;\r\n\t\t\tfilters.forEach(filter => {\r\n\t\t\t\tif (filter !== skipFilter) {\r\n\t\t\t\t\thas = has && filter.match(item);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn has;\r\n\t\t});\r\n\t\treturn items;\r\n\t}\r\n\r\n\tupdateFilterStates(filters, items) {\r\n\t\tObject.keys(filters).forEach(x => {\r\n\t\t\tconst filter = filters[x];\r\n\t\t\tconst filteredItems = this.filterItems(items, filter);\r\n\t\t\tfilter.options.forEach(option => {\r\n\t\t\t\tlet count = 0;\r\n\t\t\t\tif (option.value) {\r\n\t\t\t\t\tlet i = 0;\r\n\t\t\t\t\twhile (i < filteredItems.length) {\r\n\t\t\t\t\t\tconst item = filteredItems[i];\r\n\t\t\t\t\t\tif (filter.filter(item, option.value)) {\r\n\t\t\t\t\t\t\tcount++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcount = filteredItems.length;\r\n\t\t\t\t}\r\n\t\t\t\toption.count = count;\r\n\t\t\t\toption.disabled = count === 0;\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\treset() {\r\n\t\tlet filter;\r\n\t\tObject.keys(this.filters).forEach(x => {\r\n\t\t\tfilter = this.filters[x];\r\n\t\t\tfilter.values = [];\r\n\t\t});\r\n\t\tif (filter) {\r\n\t\t\tfilter.change$.next();\r\n\t\t}\r\n\t}\r\n}\r\n","import { Component } from 'rxcomp';\r\nimport { FormControl, FormGroup } from 'rxcomp-form';\r\nimport { combineLatest } from 'rxjs';\r\nimport { finalize, first, takeUntil } from 'rxjs/operators';\r\nimport { FilterMode } from '../../common/filter/filter-item';\r\nimport { FilterService } from '../../common/filter/filter.service';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\n\r\nexport const PAGE_SIZE = 24;\r\n\r\nexport class FiltersComponent extends Component {\r\n\r\n\tload$() {\r\n\t\treturn combineLatest([\r\n\t\t\tof([]),\r\n\t\t\tof({ search: { mode: 'query' } }),\r\n\t\t]);\r\n\t}\r\n\r\n\tsetFiltersParams() {\r\n\t\t// nope;\r\n\t}\r\n\r\n\tdoFilterItem(key, item, value) {\r\n\t\tswitch (key) {\r\n\t\t\tcase 'search':\r\n\t\t\t\treturn item.name.toLowerCase().indexOf(value.toLowerCase()) !== -1 ||\r\n\t\t\t\t\t// item.address.toLowerCase().indexOf(value.toLowerCase()) !== -1 ||\r\n\t\t\t\t\t(item.city && item.city.toLowerCase().indexOf(value.toLowerCase()) !== -1) ||\r\n\t\t\t\t\t(item.countries && item.countries.find(x => x.label.toLowerCase().indexOf(value.toLowerCase()) !== -1))\r\n\t\t\tdefault:\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tonInit() {\r\n\t\tthis.pageSize = PAGE_SIZE;\r\n\t\tthis.items = [];\r\n\t\tthis.filteredItems = [];\r\n\t\tthis.visibleItems = [];\r\n\t\tthis.filters = {};\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\tsearch: new FormControl(null),\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tform.changes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe((_) => {\r\n\t\t\t// console.log('FiltersComponent.onInit.form.changes$', form.value.search);\r\n\t\t\tthis.setFilterByKeyAndValue('search', form.value.search);\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t\tthis.busy = true;\r\n\t\tthis.load$().pipe(\r\n\t\t\tfirst(),\r\n\t\t\tfinalize(_ => {\r\n\t\t\t\tthis.busy = false;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t}),\r\n\t\t).subscribe(data => {\r\n\t\t\tthis.items = data[0];\r\n\t\t\tthis.filters = data[1];\r\n\t\t\tthis.onLoad();\r\n\t\t});\r\n\t}\r\n\r\n\tonLoad() {\r\n\t\tconst items = this.items;\r\n\t\tconst filters = this.filters || {};\r\n\t\tObject.keys(filters).forEach(key => {\r\n\t\t\tfilters[key].mode = filters[key].mode || FilterMode.OR;\r\n\t\t});\r\n\t\tconst initialParams = {};\r\n\t\tconst filterService = new FilterService(filters, initialParams, (key, filter) => {\r\n\t\t\tswitch (key) {\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tfilter.filter = (item, value) => {\r\n\t\t\t\t\t\treturn this.doFilterItem(key, item, value);\r\n\t\t\t\t\t};\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.filterService = filterService;\r\n\t\tthis.filters = filterService.filters;\r\n\t\tthis.setFiltersParams();\r\n\t\tconst search = (this.filters.search && this.filters.search.values.length) ? this.filters.search.values[0] : null;\r\n\t\tthis.form.patch({ search });\r\n\t\tfilterService.items$(items).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe(filteredItems => {\r\n\t\t\tthis.filteredItems = this.doSortItems(filteredItems);\r\n\t\t\tthis.visibleItems = this.getVisibleItems();\r\n\t\t\tthis.pushChanges();\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t\tLocomotiveScrollService.start();\r\n\t\t\t// console.log('FiltersComponent.filteredItems', filteredItems.length);\r\n\t\t});\r\n\t\tthis.onLoaded();\r\n\t}\r\n\r\n\tonLoaded() {\r\n\t\t// console.log('FiltersComponent.onLoaded');\r\n\t}\r\n\r\n\tdoSortItems(items) {\r\n\t\treturn items;\r\n\t}\r\n\r\n\tgetVisibleItems() {\r\n\t\tconst filteredItems = this.filteredItems;\r\n\t\treturn filteredItems.slice(0, Math.min(12, filteredItems.length));\r\n\t}\r\n\r\n\tshowMore(event) {\r\n\t\tif (this.visibleItems.length + this.pageSize >= this.filteredItems.length) {\r\n\t\t\tthis.visibleItems = this.filteredItems.slice();\r\n\t\t} else {\r\n\t\t\tthis.visibleItems = this.filteredItems.slice(0, Math.min(this.visibleItems.length + this.pageSize, this.filteredItems.length));\r\n\t\t}\r\n\t\tthis.pushChanges();\r\n\t\tLocomotiveScrollService.update();\r\n\t}\r\n\r\n\tonSearch(model) {\r\n\t\t// console.log('FiltersComponent.onSearch', this.form.value);\r\n\t\t/*\r\n\t\tthis.setFilterByKeyAndValue('country', this.form.value.country);\r\n\t\t*/\r\n\t\tthis.setFilterByKeyAndValue('search', this.form.value.search);\r\n\t\tthis.pushChanges();\r\n\t}\r\n\r\n\tsetFilterByKeyAndValue(key, value) {\r\n\t\tconst filter = this.filters[key];\r\n\t\tif (filter) {\r\n\t\t\tif (filter.mode === FilterMode.QUERY) {\r\n\t\t\t\tfilter.set(value);\r\n\t\t\t} else {\r\n\t\t\t\tconst option = filter.options.find(x => x.value === value);\r\n\t\t\t\t// console.log(filter.options, option);\r\n\t\t\t\tif (option) {\r\n\t\t\t\t\tfilter.set(option);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfilter.clear();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tonFilterDidChange() {\r\n\t\tthis.pushChanges();\r\n\t}\r\n\r\n}\r\n\r\nFiltersComponent.meta = {\r\n\tselector: '[filters]',\r\n};\r\n","// import { combineLatest } from 'rxjs';\r\n// import { map } from 'rxjs/operators';\r\nimport { map } from 'rxjs/operators';\r\nimport { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class ProductsService {\r\n\r\n\tstatic all$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/products/all');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/products/all.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic listing$(listingId) {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$(`/products/listing/${listingId}`);\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$(`/products/listing.json?listingId=${listingId}`);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic filters$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/products/filters');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/products/filters.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic sort$(items$) {\r\n\t\treturn items$.pipe(\r\n\t\t\tmap(items => {\r\n\t\t\t\titems.sort((a, b) => {\r\n\t\t\t\t\tif (a.configurable !== b.configurable) {\r\n\t\t\t\t\t\treturn a.configurable ? -1 : 1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t/*\r\n\t\t\t\tif (environment.flags.cart) {\r\n\t\t\t\t\titems.sort((a, b) => {\r\n\t\t\t\t\t\tif (a.configurable !== b.configurable) {\r\n\t\t\t\t\t\t\treturn a.configurable ? -1 : 1;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\titems.forEach(x => x.configurable = false);\r\n\t\t\t\t}\r\n\t\t\t\t*/\r\n\t\t\t\treturn items;\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n\t/*\r\n\tstatic fake$() {\r\n\t\treturn combineLatest([ProductsService.all$(), ApiService.get$('/products/all_.json')]).pipe(\r\n\t\t\tmap(data => {\r\n\t\t\t\tconst items = data[0];\r\n\t\t\t\tconst items_ = data[1];\r\n\t\t\t\titems.forEach((item, i) => {\r\n\t\t\t\t\tconst other = items_.find(x => x.title === item.title);\r\n\t\t\t\t\tif (other) {\r\n\t\t\t\t\t\titem.category = {\r\n\t\t\t\t\t\t\tid: 1,\r\n\t\t\t\t\t\t\tname: other.url.replace('https://www.giorgettimeda.com/it/prodotti/', '').split('/')[0],\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tconsole.log(JSON.stringify(items));\r\n\t\t\t\treturn items;\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\t*/\r\n\r\n}\r\n","import { combineLatest } from 'rxjs';\r\nimport { environment } from '../../environment';\r\nimport { FiltersComponent } from '../../shared/filters/filters.component';\r\nimport { ProductsService } from './products.service';\r\n\r\nexport const SHOP_OPTION_ID = environment.flags.production ? 1 : 1;\r\n\r\nexport class ProductsComponent extends FiltersComponent {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tthis.listingId = this.listingId || null;\r\n\t\tthis.categoryId = this.categoryId || null;\r\n\t\tthis.subcategoryId = this.subcategoryId || null;\r\n\t\tthis.shop = this.shop || false;\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn combineLatest([\r\n\t\t\tthis.listingId ? ProductsService.listing$(this.listingId) : ProductsService.all$(),\r\n\t\t\tProductsService.filters$(),\r\n\t\t]);\r\n\t}\r\n\r\n\tsetFiltersParams() {\r\n\t\tif (this.categoryId) {\r\n\t\t\tthis.filters.category.set({ value: this.categoryId });\r\n\t\t}\r\n\t\tif (this.subcategoryId) {\r\n\t\t\tthis.filters.subcategory.set({ value: this.subcategoryId });\r\n\t\t}\r\n\t\tif (this.shop) {\r\n\t\t\tthis.filters.shop.set({ value: SHOP_OPTION_ID });\r\n\t\t}\r\n\t}\r\n\r\n\tdoFilterItem(key, item, value) {\r\n\t\tswitch (key) {\r\n\t\t\tcase 'category':\r\n\t\t\t\t// return item.category.id === value;\r\n\t\t\t\treturn item.categories.indexOf(value) !== -1;\r\n\t\t\tcase 'subcategory':\r\n\t\t\t\treturn item.subcategories.indexOf(value) !== -1;\r\n\t\t\tcase 'ambience':\r\n\t\t\t\treturn item.ambiences.indexOf(value) !== -1;\r\n\t\t\tcase 'material':\r\n\t\t\t\treturn item.materials.indexOf(value) !== -1;\r\n\t\t\tcase 'designer':\r\n\t\t\t\treturn item.designers.indexOf(value) !== -1;\r\n\t\t\tcase 'shop':\r\n\t\t\t\treturn value === SHOP_OPTION_ID ? item.configurable : true;\r\n\t\t\tcase 'search':\r\n\t\t\t\treturn item.title.toLowerCase().indexOf(value.toLowerCase()) !== -1;\r\n\t\t\tdefault:\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nProductsComponent.meta = {\r\n\tselector: '[products]',\r\n\tinputs: ['listingId', 'categoryId', 'subcategoryId', 'shop'],\r\n};\r\n","import { map } from 'rxjs/operators';\r\nimport { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class AmbienceService {\r\n\r\n\tstatic all$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/ambience/all');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/ambience/all.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic filters$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/ambience/filters');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/ambience/filters.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic sort$(items$) {\r\n\t\treturn items$.pipe(\r\n\t\t\tmap(items => {\r\n\t\t\t\titems.sort((a, b) => {\r\n\t\t\t\t\tif (a.configurable !== b.configurable) {\r\n\t\t\t\t\t\treturn a.configurable ? -1 : 1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t/*\r\n\t\t\t\tif (environment.flags.cart) {\r\n\t\t\t\t\titems.sort((a, b) => {\r\n\t\t\t\t\t\tif (a.configurable !== b.configurable) {\r\n\t\t\t\t\t\t\treturn a.configurable ? -1 : 1;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\titems.forEach(x => x.configurable = false);\r\n\t\t\t\t}\r\n\t\t\t\t*/\r\n\t\t\t\treturn items;\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n}\r\n","import { combineLatest } from 'rxjs';\r\nimport { FiltersComponent } from '../../shared/filters/filters.component';\r\nimport { SHOP_OPTION_ID } from '../products/products.component';\r\nimport { AmbienceService } from './ambience.service';\r\n\r\nexport class AmbienceComponent extends FiltersComponent {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tthis.ambienceId = this.ambienceId || null;\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn combineLatest([\r\n\t\t\tAmbienceService.all$(),\r\n\t\t\tAmbienceService.filters$(),\r\n\t\t]);\r\n\t}\r\n\r\n\tsetFiltersParams() {\r\n\t\tif (this.ambienceId) {\r\n\t\t\tthis.filters.ambience.set({ value: this.ambienceId });\r\n\t\t}\r\n\t}\r\n\r\n\tdoFilterItem(key, item, value) {\r\n\t\tswitch (key) {\r\n\t\t\tcase 'ambience':\r\n\t\t\t\treturn item.ambiences.indexOf(value) !== -1;\r\n\t\t\tcase 'category':\r\n\t\t\t\t// return item.category.id === value;\r\n\t\t\t\treturn item.categories.indexOf(value) !== -1;\r\n\t\t\tcase 'subcategory':\r\n\t\t\t\treturn item.subcategories.indexOf(value) !== -1;\r\n\t\t\tcase 'material':\r\n\t\t\t\treturn item.materials.indexOf(value) !== -1;\r\n\t\t\tcase 'designer':\r\n\t\t\t\treturn item.designers.indexOf(value) !== -1;\r\n\t\t\tcase 'shop':\r\n\t\t\t\treturn value === SHOP_OPTION_ID ? item.configurable : true;\r\n\t\t\tcase 'search':\r\n\t\t\t\treturn item.title.toLowerCase().indexOf(value.toLowerCase()) !== -1;\r\n\t\t\tdefault:\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nAmbienceComponent.meta = {\r\n\tselector: '[ambience]',\r\n\tinputs: ['ambienceId'],\r\n};\r\n","import { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class AteliersAndStoresService {\r\n\r\n\tstatic all$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/ateliers-and-stores/all');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/ateliers-and-stores/all.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic filters$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/ateliers-and-stores/filters');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/ateliers-and-stores/filters.json');\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\tstatic ateliers$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/ateliers-and-stores/ateliers.json');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/ateliers-and-stores/ateliers.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic stores$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/ateliers-and-stores/stores.json');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/ateliers-and-stores/stores.json');\r\n\t\t}\r\n\t}\r\n\t*/\r\n\r\n}\r\n","import { Component } from 'rxcomp';\r\nimport { FormControl, FormGroup } from 'rxcomp-form';\r\nimport { combineLatest } from 'rxjs';\r\nimport { finalize, first, takeUntil } from 'rxjs/operators';\r\nimport { FilterMode } from '../../common/filter/filter-item';\r\nimport { FilterService } from '../../common/filter/filter.service';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { AteliersAndStoresService } from './ateliers-and-stores.service';\r\n\r\nexport class AteliersAndStoresComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.types = {\r\n\t\t\tAtelier: 1,\r\n\t\t\tStore: 2,\r\n\t\t};\r\n\t\tthis.items = [];\r\n\t\tthis.filteredItems = [];\r\n\t\tthis.filteredAteliers = [];\r\n\t\tthis.filteredStores = [];\r\n\t\tthis.filters = {};\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\t/*\r\n\t\t\tcountry: new FormControl(null),\r\n\t\t\t*/\r\n\t\t\tsearch: new FormControl(null),\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tform.changes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe((_) => {\r\n\t\t\t// console.log('AteliersAndStoresComponent.changes$', form.value);\r\n\t\t\t/*\r\n\t\t\tthis.setFilterByKeyAndValue('country', form.value.country);\r\n\t\t\t*/\r\n\t\t\tthis.setFilterByKeyAndValue('search', form.value.search);\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t\tthis.busy = true;\r\n\t\tthis.load$().pipe(\r\n\t\t\tfirst(),\r\n\t\t\tfinalize(_ => {\r\n\t\t\t\tthis.busy = false;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t}),\r\n\t\t).subscribe(data => {\r\n\t\t\tthis.items = data[0];\r\n\t\t\tthis.filters = data[1];\r\n\t\t\t/*\r\n\t\t\tcontrols.country.options = FormService.toSelectOptions(this.filters.country.options);\r\n\t\t\t*/\r\n\t\t\tthis.onLoad();\r\n\t\t});\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn combineLatest([\r\n\t\t\tAteliersAndStoresService.all$(),\r\n\t\t\tAteliersAndStoresService.filters$(),\r\n\t\t]);\r\n\t}\r\n\r\n\tonLoad() {\r\n\t\tconst items = this.items;\r\n\t\tconst filters = this.filters;\r\n\t\tObject.keys(filters).forEach(key => {\r\n\t\t\tfilters[key].mode = filters[key].mode || FilterMode.OR;\r\n\t\t});\r\n\t\tconst initialParams = {};\r\n\t\tconst filterService = new FilterService(filters, initialParams, (key, filter) => {\r\n\t\t\tswitch (key) {\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tfilter.filter = (item, value) => {\r\n\t\t\t\t\t\tswitch (key) {\r\n\t\t\t\t\t\t\tcase 'country':\r\n\t\t\t\t\t\t\t\treturn item.country.id === value;\r\n\t\t\t\t\t\t\tcase 'search':\r\n\t\t\t\t\t\t\t\treturn item.title.toLowerCase().indexOf(value.toLowerCase()) !== -1 || item.country.name.toLowerCase().indexOf(value.toLowerCase()) !== -1\r\n\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.filterService = filterService;\r\n\t\tthis.filters = filterService.filters;\r\n\t\tconst country = this.filters.country.values.length ? this.filters.country.values[0] : null;\r\n\t\tconst search = this.filters.search.values.length ? this.filters.search.values[0] : null;\r\n\t\t// this.form.patch({ country, search });\r\n\t\tthis.form.patch({ search });\r\n\t\tfilterService.items$(items).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe(filteredItems => {\r\n\t\t\tthis.filteredItems = filteredItems;\r\n\t\t\tthis.filteredAteliers = filteredItems.filter(x => x.type === this.types.Atelier);\r\n\t\t\tthis.filteredStores = filteredItems.filter(x => x.type === this.types.Store);\r\n\t\t\tthis.pushChanges();\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t\t// console.log('AteliersAndStoresComponent.filteredItems', filteredItems.length);\r\n\t\t});\r\n\t}\r\n\r\n\tonSearch(model) {\r\n\t\t// console.log('AteliersAndStoresComponent.onSearch', this.form.value);\r\n\t\t/*\r\n\t\tthis.setFilterByKeyAndValue('country', this.form.value.country);\r\n\t\t*/\r\n\t\tthis.setFilterByKeyAndValue('search', this.form.value.search);\r\n\t\tthis.pushChanges();\r\n\t}\r\n\r\n\tsetFilterByKeyAndValue(key, value) {\r\n\t\tconst filter = this.filters[key];\r\n\t\tif (filter) {\r\n\t\t\tif (filter.mode === FilterMode.QUERY) {\r\n\t\t\t\tfilter.set(value);\r\n\t\t\t} else {\r\n\t\t\t\tconst option = filter.options.find(x => x.value === value);\r\n\t\t\t\t// console.log(filter.options, option);\r\n\t\t\t\tif (option) {\r\n\t\t\t\t\tfilter.set(option);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfilter.clear();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tonFilterDidChange() {\r\n\t\tthis.pushChanges();\r\n\t}\r\n}\r\n\r\nAteliersAndStoresComponent.meta = {\r\n\tselector: '[ateliers-and-stores]',\r\n};\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { ModalOutletComponent } from '../../common/modal/modal-outlet.component';\r\nimport { ModalService } from '../../common/modal/modal.service';\r\n\r\nexport class CareersModalComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tconst { parentInstance } = getContext(this);\r\n\t\tif (parentInstance instanceof ModalOutletComponent) {\r\n\t\t\tconst data = parentInstance.modal.data;\r\n\t\t\tthis.position = data.position;\r\n\t\t\tconsole.log('CareersModalComponent.onInit', data.position);\r\n\t\t}\r\n\t\tLocomotiveScrollService.stop();\r\n\t}\r\n\r\n\tonClose() {\r\n\t\tModalService.reject();\r\n\t}\r\n\r\n\tonDestroy() {\r\n\t\tLocomotiveScrollService.start();\r\n\t}\r\n}\r\n\r\nCareersModalComponent.meta = {\r\n\tselector: '[careers-modal]'\r\n};\r\n","function push_(event) {\r\n\tconst dataLayer = window.dataLayer || [];\r\n\tdataLayer.push(event);\r\n\tconsole.log('GtmService.dataLayer', event);\r\n}\r\n\r\nexport class GtmService {\r\n\r\n\tstatic push(event) {\r\n\t\treturn push_(event);\r\n\t}\r\n\r\n}\r\n","\r\nexport class FormService {\r\n\r\n\tstatic toOptions(options) {\r\n\t\toptions = options.slice().map(x => ({ id: x.value, name: x.label }));\r\n\t\treturn options;\r\n\t}\r\n\r\n\tstatic toSelectOptions(options) {\r\n\t\toptions = options.slice().map(x => ({ id: x.value, name: x.label }));\r\n\t\toptions.unshift({ id: null, name: 'select' });\r\n\t\treturn options;\r\n\t}\r\n\r\n}\r\n","import { FormValidator } from 'rxcomp-form';\r\n\r\nexport default function RequiredIfValidator(condition) {\r\n\treturn new FormValidator(function(value, params) {\r\n\t\tconst condition = params.condition;\r\n\t\tif (!typeof condition === 'function') {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif (Boolean(condition()) === true) {\r\n\t\t\treturn (value == null || value.length === 0) ? { required: true } : null;\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}, { condition });\r\n\r\n\treturn new FormValidator_old((value) => {\r\n\t\tlet field = null;\r\n\t\tif (typeof formGroup === 'function') {\r\n\t\t\tfield = formGroup().get(fieldName);\r\n\t\t} else if (formGroup) {\r\n\t\t\tfield = formGroup.get(fieldName);\r\n\t\t}\r\n\t\t// console.log('RequiredIfValidator', field.value, shouldBe != null ? field.value === shouldBe : field.value);\r\n\t\treturn (!value && field && (shouldBe != null ? field.value === shouldBe : field.value)) ? { required: { value: value, requiredIf: fieldName } } : null;\r\n\t});\r\n}\r\n","import { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class CareersService {\r\n\r\n\tstatic data$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/careers/data');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/careers/data.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic positions$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/careers/positions');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/careers/positions.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic submit$(payload) {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.post$('/careers/submit', payload);\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/careers/submit.json');\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { Component } from 'rxcomp';\r\nimport { FormControl, FormGroup, Validators } from 'rxcomp-form';\r\nimport { combineLatest } from 'rxjs';\r\nimport { first, takeUntil, tap } from 'rxjs/operators';\r\nimport { GtmService } from '../../common/gtm/gtm.service';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { ModalService } from '../../common/modal/modal.service';\r\nimport { FormService } from '../../controls/form.service';\r\nimport RequiredIfValidator from '../../controls/required-if.validator';\r\nimport { environment } from '../../environment';\r\nimport { CareersService } from './careers.service';\r\n\r\nexport class CareersComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.error = null;\r\n\t\tthis.success = false;\r\n\t\tthis.positions = [];\r\n\t\tconst isItaly = RequiredIfValidator(() => Boolean(this.form.value.country === 114));\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\tfirstName: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tlastName: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\temail: new FormControl(null, [Validators.RequiredValidator(), Validators.EmailValidator()]),\r\n\t\t\ttelephone: new FormControl(null),\r\n\t\t\tcountry: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tregion: new FormControl(null, [isItaly]),\r\n\t\t\tcity: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tdomain: new FormControl((this.position && this.position.domain) ? this.position.domain.id : null, [Validators.RequiredValidator()]),\r\n\t\t\tposition: new FormControl(this.position ? this.position.id : null),\r\n\t\t\tcv: new FormControl(null),\r\n\t\t\tpresentationLetter: new FormControl(null),\r\n\t\t\tmessage: new FormControl(null),\r\n\t\t\tprivacy: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: '',\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tform.changes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe((_) => {\r\n\t\t\tthis.pushChanges();\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t});\r\n\t\tthis.load$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn combineLatest([CareersService.data$(), CareersService.positions$()]).pipe(\r\n\t\t\ttap(results => {\r\n\t\t\t\tconst data = results[0];\r\n\t\t\t\tconst controls = this.controls;\r\n\t\t\t\tcontrols.country.options = FormService.toSelectOptions(data.country.options);\r\n\t\t\t\tcontrols.region.options = FormService.toSelectOptions(data.region.options);\r\n\t\t\t\tcontrols.domain.options = FormService.toSelectOptions(data.domain.options);\r\n\t\t\t\tconst positions = results[1];\r\n\t\t\t\tthis.positions = positions;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\ttest() {\r\n\t\tconst form = this.form;\r\n\t\tconst controls = this.controls;\r\n\t\tconst country = controls.country.options.length > 1 ? controls.country.options[1].id : null;\r\n\t\tconst region = controls.region.options.length > 1 ? controls.region.options[1].id : null;\r\n\t\tconst domain = controls.domain.options.length > 1 ? controls.domain.options[1].id : null;\r\n\t\tform.patch({\r\n\t\t\tfirstName: 'Jhon',\r\n\t\t\tlastName: 'Appleseed',\r\n\t\t\temail: 'jhonappleseed@gmail.com',\r\n\t\t\ttelephone: '0721 411112',\r\n\t\t\tcountry: country,\r\n\t\t\tregion: region,\r\n\t\t\tcity: 'Pesaro',\r\n\t\t\tdomain: domain,\r\n\t\t\tmessage: 'Hi!',\r\n\t\t\tprivacy: true,\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: ''\r\n\t\t});\r\n\t}\r\n\r\n\treset() {\r\n\t\tconst form = this.form;\r\n\t\tform.reset();\r\n\t}\r\n\r\n\tonSubmit(model) {\r\n\t\tconst form = this.form;\r\n\t\tconsole.log('CareersComponent.onSubmit', form.value);\r\n\t\t// console.log('CareersComponent.onSubmit', 'form.valid', valid);\r\n\t\tif (form.valid) {\r\n\t\t\t// console.log('CareersComponent.onSubmit', form.value);\r\n\t\t\tform.submitted = true;\r\n\t\t\tCareersService.submit$(form.value).pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t).subscribe(response => {\r\n\t\t\t\tconsole.log('CareersComponent.submit$', response);\r\n\t\t\t\tif (response.status === false) {\r\n\t\t\t\t\tthis.error = {\r\n\t\t\t\t\t\tstatusCode: '',\r\n\t\t\t\t\t\tstatusMessage: '',\r\n\t\t\t\t\t\tfriendlyMessage: response.html\r\n\t\t\t\t\t};\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.success = true;\r\n\t\t\t\t\tform.reset();\r\n\t\t\t\t\tGtmService.push({\r\n\t\t\t\t\t\t'event': \"Careers\",\r\n\t\t\t\t\t\t'form_name': \"Lavora con noi\"\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t\tLocomotiveScrollService.update();\r\n\t\t\t}, error => {\r\n\t\t\t\tconsole.log('CareersComponent.error', error);\r\n\t\t\t\tthis.error = error;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t\tLocomotiveScrollService.update();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tform.touched = true;\r\n\t\t}\r\n\t}\r\n\r\n\tonOpenPosition(position) {\r\n\t\tModalService.open$({ src: environment.template.modal.careersModal, data: { position } }).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(event => {\r\n\t\t\tconsole.log('CareersComponent.onOpenPosition', event);\r\n\t\t});\r\n\t}\r\n\r\n\tonClose() {\r\n\t\tthis.close.next(this.form.value);\r\n\t}\r\n}\r\n\r\nCareersComponent.meta = {\r\n\tselector: '[careers]',\r\n\toutputs: ['close'],\r\n\tinputs: ['isModal', 'position'],\r\n};\r\n","\r\nimport { from, fromEvent } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\nexport class OnceService {\r\n\r\n\tstatic uid = 0;\r\n\tstatic paths = [];\r\n\r\n\tstatic script$(url, callback) {\r\n\t\t// console.log('OnceScript.script$', url, callback);\r\n\t\tlet item = this.paths.find(x => x.url === url);\r\n\t\tif (item != null) {\r\n\t\t\treturn item.callback$;\r\n\t\t} else {\r\n\t\t\titem = { url, callbacks$: null };\r\n\t\t\tthis.paths.push(item);\r\n\t\t\tlet callbackName;\r\n\t\t\tif (callback === true) {\r\n\t\t\t\tcallbackName = 'OnceCallback' + (++this.uid);\r\n\t\t\t\turl = url.split('{{callback}}').join(callbackName);\r\n\t\t\t} else {\r\n\t\t\t\tcallbackName = callback;\r\n\t\t\t}\r\n\t\t\tlet callback$;\r\n\t\t\tconst script = document.createElement('script');\r\n\t\t\tscript.type = 'text/javascript';\r\n\t\t\tif (callback) {\r\n\t\t\t\tcallback$ = from(\r\n\t\t\t\t\tnew Promise((resolve, reject) => {\r\n\t\t\t\t\t\twindow[callbackName] = function(data) {\r\n\t\t\t\t\t\t\t// console.log('OnceScript', callbackName, data);\r\n\t\t\t\t\t\t\tresolve(data);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tscript.async = true;\r\n\t\t\t\tcallback$ = fromEvent(script, 'load').pipe(\r\n\t\t\t\t\tmap(x => x)\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\titem.callback$ = callback$;\r\n\t\t\tconst scripts = Array.prototype.slice.call(document.getElementsByTagName('script'));\r\n\t\t\tif (scripts.length) {\r\n\t\t\t\tscript.src = url;\r\n\t\t\t\tconst lastScript = scripts[scripts.length - 1];\r\n\t\t\t\tlastScript.parentNode.insertBefore(script, lastScript.nextSibling);\r\n\t\t\t}\r\n\t\t\t// console.log('OnceScript.script$', scripts.length, script.src, scripts.map(x => x.src).join(', '));\r\n\t\t\treturn callback$;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","\r\n/*\r\n<script>\r\n  window.fbAsyncInit = function() {\r\n\tFB.init({\r\n\t  appId      : '{your-app-id}',\r\n\t  cookie     : true,\r\n\t  xfbml      : true,\r\n\t  version    : '{api-version}'\r\n\t});\r\n\r\n\tFB.AppEvents.logPageView();\r\n\r\n  };\r\n\r\n  (function(d, s, id){\r\n\t var js, fjs = d.getElementsByTagName(s)[0];\r\n\t if (d.getElementById(id)) {return;}\r\n\t js = d.createElement(s); js.id = id;\r\n\t js.src = \"https://connect.facebook.net/en_US/sdk.js\";\r\n\t fjs.parentNode.insertBefore(js, fjs);\r\n   }(document, 'script', 'facebook-jssdk'));\r\n</script>\r\n\r\n\r\n1. check status (already logged?)\r\nFB.getLoginStatus(function(response) {\r\n\tstatusChangeCallback(response);\r\n\t{\r\n\t\tstatus: 'connected',\r\n\t\tauthResponse: {\r\n\t\t\taccessToken: '...',\r\n\t\t\texpiresIn:'...',\r\n\t\t\tsignedRequest:'...',\r\n\t\t\tuserID:'...'\r\n\t\t}\r\n\t}\r\n});\r\n\r\n2. login\r\nFB.login(function(response) {\r\n  if (response.status === 'connected') {\r\n\t// Logged into your webpage and Facebook.\r\n  } else {\r\n\t// The person is not logged into your webpage or we are unable to tell.\r\n  }\r\n}, {scope: 'public_profile,email'});\r\n\r\n3. logout\r\nFB.logout(function(response) {\r\n   // Person is now logged out\r\n});\r\n\r\n\r\nfunction statusChangeCallback(response) {  // Called with the results from FB.getLoginStatus().\r\n\tconsole.log('statusChangeCallback');\r\n\tconsole.log(response);                   // The current login status of the person.\r\n\tif (response.status === 'connected') {   // Logged into your webpage and Facebook.\r\n\t  testAPI();\r\n\t} else {                                 // Not logged into your webpage or we are unable to tell.\r\n\t  document.getElementById('status').innerHTML = 'Please log ' +\r\n\t\t'into this webpage.';\r\n\t}\r\n  }\r\n\r\nfunction testAPI() {                      // Testing Graph API after login.  See statusChangeCallback() for when this call is made.\r\n\tconsole.log('Welcome!  Fetching your information.... ');\r\n\tFB.api('/me', function(response) {\r\n\t  console.log('Successful login for: ' + response.name);\r\n\t  document.getElementById('status').innerHTML =\r\n\t\t'Thanks for logging in, ' + response.name + '!';\r\n\t});\r\n  }\r\n\r\n*/\r\n\r\n/*\r\nstatic init(document, tagName, id) {\r\n\tlet script;\r\n\tlet firstTagName = document.getElementsByTagName(tagName)[0];\r\n\tif (document.getElementById(id)) {\r\n\t\treturn;\r\n\t}\r\n\tscript = document.createElement(tagName);\r\n\tscript.id = id;\r\n\tscript.src = 'https://connect.facebook.net/en_US/sdk.js';\r\n\tfirstTagName.parentNode.insertBefore(script, firstTagName);\r\n}\r\n*/\r\n\r\nimport { from, of } from \"rxjs\";\r\nimport { catchError, concatMap, filter, switchMap } from \"rxjs/operators\";\r\nimport { environment } from \"../../environment\";\r\nimport { OnceService } from \"../once/once.service\";\r\nimport { LocalStorageService } from \"../storage/local-storage.service\";\r\n\r\nexport class FacebookService {\r\n\r\n\tstatic facebook_ = null;\r\n\tstatic authResponse_ = null;\r\n\r\n\tstatic facebook$() {\r\n\t\tif (window.location.protocol.indexOf('https') !== -1) {\r\n\t\t\tif (this.facebook_) {\r\n\t\t\t\treturn of(this.facebook_);\r\n\t\t\t} else {\r\n\t\t\t\treturn OnceService.script$('//connect.facebook.net/' + environment.currentLanguage + '/sdk.js', 'fbAsyncInit').pipe(\r\n\t\t\t\t\tconcatMap(x => {\r\n\t\t\t\t\t\tconst facebook = window['FB'];\r\n\t\t\t\t\t\tfacebook.init({\r\n\t\t\t\t\t\t\tappId: environment.facebook.appId,\r\n\t\t\t\t\t\t\t// status: true,\r\n\t\t\t\t\t\t\tcookie: true,\r\n\t\t\t\t\t\t\txfbml: true,\r\n\t\t\t\t\t\t\tversion: environment.facebook.version,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tfacebook.AppEvents.logPageView();\r\n\t\t\t\t\t\tthis.facebook_ = facebook;\r\n\t\t\t\t\t\treturn of(facebook);\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn of(null);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic status$() {\r\n\t\treturn this.facebook$().pipe(\r\n\t\t\tfilter(facebook => facebook !== null),\r\n\t\t\tconcatMap(facebook => {\r\n\t\t\t\treturn from(new Promise((resolve, reject) => {\r\n\t\t\t\t\tfacebook.getLoginStatus((response) => {\r\n\t\t\t\t\t\tthis.authResponse_ = null;\r\n\t\t\t\t\t\tif (response.status === 'connected') {\r\n\t\t\t\t\t\t\tthis.authResponse_ = response.authResponse;\r\n\t\t\t\t\t\t\tLocalStorageService.set('facebook', response.authResponse);\r\n\t\t\t\t\t\t\tresolve(response);\r\n\t\t\t\t\t\t} else if (response.status === 'not_authorized') {\r\n\t\t\t\t\t\t\tLocalStorageService.delete('facebook');\r\n\t\t\t\t\t\t\treject(response);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treject(response);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, { scope: environment.facebook.scope });\r\n\t\t\t\t}));\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tstatic login$() {\r\n\t\treturn this.facebook$().pipe(\r\n\t\t\tfilter(facebook => facebook !== null),\r\n\t\t\tconcatMap(facebook => {\r\n\t\t\t\treturn from(new Promise((resolve, reject) => {\r\n\t\t\t\t\tfacebook.login((response) => {\r\n\t\t\t\t\t\tthis.authResponse_ = null;\r\n\t\t\t\t\t\tif (response.status === 'connected') {\r\n\t\t\t\t\t\t\tthis.authResponse_ = response.authResponse;\r\n\t\t\t\t\t\t\tLocalStorageService.set('facebook', response.authResponse);\r\n\t\t\t\t\t\t\tresolve(response);\r\n\t\t\t\t\t\t} else if (response.status === 'not_authorized') {\r\n\t\t\t\t\t\t\tLocalStorageService.delete('facebook');\r\n\t\t\t\t\t\t\treject(response);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treject(response);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, { scope: environment.facebook.scope });\r\n\t\t\t\t}));\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tstatic logout$() {\r\n\t\treturn this.status$().pipe(\r\n\t\t\tcatchError(error => {\r\n\t\t\t\tLocalStorageService.delete('facebook');\r\n\t\t\t\treturn of(null);\r\n\t\t\t}),\r\n\t\t\tswitchMap(_ => {\r\n\t\t\t\treturn from(new Promise((resolve, reject) => {\r\n\t\t\t\t\tthis.facebook_.logout(response => {\r\n\t\t\t\t\t\tresolve(response);\r\n\t\t\t\t\t\tLocalStorageService.delete('facebook');\r\n\t\t\t\t\t});\r\n\t\t\t\t}));\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tstatic me$(fields) {\r\n\t\treturn this.status$().pipe(\r\n\t\t\tcatchError(error => {\r\n\t\t\t\treturn this.login$();\r\n\t\t\t}),\r\n\t\t\tconcatMap(l => {\r\n\t\t\t\treturn from(new Promise((resolve, reject) => {\r\n\t\t\t\t\tfields = fields || environment.facebook.fields;\r\n\t\t\t\t\tthis.facebook_.api('/me', {\r\n\t\t\t\t\t\tfields: fields,\r\n\t\t\t\t\t\taccessToken: environment.facebook.tokenClient,\r\n\t\t\t\t\t}, (response) => {\r\n\t\t\t\t\t\tif (!response || response.error) {\r\n\t\t\t\t\t\t\tconst error = response ? response.error : 'error';\r\n\t\t\t\t\t\t\tconsole.log('FacebookService.getMe.error', error);\r\n\t\t\t\t\t\t\treject(response.error);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconst user = response;\r\n\t\t\t\t\t\t\tuser.authResponse = this.authResponse_;\r\n\t\t\t\t\t\t\tuser.facebookToken = this.authResponse_.accessToken;\r\n\t\t\t\t\t\t\tresolve(user);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}));\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n}\r\n","\r\n\r\n\r\nimport { from, Observable, of } from 'rxjs';\r\nimport { concatMap } from 'rxjs/operators';\r\nimport { environment } from '../../environment';\r\nimport { OnceService } from '../once/once.service';\r\nimport { LocalStorageService } from '../storage/local-storage.service';\r\n\r\n/*\r\nexport class GoogleConfig {\r\n\tpublic clientId: string;\r\n\tpublic cookiepolicy?: string = 'single_host_origin';\r\n\tpublic scope?: string = 'profile email';\r\n\tpublic fetch_basic_profile?: boolean = true;\r\n\tpublic ux_mode?: string = 'popup';\r\n}\r\n\r\nexport class GoogleAuthResponse {\r\n\ttoken_type: string;\r\n\taccess_token: string;\r\n\tscope: string;\r\n\tlogin_hint: string;\r\n\texpires_in: number;\r\n\texpires_at: number;\r\n\tfirst_issued_at: number;\r\n\tid_token: string;\r\n\tidpId: string;\r\n\tsignedRequest: string;\r\n\tuserID: string;\r\n}\r\n\r\nexport class GoogleUser {\r\n\temail: string;\r\n\tfirstName: string;\r\n\tid: string;\r\n\tlastName: string;\r\n\tname: string;\r\n\tpicture: string;\r\n\tauthResponse?: GoogleAuthResponse;\r\n\tgoogleToken?: string;\r\n}\r\n*/\r\n\r\nexport class GoogleService {\r\n\r\n\tstatic authResponse;\r\n\tstatic storage;\r\n\tstatic gapi;\r\n\tstatic auth2;\r\n\tstatic instance;\r\n\r\n\tstatic init() {\r\n\t\t/*\r\n\t\tif (!environment['plugins'] && !environment['plugins']['google']) {\r\n\t\t\tthrow new Error('GoogleService.error missing config object in environment.plugins.google');\r\n\t\t}\r\n\t\t*/\r\n\t\tthis.authResponse = LocalStorageService.get('google');\r\n\t\t// console.log('GoogleService.authResponse', this.authResponse);\r\n\t}\r\n\r\n\t/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\r\n\t*  call GoogleService.google on component OnInit to avoid popup blockers via asyncronous loading *\r\n\t* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */\r\n\r\n\tstatic google$() {\r\n\t\treturn new Observable().pipe(x => {\r\n\t\t\tif (this.gapi) {\r\n\t\t\t\treturn of(this.gapi);\r\n\t\t\t} else {\r\n\t\t\t\treturn this.once$();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tstatic once$() {\r\n\t\treturn OnceService.script$('//apis.google.com/js/api:client.js?onload={{callback}}', true).pipe(\r\n\t\t\tconcatMap(x => {\r\n\t\t\t\tthis.gapi = window['gapi'];\r\n\t\t\t\treturn of(this.gapi);\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tstatic me$() {\r\n\t\treturn this.login$().pipe(\r\n\t\t\tconcatMap(x => {\r\n\t\t\t\tconst profile = this.instance.currentUser.get().getBasicProfile();\r\n\t\t\t\tconst user = {\r\n\t\t\t\t\tid: profile.getId(),\r\n\t\t\t\t\tname: profile.getName(),\r\n\t\t\t\t\tfirstName: profile.getGivenName(),\r\n\t\t\t\t\tlastName: profile.getFamilyName(),\r\n\t\t\t\t\tpicture: profile.getImageUrl(),\r\n\t\t\t\t\temail: profile.getEmail(),\r\n\t\t\t\t\tauthResponse: this.authResponse,\r\n\t\t\t\t\tgoogleToken: this.authResponse.access_token,\r\n\t\t\t\t};\r\n\t\t\t\treturn of(user);\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tstatic login$() {\r\n\t\treturn this.auth2Instance$().pipe(\r\n\t\t\tconcatMap(x => {\r\n\t\t\t\treturn this.signin$();\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tstatic logout$() {\r\n\t\treturn this.auth2Instance$().pipe(\r\n\t\t\tconcatMap(x => {\r\n\t\t\t\treturn from(\r\n\t\t\t\t\tnew Promise((resolve, reject) => {\r\n\t\t\t\t\t\tif (this.instance.isSignedIn && this.instance.isSignedIn.get()) {\r\n\t\t\t\t\t\t\tthis.instance.signOut().then((signed) => {\r\n\t\t\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t\t\t}, reject);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tstatic getAuth2$() {\r\n\t\treturn new Observable().pipe(x => {\r\n\t\t\tif (this.auth2) {\r\n\t\t\t\treturn of(this.auth2);\r\n\t\t\t} else {\r\n\t\t\t\treturn this.google$().pipe(\r\n\t\t\t\t\tconcatMap(x => {\r\n\t\t\t\t\t\tif (this.gapi.auth2) {\r\n\t\t\t\t\t\t\treturn this.auth2init$();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn from(\r\n\t\t\t\t\t\t\t\tnew Promise((resolve, reject) => {\r\n\t\t\t\t\t\t\t\t\tthis.gapi.load('auth2', () => {\r\n\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\t\t\t\tresolve();\r\n\t\t\t\t\t\t\t\t\t\t}, 200);\r\n\t\t\t\t\t\t\t\t\t}, reject);\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t).pipe(\r\n\t\t\t\t\t\t\t\tconcatMap(x => {\r\n\t\t\t\t\t\t\t\t\treturn this.auth2init$();\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tstatic signin$() {\r\n\t\treturn from(\r\n\t\t\tnew Promise((resolve, reject) => {\r\n\t\t\t\tconst readAccessToken = () => {\r\n\t\t\t\t\t// console.log('GoogleLogin.readAccessToken');\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tconst user = this.instance.currentUser.get().getAuthResponse(true);\r\n\t\t\t\t\t\t// console.log('GoogleLogin.readAccessToken.success', user);\r\n\t\t\t\t\t\tthis.authResponse = user;\r\n\t\t\t\t\t\tLocalStorageService.set('google', user);\r\n\t\t\t\t\t\tresolve({\r\n\t\t\t\t\t\t\tcode: user.access_token,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\tconsole.log('GoogleLogin.readAccessToken.error', error);\r\n\t\t\t\t\t\tLocalStorageService.delete('google');\r\n\t\t\t\t\t\treject(error);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tif (this.instance.isSignedIn && this.instance.isSignedIn.get()) {\r\n\t\t\t\t\treadAccessToken();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.instance.signIn({\r\n\t\t\t\t\t\tscope: 'profile email',\r\n\t\t\t\t\t}).then((signed) => {\r\n\t\t\t\t\t\treadAccessToken();\r\n\t\t\t\t\t}, (error) => {\r\n\t\t\t\t\t\tLocalStorageService.delete('google');\r\n\t\t\t\t\t\treject(error);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tstatic auth2init$() {\r\n\t\treturn from(\r\n\t\t\tnew Promise((resolve, reject) => {\r\n\t\t\t\tthis.gapi.auth2.init({\r\n\t\t\t\t\tclient_id: environment.google.clientId,\r\n\t\t\t\t\tcookiepolicy: 'single_host_origin',\r\n\t\t\t\t\tscope: 'profile email',\r\n\t\t\t\t\tfetch_basic_profile: true,\r\n\t\t\t\t\tux_mode: 'popup',\r\n\t\t\t\t}).then(() => {\r\n\t\t\t\t\tthis.auth2 = this.gapi.auth2;\r\n\t\t\t\t\t// console.log('Auth2Init.success', this.auth2);\r\n\t\t\t\t\tresolve(this.auth2);\r\n\t\t\t\t}, reject);\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tstatic auth2Instance$() {\r\n\t\tif (this.instance) {\r\n\t\t\treturn of(this.instance);\r\n\t\t} else {\r\n\t\t\treturn this.getAuth2$().pipe(\r\n\t\t\t\tconcatMap(x => {\r\n\t\t\t\t\tthis.instance = this.auth2.getAuthInstance();\r\n\t\t\t\t\treturn of(this.instance);\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","\r\n\r\n\r\nimport { from, Observable, of } from 'rxjs';\r\nimport { catchError, concatMap, switchMap } from 'rxjs/operators';\r\nimport { environment } from '../../environment';\r\nimport { OnceService } from '../once/once.service';\r\n\r\nexport class GoogleMapsService {\r\n\r\n\tstatic maps;\r\n\r\n\tstatic init() {\r\n\t\tif (!environment.googleMaps || !environment.googleMaps.apiKey) {\r\n\t\t\tthrow new Error('GoogleMapsService.error missing apiKey in environment.googleMaps');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic maps$() {\r\n\t\treturn new Observable().pipe(_ => {\r\n\t\t\tif (this.maps) {\r\n\t\t\t\treturn of(this.maps);\r\n\t\t\t} else {\r\n\t\t\t\treturn this.once$();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tstatic once$() {\r\n\t\tif (!environment.googleMaps || !environment.googleMaps.apiKey) {\r\n\t\t\tthrow new Error('GoogleMapsService.error missing apiKey in environment.googleMaps');\r\n\t\t}\r\n\t\treturn OnceService.script$(`//maps.googleapis.com/maps/api/js?callback={{callback}}&key=${environment.googleMaps.apiKey}&libraries=places&language=${environment.currentLanguage}`, true).pipe(\r\n\t\t\tconcatMap(_ => {\r\n\t\t\t\tthis.maps = window.google.maps;\r\n\t\t\t\treturn of(this.maps);\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tstatic geocode$(data) {\r\n\t\t// console.log('GoogleMapsService.geocode$', data);\r\n\t\treturn GoogleMapsService.maps$().pipe(\r\n\t\t\tswitchMap(maps => {\r\n\t\t\t\t// console.log('GoogleMapsService.geocode$', maps);\r\n\t\t\t\treturn from(new Promise((resolve, reject) => {\r\n\t\t\t\t\tconst geocoder = new maps.Geocoder();\r\n\t\t\t\t\tgeocoder.geocode(data, (results, status) => {\r\n\t\t\t\t\t\t// console.log('GoogleMapsService.geocode$', status, results);\r\n\t\t\t\t\t\tif (status == 'OK') {\r\n\t\t\t\t\t\t\tresolve(results);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treject(results);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}));\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n\tstatic getAutocompleteService(maps) {\r\n\t\tif (!this.autocompleteService_) {\r\n\t\t\tthis.autocompleteService_ = new maps.places.AutocompleteService();\r\n\t\t}\r\n\t\treturn this.autocompleteService_;\r\n\t}\r\n\r\n\tstatic getPlaceService(maps, map) {\r\n\t\tif (!this.placeService_) {\r\n\t\t\tthis.placeService_ = new maps.places.PlacesService(map);\r\n\t\t}\r\n\t\treturn this.placeService_;\r\n\t}\r\n\r\n\tstatic autocomplete$(query) {\r\n\t\t// console.log('GoogleMapsService.autocomplete$', query);\r\n\t\t/*\r\n\t\tinput\r\n\t\tType:  string\r\n\t\tThe user entered input string.\r\n\r\n\t\tbounds optional\r\n\t\tType:  LatLngBounds|LatLngBoundsLiteral optional\r\n\t\tBounds for prediction biasing. Predictions will be biased towards, but not restricted to, the given bounds. Both location and radius will be ignored if bounds is set.\r\n\r\n\t\tcomponentRestrictions optional\r\n\t\tType:  ComponentRestrictions optional\r\n\t\tThe component restrictions. Component restrictions are used to restrict predictions to only those within the parent component. For example, the country.\r\n\r\n\t\tlocation optional\r\n\t\tType:  LatLng optional\r\n\t\tLocation for prediction biasing. Predictions will be biased towards the given location and radius. Alternatively, bounds can be used.\r\n\r\n\t\toffset optional\r\n\t\tType:  number optional\r\n\t\tThe character position in the input term at which the service uses text for predictions (the position of the cursor in the input field).\r\n\r\n\t\torigin optional\r\n\t\tType:  LatLng|LatLngLiteral optional\r\n\t\tThe location where AutocompletePrediction.distance_meters is calculated from.\r\n\r\n\t\tradius optional\r\n\t\tType:  number optional\r\n\t\tThe radius of the area used for prediction biasing. The radius is specified in meters, and must always be accompanied by a location property. Alternatively, bounds can be used.\r\n\r\n\t\tsessionToken optional\r\n\t\tType:  AutocompleteSessionToken optional\r\n\t\tUnique reference used to bundle individual requests into sessions.\r\n\r\n\t\ttypes optional\r\n\t\tType:  Array<string> optional\r\n\t\tThe types of predictions to be returned. For a list of supported types, see the developer's guide. If nothing is specified, all types are returned. In general only a single type is allowed. The exception is that you can safely mix the 'geocode' and 'establishment' types, but note that this will have the same effect as specifying no types.\r\n\t\t*/\r\n\t\treturn GoogleMapsService.maps$().pipe(\r\n\t\t\tswitchMap(maps => {\r\n\t\t\t\tconst autocompleteService = this.getAutocompleteService(maps);\r\n\t\t\t\treturn from(new Promise((resolve, reject) => {\r\n\t\t\t\t\tconst options = {\r\n\t\t\t\t\t\tinput: query,\r\n\t\t\t\t\t\t// fields: [\"formatted_address\", \"geometry\", \"name\"],\r\n\t\t\t\t\t\t// strictBounds: false,\r\n\t\t\t\t\t\t// types: [\"locality\", \"sublocality\", \"postal_code\", \"country\", \"administrative_area_level_1\", \"administrative_area_level_2\", \"administrative_area_level_3\"],\r\n\t\t\t\t\t};\r\n\t\t\t\t\t// console.log('GoogleMapsService.autocomplete$', options);\r\n\t\t\t\t\tautocompleteService.getPlacePredictions(options, (predictions, status) => {\r\n\t\t\t\t\t\tif (status === maps.places.PlacesServiceStatus.OK && predictions && predictions.length) {\r\n\t\t\t\t\t\t\tpredictions = predictions.map(prediction => {\r\n\t\t\t\t\t\t\t\t// console.log(prediction);\r\n\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\tid: prediction.place_id,\r\n\t\t\t\t\t\t\t\t\tname: prediction.description,\r\n\t\t\t\t\t\t\t\t\tdescription: prediction.description,\r\n\t\t\t\t\t\t\t\t\t/*\r\n\t\t\t\t\t\t\t\t\tlat: prediction.geometry.location.lat(),\r\n\t\t\t\t\t\t\t\t\tlng: prediction.geometry.location.lng(),\r\n\t\t\t\t\t\t\t\t\t*/\r\n\t\t\t\t\t\t\t\t\tgetDetails: (map) => {\r\n\t\t\t\t\t\t\t\t\t\tconst request = {\r\n\t\t\t\t\t\t\t\t\t\t\tplaceId: prediction.place_id,\r\n\t\t\t\t\t\t\t\t\t\t\tfields: ['name', 'address_component', 'geometry.location', 'geometry.viewport'],\r\n\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\t\t\t\t\t\t\tconst placeService = this.getPlaceService(maps, map);\r\n\t\t\t\t\t\t\t\t\t\t\tplaceService.getDetails(request, (place, status) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (status == maps.places.PlacesServiceStatus.OK) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// console.log(place);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst components = place.address_components;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst streetNumber = components.find((x) => x.types.includes('street_number'));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst streetNumberName = streetNumber ? streetNumber.short_name : '';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst route = components.find((x) => x.types.includes('route'));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst routeName = route ? route.short_name : '';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst locality = components.find((x) => x.types.includes('locality'));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst localityName = locality ? locality.short_name : '';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst postal_code = components.find((x) => x.types.includes('postal_code'));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst zipCode = postal_code ? postal_code.short_name : '';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst city = components.find((x) => x.types.includes('administrative_area_level_3'));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst cityName = city ? city.short_name : '';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst province = components.find((x) => x.types.includes('administrative_area_level_2'));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst provinceName = province ? province.short_name : '';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst country = components.find((x) => x.types.includes('country'));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst countryName = country ? country.long_name : '';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst address = (route ? routeName : '') + (streetNumber ? ', ' + streetNumberName : '') + (locality && (!city || cityName !== localityName) ? ', ' + localityName : '');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// console.log(place);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst location = place.geometry ? place.geometry.location : null;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst latitude = location ? location.lat() : null;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst longitude = location ? location.lng() : null;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tresolve({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstreetNumber: streetNumberName,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\troute: routeName,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlocality: localityName,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tzipCode: zipCode,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcity: cityName,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tprovince: provinceName,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcountry: countryName,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taddress: address,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlatitude: latitude,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlongitude: longitude,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tgeometry: place.geometry,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treject(status);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tresolve(predictions);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treject(status);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t})).pipe(\r\n\t\t\t\t\tcatchError(error => {\r\n\t\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t\t\treturn of([]);\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n}\r\n","\r\n\r\n\r\nimport { Subject } from 'rxjs';\r\nimport { switchMap, tap } from 'rxjs/operators';\r\nimport { environment } from '../../environment';\r\nimport { ApiService } from '../api/api.service';\r\nimport { LocalStorageService } from '../storage/local-storage.service';\r\n\r\nexport class LinkedinService {\r\n\r\n\tstatic getAccessToken$(code) {\r\n\t\tconst data = {\r\n\t\t\tgrant_type: 'authorization_code',\r\n\t\t\tcode: code,\r\n\t\t\tclient_id: environment.linkedIn.clientId,\r\n\t\t\tclient_secret: environment.linkedIn.clientSecret,\r\n\t\t\tredirect_uri: `${window.location.origin}/giorgetti/cart.html`,\r\n\t\t}\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.post$('/user/linkedin', data);\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/user/linkedin.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic linkedin$() {\r\n\t\tconst event$ = new Subject();\r\n\t\tconst key = 'linkedin';\r\n\t\tconst state = `${key}-${new Date().getTime()}`;\r\n\t\twindow.onSocialCallback = (social, params) => {\r\n\t\t\tif (social === 'linkedin' && params.state === state) {\r\n\t\t\t\tconsole.log('onSocialCallback', params.code);\r\n\t\t\t\tevent$.next(params.code);\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst width = 375 * 2;\r\n\t\tconst height = 667;\r\n\t\twindow.open(\r\n\t\t\t`https://www.linkedin.com/oauth/v2/authorization?response_type=code&client_id=${environment.linkedIn.clientId}&redirect_uri=${window.location.origin}/giorgetti/cart.html&state=${state}&scope=${environment.linkedIn.scope}`,\r\n\t\t\tkey,\r\n\t\t\t`top=${Math.floor((window.innerHeight - height) / 2)}, left=${Math.floor((window.innerWidth - width) / 2)}, width=${width}, height=${height}, status=no, menubar=no, toolbar=no scrollbars=no`,\r\n\t\t);\r\n\t\t// https://localhost:48481/giorgetti/cart.html?code=AQRqT4xWst4rcKM_sarxRTHP7PJ_eUbiQP30KZuyjGgSuoNQjZzJtSIu6laX6o-R-hy9obrIhzRKA3EshZfkIgo-ErIEahuyyAkY7Lg5PRFCEDdJxiy-cKyz8O9Vl6wVs2hoO_m7QvhLB22YfL_qqtToWqEUvWLwWqVTzRgEbu_U2AWDltOP_mSVNLge3Qc_uRV6VZDPeQqPcY2ICgo&state=foobar\r\n\t\treturn event$.pipe(\r\n\t\t\tswitchMap(code => {\r\n\t\t\t\treturn this.getAccessToken$(code);\r\n\t\t\t}),\r\n\t\t\ttap(accessToken => {\r\n\t\t\t\tLocalStorageService.set('linkedin', accessToken);\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n}\r\n","import { FormValidator } from 'rxcomp-form';\r\n\r\n/**\r\n * a required and true validator based on condition\r\n */\r\nexport default function RequiredTrueIfValidator(condition) {\r\n\treturn new FormValidator(function(value, params) {\r\n\t\tconst condition = params.condition;\r\n\t\tif (!typeof condition === 'function') {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif (Boolean(condition()) === true) {\r\n\t\t\treturn value === true ? null : { required: true };\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}, { condition });\r\n}\r\n","import { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class OrdersService {\r\n\r\n\tstatic all$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\t// !!! restituisce gli ordini effettuati dell'utente in sessione.\r\n\t\t\treturn ApiService.get$('/orders/all');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/orders/all.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic detail$(orderId) {\r\n\t\tif (environment.flags.production) {\r\n\t\t\t// !!! restituisce il dettaglio dell'ordine dell'utente in sessione con id == orderId.\r\n\t\t\treturn ApiService.get$(`/orders/detail/${orderId}`);\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/orders/detail.json');\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { FormControl, FormGroup, Validators } from 'rxcomp-form';\r\nimport { combineLatest, of } from 'rxjs';\r\nimport { finalize, first, map, switchMap, takeUntil, tap } from 'rxjs/operators';\r\nimport { FacebookService } from '../../common/facebook/facebook.service';\r\nimport { GoogleService } from '../../common/google/google.service';\r\nimport { GoogleMapsService } from '../../common/googlemaps/googlemaps.service';\r\nimport { GtmService } from '../../common/gtm/gtm.service';\r\nimport { LinkedinService } from '../../common/linkedin/linkedin.service';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { ModalResolveEvent, ModalService } from '../../common/modal/modal.service';\r\nimport { NumberPipe } from '../../common/number/number.pipe';\r\nimport { FormService } from '../../controls/form.service';\r\nimport RequiredIfValidator from '../../controls/required-if.validator';\r\nimport RequiredTrueIfValidator from '../../controls/required-true-if.validator';\r\nimport { environment } from '../../environment';\r\nimport { CartMiniService } from '../../shared/cart-mini/cart-mini.service';\r\nimport { UserService } from '../../shared/user/user.service';\r\nimport { OrdersService } from '../orders/orders.service';\r\nimport { CartService, CartSteps } from './cart.service';\r\n\r\nexport class CartComponent extends Component {\r\n\r\n\tget totalPrice() {\r\n\t\tconst items = this.items || [];\r\n\t\tlet total = items.reduce((p, c, i) => {\r\n\t\t\treturn p + c.price.price * c.qty;\r\n\t\t}, 0);\r\n\t\tif (this.delivery) {\r\n\t\t\ttotal += this.delivery.price;\r\n\t\t}\r\n\t\tif (this.discount) {\r\n\t\t\ttotal += this.discount.value;\r\n\t\t}\r\n\t\treturn total;\r\n\t}\r\n\r\n\tget selectedStore() {\r\n\t\tif (!this.controls || !this.controls.stores || !this.controls.stores.value) {\r\n\t\t\treturn null;\r\n\t\t} else {\r\n\t\t\treturn this.controls.stores.value.find(x => x.id === this.controls.store.value);\r\n\t\t}\r\n\t}\r\n\r\n\tget shipmentCountriesLabel() {\r\n\t\tlet shipmentCountriesLabel = '';\r\n\t\tshipmentCountriesLabel = this.shipmentCountryOptions.map(x => x.label).join(', ');\r\n\t\treturn shipmentCountriesLabel;\r\n\t}\r\n\r\n\tonInit() {\r\n\t\tthis.busy = false;\r\n\t\tthis.orderBusy = false;\r\n\t\tthis.hasPendingCart = false;\r\n\t\tthis.steps = CartSteps;\r\n\t\tthis.setStep(CartSteps.None);\r\n\t\tthis.detectSocialLogin();\r\n\t\tthis.checkPaymentParams();\r\n\t}\r\n\r\n\tcheckPaymentParams() {\r\n\t\tconst urlSearchParams = new URLSearchParams(window.location.search);\r\n\t\tconst params = Object.fromEntries(urlSearchParams.entries());\r\n\t\tif (params.id != null) {\r\n\t\t\tthis.onComplete(params);\r\n\t\t} else {\r\n\t\t\tthis.load$().pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t).subscribe();\r\n\t\t}\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn combineLatest([CartService.data$()]).pipe(\r\n\t\t\ttap(results => {\r\n\t\t\t\tconst data = results[0];\r\n\t\t\t\tthis.initWithData(data);\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n\tinitWithData(data) {\r\n\t\tthis.errorDelivery = null;\r\n\t\tthis.errorDiscount = null;\r\n\t\tthis.errorPayment = null;\r\n\t\tthis.error = false;\r\n\t\tthis.success = false;\r\n\t\tthis.readyToShip = false;\r\n\t\tthis.estimatedDelivery = null;\r\n\t\tthis.items = null;\r\n\t\tthis.items$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe(items => {\r\n\t\t\tthis.items = items;\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t\tthis.socialBusy = false;\r\n\t\tthis.user = null;\r\n\t\tthis.guest = null;\r\n\t\tthis.shipmentCountryOptions = [];\r\n\t\tthis.countryOptions = [];\r\n\t\tthis.deliveryData = null;\r\n\t\tthis.billingData = null;\r\n\t\tthis.delivery = null;\r\n\t\tthis.discount = null;\r\n\t\tthis.paymentMethod = null;\r\n\t\tconst hasInvoice = RequiredIfValidator(() => Boolean(this.form.value.data.invoice));\r\n\t\tconst hasBilling = RequiredIfValidator(() => Boolean(this.form.value.data.billing));\r\n\t\tconst hasStore = RequiredTrueIfValidator(() => Boolean(this.step == this.steps.Recap && this.checkStoreTerms && this.form.value.store));\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\tstep: this.step,\r\n\t\t\titems: null,\r\n\t\t\tshipmentCountry: new FormControl(114, [Validators.RequiredValidator()]),\r\n\t\t\tuser: null,\r\n\t\t\tguest: null,\r\n\t\t\tdata: new FormGroup({\r\n\t\t\t\tfirstName: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t\tlastName: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t\temail: new FormControl(null, [Validators.RequiredValidator(), Validators.EmailValidator()]),\r\n\t\t\t\ttelephone: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t\taddress: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t\tzipCode: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t\tcity: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t\tprovince: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t\tcountry: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t\tmessage: null,\r\n\t\t\t\tinvoice: null,\r\n\t\t\t\tinvoiceData: new FormGroup({\r\n\t\t\t\t\ttaxNumber: new FormControl(null, [hasInvoice]),\r\n\t\t\t\t\tsdi: new FormControl(null, [hasInvoice]),\r\n\t\t\t\t\tpec: new FormControl(null, [hasInvoice]),\r\n\t\t\t\t}),\r\n\t\t\t\tbilling: null,\r\n\t\t\t\tbillingData: new FormGroup({\r\n\t\t\t\t\tcompany: new FormControl(null, [hasBilling]),\r\n\t\t\t\t\tfirstName: new FormControl(null, [hasBilling]),\r\n\t\t\t\t\tlastName: new FormControl(null, [hasBilling]),\r\n\t\t\t\t\ttelephone: new FormControl(null, [hasBilling]),\r\n\t\t\t\t\taddress: new FormControl(null, [hasBilling]),\r\n\t\t\t\t\tzipCode: new FormControl(null, [hasBilling]),\r\n\t\t\t\t\tcity: new FormControl(null, [hasBilling]),\r\n\t\t\t\t\tprovince: new FormControl(null, [hasBilling]),\r\n\t\t\t\t\tcountry: new FormControl(null, [hasBilling]),\r\n\t\t\t\t}),\r\n\t\t\t\tconditions: new FormControl(null, [Validators.RequiredTrueValidator()]),\r\n\t\t\t\tprivacy: new FormControl(null, [Validators.RequiredTrueValidator()]),\r\n\t\t\t\tnewsletter: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t\tcommercial: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t\tpromotion: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t\t// terms: null,\r\n\t\t\t}),\r\n\t\t\tdeliveryData: null,\r\n\t\t\tbillingData: null,\r\n\t\t\tdeliveryType: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tdelivery: null,\r\n\t\t\tdiscountCode: null,\r\n\t\t\tdiscount: null,\r\n\t\t\tpaymentMethod: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tstores: null,\r\n\t\t\tstore: new FormControl(null, [Validators.RequiredValidator()]),\r\n\r\n\t\t\tstoreTerms: new FormControl(null, [hasStore]),\r\n\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: '',\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tform.changes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe((_) => {\r\n\t\t\tthis.pushChanges();\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t});\r\n\r\n\t\t/*\r\n\t\tUserService.me$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe(user => this.onUser(user));\r\n\t\t*/\r\n\r\n\t\tconst sortCountry = (a, b) => {\r\n\t\t\tif (a.label.toLowerCase() === 'italia') {\r\n\t\t\t\treturn -1;\r\n\t\t\t} else if (b.label.toLowerCase() === 'italia') {\r\n\t\t\t\treturn 1;\r\n\t\t\t} else {\r\n\t\t\t\treturn a.label - b.label;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tlet shipmentCountryOptions = data.shipmentCountry.options.slice();\r\n\t\tshipmentCountryOptions.sort(sortCountry);\r\n\t\tthis.shipmentCountryOptions = shipmentCountryOptions;\r\n\t\tcontrols.shipmentCountry.options = FormService.toSelectOptions(this.shipmentCountryOptions);\r\n\t\tcontrols.data.controls.country.options = FormService.toSelectOptions(this.shipmentCountryOptions);\r\n\r\n\t\tlet countryOptions = data.country.options.slice();\r\n\t\tcountryOptions.sort(sortCountry);\r\n\t\tthis.countryOptions = countryOptions;\r\n\t\tcontrols.data.controls.billingData.controls.country.options = FormService.toSelectOptions(this.countryOptions);\r\n\r\n\t\t/*\r\n\t\tcontrols.deliveryType.options = data.deliveryType.options.slice().map(x => ({\r\n\t\t\tid: x.value,\r\n\t\t\tname: x.label,\r\n\t\t\tabstract: x.abstract,\r\n\t\t\tdescription: x.description,\r\n\t\t\tprice: x.price,\r\n\t\t\tfullPrice: x.fullPrice,\r\n\t\t}));\r\n\t\t*/\r\n\t\tcontrols.paymentMethod.options = data.paymentMethod.options.slice().map(x => ({\r\n\t\t\tid: x.value,\r\n\t\t\tname: x.label,\r\n\t\t\tdescription: x.description,\r\n\t\t\tinfo: x.info,\r\n\t\t\ticons: x.icons,\r\n\t\t}));\r\n\t\tthis.form.patch({\r\n\t\t\tshipmentCountry: controls.shipmentCountry.options[1].id,\r\n\t\t\t// deliveryType: controls.deliveryType.options[0].id,\r\n\t\t\tpaymentMethod: controls.paymentMethod.options[0].id,\r\n\t\t}, true);\r\n\t\tthis.pushChanges();\r\n\r\n\t\tCartService.cart$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe(cart => {\r\n\t\t\tif (cart) {\r\n\t\t\t\tconst step = this.getStepParam();\r\n\t\t\t\tif (step === '1') {\r\n\t\t\t\t\tthis.setStep(CartSteps.Items);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.setStep(cart.step);\r\n\t\t\t\t}\r\n\t\t\t\tthis.guest = cart.guest;\r\n\t\t\t\tthis.deliveryData = cart.deliveryData;\r\n\t\t\t\tthis.billingData = cart.billingData;\r\n\t\t\t\tthis.delivery = cart.delivery;\r\n\t\t\t\tthis.discount = cart.discount;\r\n\t\t\t\tthis.paymentMethod = cart.paymentMethod;\r\n\t\t\t\tif (cart.stores) {\r\n\t\t\t\t\tcontrols.store.options = cart.stores.slice().map(x => ({\r\n\t\t\t\t\t\tid: x.id,\r\n\t\t\t\t\t\tname: x.name,\r\n\t\t\t\t\t\taddress: x.address,\r\n\t\t\t\t\t\tcity: x.city,\r\n\t\t\t\t\t\tcountry: x.country,\r\n\t\t\t\t\t\tdistance: x.distance,\r\n\t\t\t\t\t}));\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.setStep(CartSteps.Items);\r\n\t\t\t}\r\n\t\t\tthis.onPatch(cart, true);\r\n\t\t});\r\n\t}\r\n\r\n\tgetStepParam() {\r\n\t\tconst urlSearchParams = new URLSearchParams(window.location.search);\r\n\t\tconst params = Object.fromEntries(urlSearchParams.entries());\r\n\t\tif (params.step != null) {\r\n\t\t\turlSearchParams.delete('step');\r\n\t\t\tif (window.history.replaceState) {\r\n\t\t\t\t// console.log(window.location, urlSearchParams);\r\n\t\t\t\tconst search = urlSearchParams.toString();\r\n\t\t\t\tconst newUrl = window.location.origin + window.location.pathname + (search !== '' ? '?' + search : search);\r\n\t\t\t\twindow.history.replaceState(null, document.title, newUrl);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn params.step;\r\n\t}\r\n\r\n\tonRevalidate() {\r\n\t\t// console.log('onRevalidate');\r\n\t\tthis.controls.data.controls.invoiceData.controls.taxNumber.statusSubject.next(null);\r\n\t\tthis.controls.data.controls.invoiceData.controls.sdi.statusSubject.next(null);\r\n\t\tthis.controls.data.controls.invoiceData.controls.pec.statusSubject.next(null);\r\n\r\n\t\tthis.controls.data.controls.billingData.controls.company.statusSubject.next(null);\r\n\t\tthis.controls.data.controls.billingData.controls.firstName.statusSubject.next(null);\r\n\t\tthis.controls.data.controls.billingData.controls.lastName.statusSubject.next(null);\r\n\t\tthis.controls.data.controls.billingData.controls.telephone.statusSubject.next(null);\r\n\t\tthis.controls.data.controls.billingData.controls.address.statusSubject.next(null);\r\n\t\tthis.controls.data.controls.billingData.controls.zipCode.statusSubject.next(null);\r\n\t\tthis.controls.data.controls.billingData.controls.city.statusSubject.next(null);\r\n\t\tthis.controls.data.controls.billingData.controls.province.statusSubject.next(null);\r\n\t\tthis.controls.data.controls.billingData.controls.country.statusSubject.next(null);\r\n\t}\r\n\r\n\ttouchForm() {\r\n\t\tthis.form.touched = true;\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst firstInvalidInput = Array.prototype.slice.call(node.querySelectorAll('.invalid')).find((x) => x.hasAttribute('[control]'));\r\n\t\tif (firstInvalidInput) {\r\n\t\t\tLocomotiveScrollService.scrollTo(firstInvalidInput, { offset: -260, duration: 0, disableLerp: true });\r\n\t\t}\r\n\t}\r\n\r\n\tsetStep(step) {\r\n\t\tthis.step = step;\r\n\t\tswitch (step) {\r\n\t\t\tcase CartSteps.Items:\r\n\t\t\t\tGtmService.push({ 'event': 'step checkout', 'ecommstep': 'Carrello' });\r\n\t\t\t\tbreak;\r\n\t\t\tcase CartSteps.Data:\r\n\t\t\t\tGtmService.push({ 'event': 'step checkout', 'ecommstep': 'Dati Utente' });\r\n\t\t\t\tbreak;\r\n\t\t\tcase CartSteps.Delivery:\r\n\t\t\t\tGtmService.push({ 'event': 'step checkout', 'ecommstep': 'Consegna' });\r\n\t\t\t\tbreak;\r\n\t\t\tcase CartSteps.Recap:\r\n\t\t\t\tGtmService.push({ 'event': 'step checkout', 'ecommstep': 'Riepilogo' });\r\n\t\t\t\tbreak;\r\n\t\t\tcase CartSteps.Payment:\r\n\t\t\t\tGtmService.push({ 'event': 'step checkout', 'ecommstep': 'Pagamento' });\r\n\t\t\t\tbreak;\r\n\t\t\tcase CartSteps.Complete:\r\n\t\t\t\tconst totalPrice = NumberPipe.transform(this.totalPrice, { style: 'currency', currency: 'EUR' });\r\n\t\t\t\tGtmService.push({ 'event': 'step checkout', 'ecommstep': 'Conferma Ordine', 'revenue': totalPrice });\r\n\t\t\t\tbreak;\r\n\t\t\tcase CartSteps.Error:\r\n\t\t\t\tGtmService.push({ 'event': 'step checkout', 'ecommstep': 'Errore' });\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tonBack() {\r\n\t\tthis.setStep(this.step - 1);\r\n\t\tlet patch = null;\r\n\t\tif (this.step === CartSteps.Items) {\r\n\t\t\tthis.user = null;\r\n\t\t\tthis.guest = false;\r\n\t\t\tpatch = { user: null, guest: false };\r\n\t\t}\r\n\t\tthis.onPatch(patch);\r\n\t}\r\n\r\n\tonNext(patch) {\r\n\t\tthis.form.touched = false;\r\n\t\tthis.setStep(this.step + 1);\r\n\t\tthis.onPatch(patch);\r\n\t}\r\n\r\n\tonPatch(patch = {}, skipUpdate = false) {\r\n\t\tthis.form.patch(Object.assign({}, patch, { step: this.step }));\r\n\t\tswitch (this.step) {\r\n\t\t\tcase CartSteps.Delivery:\r\n\t\t\t\tthis.busy = true;\r\n\t\t\t\tthis.errorDelivery = null;\r\n\t\t\t\tthis.getDeliveryType$().pipe(\r\n\t\t\t\t\tfirst(),\r\n\t\t\t\t\tfinalize(_ => {\r\n\t\t\t\t\t\tthis.busy = false;\r\n\t\t\t\t\t\tthis.pushChanges();\r\n\t\t\t\t\t}),\r\n\t\t\t\t).subscribe(_ => {\r\n\t\t\t\t\tthis.onAfterPatch(skipUpdate);\r\n\t\t\t\t}, errorDelivery => {\r\n\t\t\t\t\t// console.log('errorDelivery', errorDelivery);\r\n\t\t\t\t\tthis.errorDelivery = errorDelivery;\r\n\t\t\t\t\tthis.onAfterPatch(true);\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase CartSteps.Recap:\r\n\t\t\t\tthis.controls.storeTerms.statusSubject.next(null);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthis.onAfterPatch(skipUpdate);\r\n\t\t}\r\n\t}\r\n\r\n\tonAfterPatch(skipUpdate = false) {\r\n\t\tthis.pushChanges();\r\n\t\tLocomotiveScrollService.update();\r\n\t\tconst target = document.querySelector('.section--breadcrumb');\r\n\t\tLocomotiveScrollService.scrollTo(target, { offset: -130, duration: 0, disableLerp: true });\r\n\t\tif (!skipUpdate) {\r\n\t\t\tCartService.setCart(this.form.value);\r\n\t\t}\r\n\t}\r\n\r\n\t// 1. CartSteps.Items\r\n\tonItems(_) {\r\n\t\tUserService.me$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe(user => {\r\n\t\t\tthis.onUser(user);\r\n\t\t\tthis.onNext({\r\n\t\t\t\titems: this.items,\r\n\t\t\t});\r\n\t\t});\r\n\t\t/*\r\n\t\tthis.onNext({\r\n\t\t\titems: this.items,\r\n\t\t});\r\n\t\t*/\r\n\t}\r\n\r\n\tonIncrement(item) {\r\n\t\tCartMiniService.incrementItem$(item).pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tonDecrement(item) {\r\n\t\tCartMiniService.decrementItem$(item).pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tonRemove(item) {\r\n\t\tCartMiniService.removeItem$(item).pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tonEdit(item) {\r\n\t\t// console.log('CartComponent.onEdit', item);\r\n\t\tif (environment.flags.production) {\r\n\t\t\twindow.location.href = `${item.url}/config?productId=${item.id}&code=${item.code}${item.showefy ? `&sl=${item.showefy.product_link.split('&sl=')[1]}` : ''}`;\r\n\t\t} else {\r\n\t\t\twindow.location.href = `${environment.slug.configureProduct}?productId=${item.id}&code=${item.code}${item.showefy ? `&sl=${item.showefy.product_link.split('&sl=')[1]}` : ''}`;\r\n\t\t}\r\n\t}\r\n\r\n\titems$() {\r\n\t\treturn CartMiniService.items$().pipe(\r\n\t\t\tswitchMap(items => {\r\n\t\t\t\tif (items.length) {\r\n\t\t\t\t\treturn CartService.estimatedDelivery$({ items }).pipe(\r\n\t\t\t\t\t\tmap(data => {\r\n\t\t\t\t\t\t\tconst now = new Date();\r\n\t\t\t\t\t\t\tconst days = Math.floor((new Date(data.estimatedDelivery) - now) / (1000 * 3600 * 24));\r\n\t\t\t\t\t\t\tif (days > 0) {\r\n\t\t\t\t\t\t\t\tthis.readyToShip = false;\r\n\t\t\t\t\t\t\t\tthis.estimatedDelivery = data.estimatedDelivery;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.readyToShip = true;\r\n\t\t\t\t\t\t\t\tthis.estimatedDelivery = null;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn items;\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.estimatedDelivery = null;\r\n\t\t\t\t\treturn of(items);\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n\t// 2. CartSteps.Data\r\n\tonModalSignIn() {\r\n\t\tModalService.open$({ src: environment.template.modal.userModal, data: { view: 1 } }).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(event => {\r\n\t\t\t// console.log('CartComponent.onModalSignIn', event);\r\n\t\t\tif (event instanceof ModalResolveEvent) {\r\n\t\t\t\tthis.onUser(event.data);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tonModalSignUp(me) {\r\n\t\tModalService.open$({ src: environment.template.modal.userModal, data: { view: 2, me } }).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(event => {\r\n\t\t\t// console.log('CartComponent.onModalSignUp', event);\r\n\t\t\tif (event instanceof ModalResolveEvent) {\r\n\t\t\t\tthis.onUser(event.data);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tonUser(user) {\r\n\t\t// console.log('CartComponent.onUser', user);\r\n\t\tif (user) {\r\n\t\t\tthis.user = user;\r\n\t\t\tthis.guest = false;\r\n\t\t\tthis.onPatch({\r\n\t\t\t\tuser: user,\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tfirstName: user.firstName,\r\n\t\t\t\t\tlastName: user.lastName,\r\n\t\t\t\t\temail: user.email,\r\n\t\t\t\t\t// telephone: null,\r\n\t\t\t\t\t// address: null,\r\n\t\t\t\t\t// zipCode: null,\r\n\t\t\t\t\tcity: user.city,\r\n\t\t\t\t\t// province: null,\r\n\t\t\t\t\tcountry: user.country,\r\n\t\t\t\t\t// privacy: user.privacy,\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tonGuest() {\r\n\t\tthis.user = null;\r\n\t\tthis.guest = true;\r\n\t\tthis.onPatch({ user: null, guest: true });\r\n\t}\r\n\r\n\tonFacebookLogout() {\r\n\t\tFacebookService.logout$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tonSocialLogin(social) {\r\n\t\tswitch (social) {\r\n\t\t\tcase 'facebook':\r\n\t\t\t\tthis.onFacebookLogin();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'google':\r\n\t\t\t\tthis.onGoogleLogin();\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'linkedin':\r\n\t\t\t\tthis.onLinkedinLogin();\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn;\r\n\t}\r\n\r\n\tonFacebookLogin() {\r\n\t\t// console.log('onFacebookLogin');\r\n\t\tthis.socialBusy = 'facebook';\r\n\t\tlet socialMe;\r\n\t\tfunction mapMe(data) {\r\n\t\t\t// console.log(data);\r\n\t\t\t/*\r\n\t\t\tauthResponse:\r\n\t\t\t\taccessToken: string\r\n\t\t\t\tdata_access_expiration_time: 1633594543\r\n\t\t\t\texpiresIn: 5164299\r\n\t\t\t\tgraphDomain: \"facebook\"\r\n\t\t\t\tsignedRequest: string\r\n\t\t\t\tuserID: string\r\n\t\t\temail: string\r\n\t\t\tfacebookToken: string\r\n\t\t\tfirst_name: string\r\n\t\t\tid: string\r\n\t\t\tlast_name: string\r\n\t\t\tname: string\r\n\t\t\tpicture:\r\n\t\t\t\tdata:\r\n\t\t\t\t\theight: 50\r\n\t\t\t\t\tis_silhouette: false\r\n\t\t\t\t\turl: string\r\n\t\t\t\t\twidth: 50\r\n\t\t\t*/\r\n\t\t\tconst me = {};\r\n\t\t\tif (data) {\r\n\t\t\t\tme.firstName = data.first_name;\r\n\t\t\t\tme.lastName = data.last_name;\r\n\t\t\t\tme.email = data.email;\r\n\t\t\t\tme.socialPicture = data.picture.data.url;\r\n\t\t\t\tme.socialType = 'facebook';\r\n\t\t\t\tme.socialId = data.id;\r\n\t\t\t\tme.socialToken = data.facebookToken;\r\n\t\t\t\tme.socialTokenExpiresAt = data.authResponse.data_access_expiration_time;\r\n\t\t\t}\r\n\t\t\t// console.log('CartComponent.onFacebookLogin.mapMe', me);\r\n\t\t\treturn me;\r\n\t\t}\r\n\t\tFacebookService.me$().pipe(\r\n\t\t\tfirst(),\r\n\t\t\ttap(me => socialMe = me),\r\n\t\t\tswitchMap(me => UserService.tryFacebook$(me)),\r\n\t\t\tfinalize(() => this.socialBusy = false),\r\n\t\t).subscribe(user => {\r\n\t\t\tif (user) {\r\n\t\t\t\tthis.onUser(user);\r\n\t\t\t} else {\r\n\t\t\t\tconst me = mapMe(socialMe);\r\n\t\t\t\tthis.onModalSignUp(me);\r\n\t\t\t}\r\n\t\t}, error => {\r\n\t\t\tconsole.log('CartComponent.onFacebookLogin.error', error);\r\n\t\t\tconst me = mapMe(socialMe);\r\n\t\t\tthis.onModalSignUp(me);\r\n\t\t});\r\n\t}\r\n\r\n\tonGoogleLogin() {\r\n\t\tthis.socialBusy = 'google';\r\n\t\tlet socialMe;\r\n\t\tfunction mapMe(data) {\r\n\t\t\t// console.log(data);\r\n\t\t\t/*\r\n\t\t\tauthResponse:\r\n\t\t\t\taccess_token: string\r\n\t\t\t\texpires_at: 1625838392809\r\n\t\t\t\texpires_in: 3599\r\n\t\t\t\tfirst_issued_at: 1625834793809\r\n\t\t\t\tid_token: string\r\n\t\t\t\tidpId: \"google\"\r\n\t\t\t\tlogin_hint: string\r\n\t\t\t\tscope: \"email profile openid https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile\"\r\n\t\t\t\tsession_state: {extraQueryParams: {}}\r\n\t\t\t\ttoken_type: \"Bearer\"\r\n\t\t\temail: string\r\n\t\t\tfirstName: string\r\n\t\t\tgoogleToken: string\r\n\t\t\tid: string\r\n\t\t\tlastName: string\r\n\t\t\tname: string\r\n\t\t\tpicture: string\r\n\t\t\t*/\r\n\t\t\tconst me = {};\r\n\t\t\tif (data) {\r\n\t\t\t\tme.firstName = data.firstName;\r\n\t\t\t\tme.lastName = data.lastName;\r\n\t\t\t\tme.email = data.email;\r\n\t\t\t\tme.socialPicture = data.picture;\r\n\t\t\t\tme.socialType = 'google';\r\n\t\t\t\tme.socialId = data.id;\r\n\t\t\t\tme.socialToken = data.googleToken;\r\n\t\t\t\tme.socialTokenExpiresAt = data.authResponse.expires_at;\r\n\t\t\t}\r\n\t\t\t// console.log('CartComponent.onGoogleLogin.mapMe', me);\r\n\t\t\treturn me;\r\n\t\t}\r\n\t\tGoogleService.me$().pipe(\r\n\t\t\tfirst(),\r\n\t\t\ttap(me => socialMe = me),\r\n\t\t\tswitchMap(me => UserService.tryGoogle$(me)),\r\n\t\t\tfinalize(() => this.socialBusy = false),\r\n\t\t).subscribe(user => {\r\n\t\t\tif (user) {\r\n\t\t\t\tthis.onUser(user);\r\n\t\t\t} else {\r\n\t\t\t\tconst me = mapMe(socialMe);\r\n\t\t\t\tthis.onModalSignUp(me);\r\n\t\t\t}\r\n\t\t}, error => {\r\n\t\t\tconsole.log('CartComponent.onGoogleLogin.error', error);\r\n\t\t\tconst me = mapMe(socialMe);\r\n\t\t\tthis.onModalSignUp(me);\r\n\t\t});\r\n\t}\r\n\r\n\tonLinkedinLogin() {\r\n\t\tLinkedinService.linkedin$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe(token => {\r\n\t\t\t// console.log('CartComponent.onLinkedinLogin', token);\r\n\t\t\tthis.onModalSignUp({ firstName: 'Luca' });\r\n\t\t}, error => {\r\n\t\t\tconsole.log('CartComponent.onLinkedinLogin.error', error);\r\n\t\t\tconst me = mapMe(socialMe);\r\n\t\t\tthis.onModalSignUp(me);\r\n\t\t});\r\n\t}\r\n\r\n\tdetectSocialLogin() {\r\n\t\tif (window.name === 'linkedin' && window.opener) {\r\n\t\t\tconst urlSearchParams = new URLSearchParams(window.location.search);\r\n\t\t\tconst params = Object.fromEntries(urlSearchParams.entries());\r\n\t\t\t// console.log('window', window.name, params);\r\n\t\t\tif (typeof window.opener.onSocialCallback === 'function') {\r\n\t\t\t\twindow.opener.onSocialCallback(window.name, params);\r\n\t\t\t}\r\n\t\t\tself.close();\r\n\t\t}\r\n\t}\r\n\r\n\tonData(_) {\r\n\t\tconst form = this.form;\r\n\t\t// const controls = this.controls;\r\n\t\t// console.log('CartComponent.onData', form.controls.data.valid);\r\n\t\tif (form.controls.data.valid) {\r\n\t\t\tconst deliveryData = form.value.data;\r\n\t\t\tconst deliveryCountry = this.getCountryById(deliveryData.country);\r\n\t\t\tconst onGeocoder = (latitude = null, longitude = null) => {\r\n\t\t\t\tdeliveryData.latitude = latitude;\r\n\t\t\t\tdeliveryData.longitude = longitude;\r\n\t\t\t\tthis.deliveryData = Object.assign({}, deliveryData, {\r\n\t\t\t\t\tcountry: deliveryCountry,\r\n\t\t\t\t});\r\n\t\t\t\tconst billingData = (form.value.data.billing ? form.value.data.billingData : form.value.data);\r\n\t\t\t\tconst billingCountry = this.getCountryById(billingData.country);\r\n\t\t\t\tthis.billingData = Object.assign({}, billingData, {\r\n\t\t\t\t\tcountry: billingCountry,\r\n\t\t\t\t});\r\n\t\t\t\t// console.log('CartComponent.onData.onGeocoder', latitude, longitude);\r\n\t\t\t\tthis.onNext({ deliveryData, billingData });\r\n\t\t\t}\r\n\t\t\tlet latitude = null, longitude = null;\r\n\t\t\tGoogleMapsService.geocode$({ address: `${deliveryData.address}, ${deliveryData.zipCode} ${deliveryData.city} ${deliveryCountry.name}` }).pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t).subscribe(results => {\r\n\t\t\t\tif (results.length) {\r\n\t\t\t\t\t// console.log('CartComponent.onData.geocode', results);\r\n\t\t\t\t\tconst location = results[0].geometry.location;\r\n\t\t\t\t\tlatitude = location.lat();\r\n\t\t\t\t\tlongitude = location.lng();\r\n\t\t\t\t}\r\n\t\t\t\tonGeocoder(latitude, longitude);\r\n\t\t\t}, error => {\r\n\t\t\t\tonGeocoder(latitude, longitude);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.touchForm();\r\n\t\t}\r\n\t}\r\n\r\n\tgetCountryById(countryId) {\r\n\t\treturn FormService.toSelectOptions(this.countryOptions).find(x => x.id === countryId);\r\n\t}\r\n\r\n\ttestData() {\r\n\t\tconst form = this.form;\r\n\t\tconst controls = this.controls;\r\n\t\tconst country = controls.data.controls.country.options.length > 1 ? controls.data.controls.country.options[1].id : null;\r\n\t\tform.patch({\r\n\t\t\tdata: {\r\n\t\t\t\tfirstName: 'Jhon',\r\n\t\t\t\tlastName: 'Appleseed',\r\n\t\t\t\temail: 'jhonappleseed@gmail.com',\r\n\t\t\t\ttelephone: '0721 411112',\r\n\t\t\t\taddress: 'Strada della Campanara, 15',\r\n\t\t\t\tzipCode: '61122',\r\n\t\t\t\tcity: 'Pesaro',\r\n\t\t\t\tprovince: 'Pesaro',\r\n\t\t\t\tcountry: country,\r\n\t\t\t\tmessage: 'Hi!',\r\n\t\t\t\tconditions: true,\r\n\t\t\t\tprivacy: true,\r\n\t\t\t\tnewsletter: false,\r\n\t\t\t\tcommercial: false,\r\n\t\t\t\tpromotion: false,\r\n\t\t\t\t// terms: false,\r\n\t\t\t},\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: ''\r\n\t\t});\r\n\t}\r\n\r\n\tresetData() {\r\n\t\tconst data = this.controls.data;\r\n\t\tdata.reset();\r\n\t}\r\n\r\n\t// 3. CartSteps.Delivery\r\n\tonDelivery(_) {\r\n\t\tconst form = this.form;\r\n\t\tconst controls = this.controls;\r\n\t\tconst delivery = controls.deliveryType.options.find(x => x.id === form.value.deliveryType);\r\n\t\tthis.delivery = delivery;\r\n\t\t// console.log('CartComponent.onDelivery', form.value);\r\n\t\tCartService.getStores$(form.value).pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe(stores => {\r\n\t\t\tcontrols.stores.value = stores;\r\n\t\t\tcontrols.store.options = stores.slice().map(x => ({\r\n\t\t\t\tid: x.id,\r\n\t\t\t\tname: x.name,\r\n\t\t\t\taddress: x.address,\r\n\t\t\t\tcity: x.city,\r\n\t\t\t\tcountry: x.country,\r\n\t\t\t\tdistance: x.distance,\r\n\t\t\t}));\r\n\t\t\tconst store = stores[0];\r\n\t\t\tconst storeId = store ? store.id : null;\r\n\t\t\tthis.onNext({ stores, store: storeId, delivery });\r\n\t\t});\r\n\t}\r\n\r\n\tgetDeliveryType$() {\r\n\t\treturn CartService.getDeliveryType$(this.form.value).pipe(\r\n\t\t\ttap(deliveryTypeOptions => {\r\n\t\t\t\tconst controls = this.controls;\r\n\t\t\t\tcontrols.deliveryType.options = deliveryTypeOptions.slice().map(x => ({\r\n\t\t\t\t\tid: x.value,\r\n\t\t\t\t\tname: x.label,\r\n\t\t\t\t\tabstract: x.abstract,\r\n\t\t\t\t\tdescription: x.description,\r\n\t\t\t\t\tprice: x.price,\r\n\t\t\t\t\tfullPrice: x.fullPrice,\r\n\t\t\t\t}));\r\n\t\t\t\tthis.form.patch(Object.assign({}, { deliveryType: controls.deliveryType.options[0].id }), true);\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n\t// 4. CartSteps.Recap\r\n\tonDiscountCode(_) {\r\n\t\tconst form = this.form;\r\n\t\t// console.log('CartComponent.onDelivery', form.value);\r\n\t\tthis.errorDiscount = null;\r\n\t\t//CartService.getDiscount$({ discountCode: form.value.discountCode }).pipe(\r\n\t\tCartService.getDiscount$(form.value).pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe(discount => {\r\n\t\t\tthis.discount = discount;\r\n\t\t\tthis.onPatch({ discount });\r\n\t\t}, errorDiscount => {\r\n\t\t\tthis.errorDiscount = errorDiscount;\r\n\t\t});\r\n\t}\r\n\r\n\tonRecap(_) {\r\n\t\tconst form = this.form;\r\n\t\t// console.log('CartComponent.onRecap', form.valid);\r\n\t\tif (form.valid) {\r\n\t\t\tthis.onNext();\r\n\t\t} else {\r\n\t\t\tthis.touchForm();\r\n\t\t}\r\n\t}\r\n\r\n\tonTimetableToggle(event) {\r\n\t\tif (this.selectedStore) {\r\n\t\t\tthis.selectedStore.showTimetable = !this.selectedStore.showTimetable;\r\n\t\t\tthis.pushChanges();\r\n\t\t}\r\n\t}\r\n\r\n\ttestRecap() {\r\n\t\tthis.form.patch({\r\n\t\t\tstoreTerms: true,\r\n\t\t});\r\n\t}\r\n\r\n\tresetRecap() {\r\n\t\tthis.controls.storeTerms.reset();\r\n\t}\r\n\r\n\t// 5. CartSteps.Payment\r\n\tonPayment(_) {\r\n\t\tconst form = this.form;\r\n\t\tconst controls = this.controls;\r\n\t\tconst paymentMethod = controls.paymentMethod.options.find(x => x.id === form.value.paymentMethod);\r\n\t\tthis.paymentMethod = paymentMethod;\r\n\t\tif (form.valid) {\r\n\t\t\t// console.log('CartComponent.onPayment', form.value);\r\n\t\t\tCartService.doPayment$(form.value).pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t).subscribe(response => {\r\n\t\t\t\tif (environment.flags.production) {\r\n\t\t\t\t\twindow.location.href = response.redirectUrl;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.onComplete({ id: '444', mp: '5', result: '-1', transactionId: 'WEBSOLUTE27' }); // !!! only on development\r\n\t\t\t\t\tthis.onAfterPatch(true);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t// 6. CartSteps.Complete\r\n\tonComplete(params) {\r\n\t\t// ?id=444&mp=5&result=1&transactionid=WEBSOLUTE27\r\n\t\tthis.setStep(CartSteps.Complete);\r\n\t\tthis.success = params.result === '1';\r\n\t\tthis.error = params.result === '-1';\r\n\t\tthis.paymentMethodId = params.mp;\r\n\t\tthis.transactionId = params.transactionId;\r\n\t\tthis.orderId = params.id;\r\n\t\tthis.order = null;\r\n\t\tthis.hasPendingCart = CartService.hasPendingCart();\r\n\t\tif (this.success) {\r\n\t\t\tthis.orderBusy = true;\r\n\t\t\tOrdersService.detail$(this.orderId).pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t\ttap(order => {\r\n\t\t\t\t\tthis.order = order;\r\n\t\t\t\t}),\r\n\t\t\t\tfinalize(_ => {\r\n\t\t\t\t\tthis.orderBusy = false;\r\n\t\t\t\t\tthis.pushChanges();\r\n\t\t\t\t}),\r\n\t\t\t).subscribe();\r\n\t\t}\r\n\t}\r\n\r\n\tonOpenOrder(orderId) {\r\n\t\tModalService.open$({ src: environment.template.modal.ordersModal, data: { orderId: orderId } }).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(event => {\r\n\t\t\tconsole.log('CartComponent.onOpenOrder', event);\r\n\t\t});\r\n\t}\r\n\r\n\tonRetry() {\r\n\t\tthis.error = false;\r\n\t\tthis.success = false;\r\n\t\tthis.errorPayment = null;\r\n\t\tthis.paymentMethod = null;\r\n\t\tconst items = CartMiniService.resumePendingItems();\r\n\t\tconst cart = CartService.resumePendingCart();\r\n\t\tif (cart) {\r\n\t\t\tthis.load$().pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t).subscribe();\r\n\t\t}\r\n\t\t// this.setStep(CartSteps.Payment);\r\n\t\t// this.onPatch(cart);\r\n\t}\r\n}\r\n\r\nCartComponent.meta = {\r\n\tselector: '[cart]',\r\n\tinputs: ['checkStoreTerms'],\r\n};\r\n","import { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class CataloguesService {\r\n\r\n\tstatic all$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/catalogues/all');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/catalogues/all.json');\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { combineLatest } from 'rxjs';\r\nimport { FiltersComponent } from '../../shared/filters/filters.component';\r\nimport { CataloguesService } from './catalogues.service';\r\n\r\nexport class CataloguesComponent extends FiltersComponent {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn combineLatest([\r\n\t\t\tCataloguesService.all$(),\r\n\t\t]);\r\n\t}\r\n\r\n\tdoFilterItem(key, item, value) {\r\n\t\tswitch (key) {\r\n\t\t\tdefault:\r\n\t\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nCataloguesComponent.meta = {\r\n\tselector: '[catalogues]',\r\n};\r\n","import { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class ContactsService {\r\n\r\n\tstatic data$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/contacts/data');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/contacts/data.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic submit$(payload) {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.post$('/contacts/submit', payload);\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/contacts/submit.json');\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { Component } from 'rxcomp';\r\nimport { FormControl, FormGroup, Validators } from 'rxcomp-form';\r\nimport { first, takeUntil, tap } from 'rxjs/operators';\r\nimport { GtmService } from '../../common/gtm/gtm.service';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { FormService } from '../../controls/form.service';\r\nimport RequiredIfValidator from '../../controls/required-if.validator';\r\nimport { ContactsService } from './contacts.service';\r\n\r\nexport class ContactsComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.error = null;\r\n\t\tthis.success = false;\r\n\t\tconst hasNewsletter = RequiredIfValidator(() => Boolean(this.form.value.newsletter));\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\tfirstName: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tlastName: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\temail: new FormControl(null, [Validators.RequiredValidator(), Validators.EmailValidator()]),\r\n\t\t\ttelephone: new FormControl(null),\r\n\t\t\tcountry: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tcity: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tmessage: new FormControl(null),\r\n\t\t\tprivacy: new FormControl(null, [Validators.RequiredTrueValidator()]),\r\n\t\t\tnewsletter: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tcommercial: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tpromotion: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tnewsletterLanguage: new FormControl(null, [hasNewsletter]),\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: '',\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tform.changes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe((_) => {\r\n\t\t\tthis.pushChanges();\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t});\r\n\t\tthis.load$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn ContactsService.data$().pipe(\r\n\t\t\ttap(data => {\r\n\t\t\t\tconst controls = this.controls;\r\n\t\t\t\tcontrols.country.options = FormService.toSelectOptions(data.country.options);\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\ttest() {\r\n\t\tconst form = this.form;\r\n\t\tconst controls = this.controls;\r\n\t\tconst country = controls.country.options.length > 1 ? controls.country.options[1].id : null;\r\n\t\tform.patch({\r\n\t\t\tfirstName: 'Jhon',\r\n\t\t\tlastName: 'Appleseed',\r\n\t\t\temail: 'jhonappleseed@gmail.com',\r\n\t\t\ttelephone: '0721 411112',\r\n\t\t\tcountry: country,\r\n\t\t\tcity: 'Pesaro',\r\n\t\t\tmessage: 'Hi!',\r\n\t\t\tprivacy: true,\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: ''\r\n\t\t});\r\n\t}\r\n\r\n\treset() {\r\n\t\tconst form = this.form;\r\n\t\tform.reset();\r\n\t}\r\n\r\n\tonSubmit(model) {\r\n\t\tconst form = this.form;\r\n\t\tconsole.log('ContactsComponent.onSubmit', form.value);\r\n\t\t// console.log('ContactsComponent.onSubmit', 'form.valid', valid);\r\n\t\tif (form.valid) {\r\n\t\t\t// console.log('ContactsComponent.onSubmit', form.value);\r\n\t\t\tform.submitted = true;\r\n\t\t\tContactsService.submit$(form.value).pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t).subscribe(_ => {\r\n\t\t\t\tthis.success = true;\r\n\t\t\t\tform.reset();\r\n\t\t\t\tGtmService.push({\r\n\t\t\t\t\t'event': \"Contact\",\r\n\t\t\t\t\t'form_name': \"Contatti\"\r\n\t\t\t\t});\r\n\t\t\t\tif (form.value.newsletter) {\r\n\t\t\t\t\tGtmService.push({\r\n\t\t\t\t\t\t'event': \"ContactNewsletter\",\r\n\t\t\t\t\t\t'form_name': \"ContattiNewsletter\"\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}, error => {\r\n\t\t\t\tconsole.log('ContactsComponent.error', error);\r\n\t\t\t\tthis.error = error;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t\tLocomotiveScrollService.update();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tform.touched = true;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nContactsComponent.meta = {\r\n\tselector: '[contacts]',\r\n};\r\n","import { map } from 'rxjs/operators';\r\nimport { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class DealersService {\r\n\r\n\tstatic all$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/dealers/all').pipe(\r\n\t\t\t\tmap(items => items.sort((a, b) => {\r\n\t\t\t\t\treturn b.regions.length - a.regions.length;\r\n\t\t\t\t})),\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/dealers/all.json').pipe(\r\n\t\t\t\tmap(items => items.sort((a, b) => {\r\n\t\t\t\t\treturn b.regions.length - a.regions.length;\r\n\t\t\t\t})),\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic filters$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/dealers/filters');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/dealers/filters.json');\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { combineLatest } from 'rxjs';\r\nimport { FiltersComponent } from '../../shared/filters/filters.component';\r\nimport { DealersService } from './dealers.service';\r\n\r\nexport class DealersComponent extends FiltersComponent {\r\n\r\n\tload$() {\r\n\t\treturn combineLatest([\r\n\t\t\tDealersService.all$(),\r\n\t\t\tDealersService.filters$(),\r\n\t\t]);\r\n\t}\r\n\r\n\tdoFilterItem(key, item, value) {\r\n\t\tswitch (key) {\r\n\t\t\tcase 'country':\r\n\t\t\t\treturn item.countries && item.countries.find(x => x.value === value);\r\n\t\t\tcase 'search':\r\n\t\t\t\treturn item.name.toLowerCase().indexOf(value.toLowerCase()) !== -1 ||\r\n\t\t\t\t\t// item.address.toLowerCase().indexOf(value.toLowerCase()) !== -1 ||\r\n\t\t\t\t\t(item.city && item.city.toLowerCase().indexOf(value.toLowerCase()) !== -1) ||\r\n\t\t\t\t\t(item.countries && item.countries.find(x => x.label.toLowerCase().indexOf(value.toLowerCase()) !== -1))\r\n\t\t\tdefault:\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nDealersComponent.meta = {\r\n\tselector: '[dealers]',\r\n};\r\n","import { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class DesignersService {\r\n\r\n\tstatic all$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/designers/all');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/designers/all.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic filters$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/designers/filters');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/designers/filters.json');\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { combineLatest } from 'rxjs';\r\nimport { FiltersComponent } from '../../shared/filters/filters.component';\r\nimport { DesignersService } from './designers.service';\r\n\r\nexport class DesignersComponent extends FiltersComponent {\r\n\r\n\tload$() {\r\n\t\treturn combineLatest([\r\n\t\t\tDesignersService.all$(),\r\n\t\t\tDesignersService.filters$(),\r\n\t\t]);\r\n\t}\r\n\r\n\tdoFilterItem(key, item, value) {\r\n\t\tswitch (key) {\r\n\t\t\tcase 'category':\r\n\t\t\t\treturn item.category.id === value;\r\n\t\t\tcase 'search':\r\n\t\t\t\treturn item.name.toLowerCase().indexOf(value.toLowerCase()) !== -1;\r\n\t\t\tdefault:\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nDesignersComponent.meta = {\r\n\tselector: '[designers]',\r\n};\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { ModalOutletComponent } from '../../common/modal/modal-outlet.component';\r\nimport { ModalService } from '../../common/modal/modal.service';\r\n\r\nexport class GenericModalComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tconst { parentInstance } = getContext(this);\r\n\t\tif (parentInstance instanceof ModalOutletComponent) {\r\n\t\t\tconst data = parentInstance.modal.data;\r\n\t\t\tthis.data = data;\r\n\t\t}\r\n\t\tLocomotiveScrollService.stop();\r\n\t}\r\n\r\n\tonClose() {\r\n\t\tModalService.reject();\r\n\t}\r\n\r\n\tonDestroy() {\r\n\t\tLocomotiveScrollService.start();\r\n\t}\r\n}\r\n\r\nGenericModalComponent.meta = {\r\n\tselector: '[generic-modal]'\r\n};\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { ModalOutletComponent } from '../../common/modal/modal-outlet.component';\r\nimport { ModalService } from '../../common/modal/modal.service';\r\n\r\nexport class MagazineRequestModalComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tconst { parentInstance } = getContext(this);\r\n\t\tif (parentInstance instanceof ModalOutletComponent) {\r\n\t\t\tconst data = parentInstance.modal.data;\r\n\t\t\t// console.log('MagazineRequestModalComponent.onInit', data);\r\n\t\t}\r\n\t\tLocomotiveScrollService.stop();\r\n\t}\r\n\r\n\tonClose() {\r\n\t\tModalService.reject();\r\n\t}\r\n\r\n\tonDestroy() {\r\n\t\tLocomotiveScrollService.start();\r\n\t}\r\n}\r\n\r\nMagazineRequestModalComponent.meta = {\r\n\tselector: '[magazine-request-modal]'\r\n};\r\n","import { Component } from 'rxcomp';\r\nimport { takeUntil } from 'rxjs/operators';\r\nimport { ModalService } from '../../common/modal/modal.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class MagazineRequestPropositionComponent extends Component {\r\n\r\n\tonOpen() {\r\n\t\tModalService.open$({ src: environment.template.modal.magazineRequestModal, data: {} }).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(event => {\r\n\t\t\tconsole.log('MagazineRequestPropositionComponent.onOpen', event);\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\nMagazineRequestPropositionComponent.meta = {\r\n\tselector: '[magazine-request-proposition]',\r\n};\r\n","import { FormValidator } from 'rxcomp-form';\r\n\r\n/**\r\n * a phone number pattern validator\r\n */\r\nexport function PhoneNumberValidator() {\r\n\tconst regex = /^(\\+\\d{1,2}){1}[\\s|-]?[(]?(\\d+)[\\)]?[\\s|-]?(\\d+)?$/;\r\n\treturn new FormValidator(function(value, params) {\r\n\t\tif (!value) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn regex.test(value) ? null : { phoneNumber: true };\r\n\t});\r\n}\r\n","import { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class MagazineRequestService {\r\n\r\n\tstatic data$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/magazine-request/data');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/magazine-request/data.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic submit$(payload) {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.post$('/magazine-request/submit', payload);\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/magazine-request/submit.json');\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { Component } from 'rxcomp';\r\nimport { FormControl, FormGroup, Validators } from 'rxcomp-form';\r\nimport { first, takeUntil, tap } from 'rxjs/operators';\r\nimport { GtmService } from '../../common/gtm/gtm.service';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { FormService } from '../../controls/form.service';\r\nimport { PhoneNumberValidator } from '../../controls/phone-number.validator';\r\nimport RequiredIfValidator from '../../controls/required-if.validator';\r\nimport { MagazineRequestService } from './magazine-request.service';\r\n\r\nexport class MagazineRequestComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.response = null;\r\n\t\tthis.error = null;\r\n\t\tthis.success = false;\r\n\t\tconst isItaly = RequiredIfValidator(() => Boolean(this.form.value.country === 114));\r\n\t\tconst hasPrintedCopy = RequiredIfValidator(() => Boolean(this.form.value.printedCopy));\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\tmagazine: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t//\r\n\t\t\tfirstName: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tlastName: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\temail: new FormControl(null, [Validators.RequiredValidator(), Validators.EmailValidator()]),\r\n\t\t\ttelephone: new FormControl(null),\r\n\t\t\toccupation: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tcountry: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tregion: new FormControl(null, [isItaly]),\r\n\t\t\t//\r\n\t\t\tprintedCopy: new FormControl(null),\r\n\t\t\t//\r\n\t\t\tcity: new FormControl(null, [hasPrintedCopy]),\r\n\t\t\tprovince: new FormControl(null, [hasPrintedCopy]),\r\n\t\t\tzipCode: new FormControl(null, [hasPrintedCopy]),\r\n\t\t\taddress: new FormControl(null, [hasPrintedCopy]),\r\n\t\t\tstreetNumber: new FormControl(null, [hasPrintedCopy]),\r\n\t\t\tphoneNumber: new FormControl(null, [hasPrintedCopy, PhoneNumberValidator()]),\r\n\t\t\t//\r\n\t\t\tprivacy: new FormControl(null, [Validators.RequiredTrueValidator()]),\r\n\t\t\tnewsletter: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tcommercial: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tpromotion: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: '',\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tform.changes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe((_) => {\r\n\t\t\tthis.pushChanges();\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t});\r\n\t\tthis.load$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn MagazineRequestService.data$().pipe(\r\n\t\t\ttap(data => {\r\n\t\t\t\tconst controls = this.controls;\r\n\t\t\t\tcontrols.magazine.options = FormService.toSelectOptions(data.magazine.options);\r\n\t\t\t\tcontrols.occupation.options = FormService.toSelectOptions(data.occupation.options);\r\n\t\t\t\tcontrols.country.options = FormService.toSelectOptions(data.country.options);\r\n\t\t\t\tcontrols.region.options = FormService.toSelectOptions(data.region.options);\r\n\t\t\t\tcontrols.province.options = FormService.toSelectOptions(data.province.options);\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\ttest() {\r\n\t\tconst form = this.form;\r\n\t\tconst controls = this.controls;\r\n\t\tconst magazine = controls.magazine.options.length > 1 ? controls.magazine.options[1].id : null;\r\n\t\tconst occupation = controls.occupation.options.length > 1 ? controls.occupation.options[1].id : null;\r\n\t\tconst country = controls.country.options.length > 1 ? controls.country.options[1].id : null;\r\n\t\tconst region = controls.region.options.length > 1 ? controls.region.options[1].id : null;\r\n\t\tform.patch({\r\n\t\t\tmagazine: magazine,\r\n\t\t\tfirstName: 'Jhon',\r\n\t\t\tlastName: 'Appleseed',\r\n\t\t\temail: 'jhonappleseed@gmail.com',\r\n\t\t\ttelephone: '0721 411112',\r\n\t\t\toccupation: occupation,\r\n\t\t\tcountry: country,\r\n\t\t\tregion: region,\r\n\t\t\tprintedCopy: false,\r\n\t\t\tcity: null,\r\n\t\t\tprivacy: true,\r\n\t\t\tnewsletter: false,\r\n\t\t\tcommercial: false,\r\n\t\t\tpromotion: false,\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: ''\r\n\t\t});\r\n\t}\r\n\r\n\treset() {\r\n\t\tconst form = this.form;\r\n\t\tform.reset();\r\n\t}\r\n\r\n\tonSubmit(model) {\r\n\t\tconst form = this.form;\r\n\t\tconsole.log('MagazineRequestComponent.onSubmit', form.value);\r\n\t\t// console.log('MagazineRequestComponent.onSubmit', 'form.valid', valid);\r\n\t\tif (form.valid) {\r\n\t\t\t// console.log('MagazineRequestComponent.onSubmit', form.value);\r\n\t\t\tform.submitted = true;\r\n\t\t\tMagazineRequestService.submit$(form.value).pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t).subscribe(response => {\r\n\t\t\t\tthis.response = response;\r\n\t\t\t\tthis.success = true;\r\n\t\t\t\tform.reset();\r\n\t\t\t\tGtmService.push({\r\n\t\t\t\t\t'event': \"MagazineRequest\",\r\n\t\t\t\t\t'form_name': \"MagazineRequest\"\r\n\t\t\t\t});\r\n\t\t\t}, error => {\r\n\t\t\t\tconsole.log('MagazineRequestComponent.error', error);\r\n\t\t\t\tthis.error = error;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t\tLocomotiveScrollService.update();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tform.touched = true;\r\n\t\t}\r\n\t}\r\n\r\n\tonCountryDidChange() {\r\n\t\tconsole.log('MagazineRequestComponent.onCountryDidChange');\r\n\t\tthis.controls.province.value = null;\r\n\t}\r\n\r\n}\r\n\r\nMagazineRequestComponent.meta = {\r\n\tselector: '[magazine-request]',\r\n};\r\n","import { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class MagazineService {\r\n\r\n\tstatic all$() {\r\n\t\tif (environment.flags.production)\r\n\t\t{\r\n\t\t\tvar url = environment.currentCaOrder.length === 1 ? '/magazine/all' : '/magazine/all/' + environment.currentCaId;\r\n\t\t\treturn ApiService.get$(url);\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/magazine/all.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic filters$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/magazine/filters');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/magazine/filters.json');\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { combineLatest } from 'rxjs';\r\nimport { FiltersComponent } from '../../shared/filters/filters.component';\r\nimport { MagazineService } from './magazine.service';\r\n\r\nexport class MagazineComponent extends FiltersComponent {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tthis.categoryId = this.categoryId || null;\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn combineLatest([\r\n\t\t\tMagazineService.all$(),\r\n\t\t\tMagazineService.filters$(),\r\n\t\t]);\r\n\t}\r\n\r\n\tsetFiltersParams() {\r\n\t\tif (this.categoryId) {\r\n\t\t\tthis.filters.category.set({ value: this.categoryId });\r\n\t\t}\r\n\t}\r\n\r\n\tdoFilterItem(key, item, value) {\r\n\t\tswitch (key) {\r\n\t\t\tcase 'category':\r\n\t\t\t\treturn item.category.id === value;\r\n\t\t\tcase 'search':\r\n\t\t\t\treturn item.title.toLowerCase().indexOf(value.toLowerCase()) !== -1 ||\r\n\t\t\t\t\titem.country.toLowerCase().indexOf(value.toLowerCase()) !== -1;\r\n\t\t\tdefault:\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nMagazineComponent.meta = {\r\n\tselector: '[magazine]',\r\n\tinputs: ['categoryId'],\r\n};\r\n","import { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class MarketsAndLanguagesService {\r\n\r\n\tstatic all$(currentCoId) {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/markets-and-languages/all?currentCoId=' + currentCoId);\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/markets-and-languages/all.json');\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { first } from 'rxjs/operators';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { ModalOutletComponent } from '../../common/modal/modal-outlet.component';\r\nimport { ModalService } from '../../common/modal/modal.service';\r\nimport { environment } from '../../environment';\r\nimport { MarketsAndLanguagesService } from '../markets-and-languages/markets-and-languages.service';\r\nimport {LocalStorageService} from \"../../common/storage/local-storage.service\";\r\n\r\nexport class MarketPropositionModalComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tconst { parentInstance } = getContext(this);\r\n\t\tif (parentInstance instanceof ModalOutletComponent) {\r\n\t\t\tconst data = parentInstance.modal.data;\r\n\t\t}\r\n\t\tLocomotiveScrollService.stop();\r\n\t\tthis.currentMarket = environment.currentMarket;\r\n\t\tthis.currentLanguage = environment.currentLanguage;\r\n\t\tthis.markets = [];\r\n\t\tthis.proposedMarket = null;\r\n\t\tMarketsAndLanguagesService.all$(environment.currentCoId).pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe(markets => {\r\n\t\t\tthis.markets = markets;\r\n\t\t\tlet proposedMarket = markets.find(x => x.code === environment.userMarket);\r\n\t\t\tif (!proposedMarket) {\r\n\t\t\t\tproposedMarket = markets.find(x => x.code === 'ww') || markets[0];\r\n\t\t\t}\r\n\t\t\tthis.proposedMarket = proposedMarket;\r\n\t\t\tlet proposedLanguage = proposedMarket.languages.find(x => x.code === environment.currentLanguage);\r\n\t\t\tif (!proposedLanguage) {\r\n\t\t\t\tproposedLanguage = proposedMarket.languages[0];\r\n\t\t\t}\r\n\t\t\tthis.proposedLanguage = proposedLanguage;\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t}\r\n\r\n\tsetMarket(market) {\r\n\t\tthis.currentMarket = market.code;\r\n\t\tthis.pushChanges();\r\n\t}\r\n\r\n\tonClose() {\r\n\t\tdocument.cookie = \"marketPropositionAccepted=1; expires=0; path=/\";\r\n\t\tModalService.reject();\r\n\t}\r\n\r\n\tonDestroy() {\r\n\t\tLocomotiveScrollService.start();\r\n\t}\r\n}\r\n\r\nMarketPropositionModalComponent.meta = {\r\n\tselector: '[market-proposition-modal]'\r\n};\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { first } from 'rxjs/operators';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { ModalOutletComponent } from '../../common/modal/modal-outlet.component';\r\nimport { ModalService } from '../../common/modal/modal.service';\r\nimport { environment } from '../../environment';\r\nimport { MarketsAndLanguagesService } from './markets-and-languages.service';\r\n\r\nexport class MarketsAndLanguagesModalComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tconst { parentInstance } = getContext(this);\r\n\t\tif (parentInstance instanceof ModalOutletComponent) {\r\n\t\t\tconst data = parentInstance.modal.data;\r\n\t\t}\r\n\t\tLocomotiveScrollService.stop();\r\n\t\tthis.currentMarket = environment.currentMarket;\r\n\t\tthis.currentLanguage = environment.currentLanguage;\r\n\t\tthis.markets = [];\r\n\t\tMarketsAndLanguagesService.all$(environment.currentCoId).pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe(markets => {\r\n\t\t\tthis.markets = markets;\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t}\r\n\r\n\tsetMarket(market) {\r\n\t\tthis.currentMarket = market.code;\r\n\t\tthis.pushChanges();\r\n\t}\r\n\r\n\tonClose() {\r\n\t\tModalService.reject();\r\n\t}\r\n\r\n\tonDestroy() {\r\n\t\tLocomotiveScrollService.start();\r\n\t}\r\n}\r\n\r\nMarketsAndLanguagesModalComponent.meta = {\r\n\tselector: '[markets-and-languages-modal]'\r\n};\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { ModalOutletComponent } from '../../common/modal/modal-outlet.component';\r\nimport { ModalService } from '../../common/modal/modal.service';\r\n\r\nexport class MaterialsModalComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tthis.item = null;\r\n\t\tthis.items = null;\r\n\t\tconst { parentInstance } = getContext(this);\r\n\t\tif (parentInstance instanceof ModalOutletComponent) {\r\n\t\t\tconst data = parentInstance.modal.data;\r\n\t\t\tthis.item = data.item;\r\n\t\t\tthis.items = data.items;\r\n\t\t\t// console.log('MaterialsModalComponent.onInit', data);\r\n\t\t}\r\n\t\tLocomotiveScrollService.stop();\r\n\t}\r\n\r\n\thasPrev() {\r\n\t\treturn true;\r\n\t}\r\n\r\n\thasNext() {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tonPrev() {\r\n\t\tlet index = this.items.indexOf(this.item);\r\n\t\tindex--;\r\n\t\tif (index < 0) {\r\n\t\t\tindex = this.items.length - 1;\r\n\t\t}\r\n\t\tthis.item = this.items[index];\r\n\t\tthis.pushChanges();\r\n\t}\r\n\r\n\tonNext() {\r\n\t\tlet index = this.items.indexOf(this.item);\r\n\t\tindex++;\r\n\t\tif (index === this.items.length) {\r\n\t\t\tindex = 0;\r\n\t\t}\r\n\t\tthis.item = this.items[index];\r\n\t\tthis.pushChanges();\r\n\t}\r\n\r\n\tonClose() {\r\n\t\tModalService.reject();\r\n\t}\r\n\r\n\tonDestroy() {\r\n\t\tLocomotiveScrollService.start();\r\n\t}\r\n}\r\n\r\nMaterialsModalComponent.meta = {\r\n\tselector: '[materials-modal]'\r\n};\r\n","// import { combineLatest } from 'rxjs';\r\n// import { map } from 'rxjs/operators';\r\nimport { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class MaterialsService {\r\n\r\n\tstatic all$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/materials/all');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/materials/all.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic filters$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/materials/filters');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/materials/filters.json');\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\tstatic fake$() {\r\n\t\treturn combineLatest([MaterialsService.all$(), ApiService.get$('/materials/icons.json')]).pipe(\r\n\t\t\tmap(data => {\r\n\t\t\t\tlet items = data[0];\r\n\t\t\t\tlet icons = data[1];\r\n\t\t\t\titems.forEach(item => {\r\n\t\t\t\t\tif (item.items) {\r\n\t\t\t\t\t\titem.items.forEach(sub => {\r\n\t\t\t\t\t\t\tif (sub.icons) {\r\n\t\t\t\t\t\t\t\tconst set = icons.sets[sub.icons];\r\n\t\t\t\t\t\t\t\tif (set) {\r\n\t\t\t\t\t\t\t\t\tsub.icons = set.map(x => icons.icons.find(icon => icon.id === x)).filter(x => x != null);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tconsole.log(sub.icons);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tconsole.log(JSON.stringify(items));\r\n\t\t\t\treturn items;\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\t*/\r\n\r\n\t/*\r\n\tstatic fake$() {\r\n\t\treturn combineLatest([MaterialsService.all$(), ApiService.get$('/materials/all_.json')]).pipe(\r\n\t\t\tmap(data => {\r\n\t\t\t\tlet items = data[0];\r\n\t\t\t\tlet items_ = data[1];\r\n\t\t\t\titems = items.filter(x => x.category.name !== 'Tessuto' || !x.collection);\r\n\t\t\t\titems.forEach(item => {\r\n\t\t\t\t\tif (item.category.name === 'Tessuto') {\r\n\t\t\t\t\t\titem.items = items_.filter(x => x.collection && x.collection.id === item.id);\r\n\t\t\t\t\t\tconsole.log(item.items);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tconsole.log(JSON.stringify(items));\r\n\t\t\t\treturn items;\r\n\t\t\t\t// !!!\r\n\t\t\t\tlet collectionId = 1000;\r\n\t\t\t\tconst fabrics = [];\r\n\t\t\t\tconst collections = [];\r\n\t\t\t\titems_.forEach(item_ => {\r\n\t\t\t\t\tlet collection = collections.find(x => x.name === item_.collection);\r\n\t\t\t\t\tif (!collection) {\r\n\t\t\t\t\t\tcollection = {\r\n\t\t\t\t\t\t\tid: ++collectionId,\r\n\t\t\t\t\t\t\tname: item_.collection,\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tcollections.push(collection);\r\n\t\t\t\t\t\tif (item_.category.name === 'Tessuto') {\r\n\t\t\t\t\t\t\tfabrics.push(Object.assign({\r\n\t\t\t\t\t\t\t\timage: `/giorgetti/img/materials/tessuto/${collection.name.toLowerCase().replace(/\\s/g, '_')}_512.jpg`,\r\n\t\t\t\t\t\t\t\tcategory: item_.category,\r\n\t\t\t\t\t\t\t}, collection));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tconsole.log(fabrics);\r\n\t\t\t\titems.forEach((item, i) => {\r\n\t\t\t\t\tconst item_ = items_.find(x => x.id === item.id);\r\n\t\t\t\t\t// if (item_) {\r\n\t\t\t\t\t//\titem.image = item_.image.replace(/\\s/g, '_').toLowerCase();\r\n\t\t\t\t\t//\titem.zoom = item_.zoom.replace(/\\s/g, '_').toLowerCase();\r\n\t\t\t\t\t// }\r\n\t\t\t\t\tconst collection = collections.find(x => x.name === item.collection);\r\n\t\t\t\t\tconsole.log(collection);\r\n\t\t\t\t\tif (collection) {\r\n\t\t\t\t\t\titem.collection = collection;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// item.collection = MaterialsService.toTitleCase(item.collection);\r\n\t\t\t\t\t// item.title = MaterialsService.toTitleCase(item.title);\r\n\t\t\t\t});\r\n\t\t\t\titems = items.concat(fabrics);\r\n\t\t\t\tconsole.log(JSON.stringify(items));\r\n\t\t\t\treturn items;\r\n\t\t\t\t// !!!\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tstatic toTitleCase(sentence, seps = ' _-/') {\r\n\t\tconst capitalize = str => str.length ? str[0].toUpperCase() + str.slice(1).toLowerCase() : '';\r\n\t\tconst escape = str => str.replace(/./g, c => `\\\\${c}`);\r\n\t\tlet wordPattern = new RegExp(`[^${escape(seps)}]+`, 'g');\r\n\t\treturn sentence.replace(wordPattern, capitalize);\r\n\t}\r\n\t*/\r\n\r\n}\r\n","import { Component } from 'rxcomp';\r\nimport { FormControl, FormGroup } from 'rxcomp-form';\r\nimport { combineLatest } from 'rxjs';\r\nimport { first, takeUntil } from 'rxjs/operators';\r\nimport { FilterMode } from '../../common/filter/filter-item';\r\nimport { FilterService } from '../../common/filter/filter.service';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { ModalService } from '../../common/modal/modal.service';\r\nimport { FormService } from '../../controls/form.service';\r\nimport { environment } from '../../environment';\r\nimport { MaterialsService } from './materials.service';\r\n\r\nexport class MaterialsComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.categories = [];\r\n\t\tthis.selectedItem = null;\r\n\t\tthis.items = [];\r\n\t\tthis.filteredItems = [];\r\n\t\tthis.visibleItems = [];\r\n\t\tthis.filters = {};\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\tcategory: new FormControl(null),\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tform.changes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe((_) => {\r\n\t\t\tthis.setFilterByKeyAndValue('category', form.value.category);\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t\tthis.load$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe(data => {\r\n\t\t\tthis.items = data[0];\r\n\t\t\tthis.filters = data[1];\r\n\t\t\tcontrols.category.options = FormService.toSelectOptions(this.filters.category.options);\r\n\t\t\tthis.onLoad();\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn combineLatest([\r\n\t\t\tMaterialsService.all$(),\r\n\t\t\tMaterialsService.filters$(),\r\n\t\t]);\r\n\t}\r\n\r\n\tonLoad() {\r\n\t\tconst items = this.items;\r\n\t\tconst filters = this.filters;\r\n\t\tObject.keys(filters).forEach(key => {\r\n\t\t\tfilters[key].mode = filters[key].mode || FilterMode.OR;\r\n\t\t});\r\n\t\tconst initialParams = {};\r\n\t\tconst filterService = new FilterService(filters, initialParams, (key, filter) => {\r\n\t\t\tswitch (key) {\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tfilter.filter = (item, value) => {\r\n\t\t\t\t\t\tswitch (key) {\r\n\t\t\t\t\t\t\tcase 'category':\r\n\t\t\t\t\t\t\t\treturn item.category.id === value;\r\n\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.filterService = filterService;\r\n\t\tthis.filters = filterService.filters;\r\n\t\tthis.categories = this.filters.category.options.filter(x => x.value);\r\n\t\tconst category = this.filters.category.values.length ? this.filters.category.values[0] : null;\r\n\t\tthis.form.patch({ category, search });\r\n\t\tfilterService.items$(items).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe(filteredItems => {\r\n\t\t\tthis.filteredItems = filteredItems;\r\n\t\t\tthis.visibleItems = this.filteredItems.slice(0, Math.min(16, this.filteredItems.length));\r\n\t\t\tthis.pushChanges();\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t\t// console.log('MaterialsComponent.filteredItems', filteredItems.length);\r\n\t\t});\r\n\t}\r\n\r\n\tshowMore(event) {\r\n\t\tconst pageSize = 32;\r\n\t\tif (this.visibleItems.length + pageSize >= this.filteredItems.length) {\r\n\t\t\tthis.visibleItems = this.filteredItems.slice();\r\n\t\t} else {\r\n\t\t\tthis.visibleItems = this.filteredItems.slice(0, Math.min(this.visibleItems.length + pageSize, this.filteredItems.length));\r\n\t\t}\r\n\t\tthis.pushChanges();\r\n\t\tLocomotiveScrollService.update();\r\n\t}\r\n\r\n\tsetFilterByKeyAndValue(key, value) {\r\n\t\tconst filter = this.filters[key];\r\n\t\tif (filter) {\r\n\t\t\tif (filter.mode === FilterMode.QUERY) {\r\n\t\t\t\tfilter.set(value);\r\n\t\t\t} else {\r\n\t\t\t\tconst option = filter.options.find(x => x.value === value);\r\n\t\t\t\t// console.log(filter.options, option);\r\n\t\t\t\tif (option) {\r\n\t\t\t\t\tfilter.set(option);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfilter.clear();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tonToggle(item) {\r\n\t\tthis.selectedItem = this.selectedItem === item ? null : item;\r\n\t\t/*\r\n\t\tif (this.selectedItem) {\r\n\t\t\tconst selector = '#cat-' + item.category.id + '-' + item.id;\r\n\t\t\tLocomotiveScrollService.scrollToSelector(selector);\r\n\t\t}\r\n\t\t*/\r\n\t\tthis.pushChanges();\r\n\t}\r\n\r\n\tonOpenItem(item, items) {\r\n\t\tif (item.items) {\r\n\t\t\tconst active = !item.active;\r\n\t\t\tthis.filteredItems.forEach(item_ => {\r\n\t\t\t\tif (item_ !== item) {\r\n\t\t\t\t\titem_.active = false;\r\n\t\t\t\t\tconst node = document.querySelector(`#material-${item_.id}`);\r\n\t\t\t\t\tif (node) {\r\n\t\t\t\t\t\tnode.style.marginBottom = `0px`;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\titem.active = active;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (active) {\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t}\r\n\t\t\tconst node = document.querySelector(`#material-${item.id}`);\r\n\t\t\tif (node) {\r\n\t\t\t\tconst target = node.querySelector('.group--subitems');\r\n\t\t\t\tif (target) {\r\n\t\t\t\t\tconst targetRect = target.getBoundingClientRect();\r\n\t\t\t\t\tconst height = targetRect.height + 40;\r\n\t\t\t\t\tif (!active) {\r\n\t\t\t\t\t\tthis.pushChanges();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst from = { pow: active ? 0 : 1 };\r\n\t\t\t\t\tgsap.to(from, {\r\n\t\t\t\t\t\tpow: active ? 1 : 0,\r\n\t\t\t\t\t\tduration: height / 5000,\r\n\t\t\t\t\t\tease: Power2.easeOut,\r\n\t\t\t\t\t\tonUpdate: () => {\r\n\t\t\t\t\t\t\tnode.style.marginBottom = `${from.pow * height}px`;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonComplete: () => {\r\n\t\t\t\t\t\t\tLocomotiveScrollService.scrollToSelector(`#material-${item.id} .group--subitems`);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tModalService.open$({ src: environment.template.modal.materialsModal, data: { item, items } }).pipe(\r\n\t\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t\t).subscribe(event => {\r\n\t\t\t\tconsole.log('MaterialComponent.onOpen', event);\r\n\t\t\t\t/*\r\n\t\t\t\tif (event instanceof ModalResolveEvent) {\r\n\t\t\t\t\twindow.location.href = environment.slug.reservedArea;\r\n\t\t\t\t}\r\n\t\t\t\t*/\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tsetCategory(category, event) {\r\n\t\tif (event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t}\r\n\t\tthis.controls.category.value = category.value;\r\n\t\tsetTimeout(() => {\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t\tLocomotiveScrollService.scrollToSelector('#category-' + category.value, { offset: -240 });\r\n\t\t}, 500);\r\n\t}\r\n\r\n\tclearFilter(event, filter) {\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopImmediatePropagation();\r\n\t\tfilter.clear();\r\n\t\tthis.pushChanges();\r\n\t}\r\n}\r\n\r\nMaterialsComponent.meta = {\r\n\tselector: '[materials]',\r\n};\r\n","import { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class NewsService {\r\n\r\n\tstatic all$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/news/all');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/news/all.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic filters$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/news/filters');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/news/filters.json');\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { combineLatest } from 'rxjs';\r\nimport { FiltersComponent } from '../../shared/filters/filters.component';\r\nimport { NewsService } from './news.service';\r\n\r\nexport class NewsComponent extends FiltersComponent {\r\n\r\n\tload$() {\r\n\t\treturn combineLatest([\r\n\t\t\tNewsService.all$(),\r\n\t\t\tNewsService.filters$(),\r\n\t\t]);\r\n\t}\r\n\r\n\tdoFilterItem(key, item, value) {\r\n\t\tswitch (key) {\r\n\t\t\tcase 'country':\r\n\t\t\t\treturn item.country.id === value;\r\n\t\t\tcase 'search':\r\n\t\t\t\treturn item.title.toLowerCase().indexOf(value.toLowerCase()) !== -1 ||\r\n\t\t\t\t\titem.abstract.toLowerCase().indexOf(value.toLowerCase()) !== -1;\r\n\t\t\tdefault:\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nNewsComponent.meta = {\r\n\tselector: '[news]',\r\n};\r\n","import { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class NewsletterService {\r\n\r\n\tstatic data$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/newsletter/data');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/newsletter/data.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic submit$(payload) {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.post$('/newsletter/submit', payload);\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/newsletter/submit.json');\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { Component } from 'rxcomp';\r\nimport { FormControl, FormGroup, Validators } from 'rxcomp-form';\r\nimport { first, takeUntil, tap } from 'rxjs/operators';\r\nimport { GtmService } from '../../common/gtm/gtm.service';\r\nimport { LocationService } from '../../common/location/location.service';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { FormService } from '../../controls/form.service';\r\nimport RequiredIfValidator from '../../controls/required-if.validator';\r\nimport { NewsletterService } from './newsletter.service';\r\n\r\nexport class NewsletterComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.error = null;\r\n\t\tthis.success = false;\r\n\t\tconst email = LocationService.deserialize('email');\r\n\t\t// console.log('NewsletterComponent', email);\r\n\t\tconst isItaly = RequiredIfValidator(() => Boolean(this.form.value.country === 114));\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\tfirstName: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tlastName: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\temail: new FormControl(email, [Validators.RequiredValidator(), Validators.EmailValidator()]),\r\n\t\t\toccupation: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\ttelephone: new FormControl(null),\r\n\t\t\tcountry: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tregion: new FormControl(null, [isItaly]),\r\n\t\t\tcity: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tengagement: new FormControl(null),\r\n\t\t\tnewsletter: new FormControl(null, [Validators.RequiredTrueValidator()]),\r\n\t\t\tnewsletterLanguage: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tprivacy: new FormControl(null, [Validators.RequiredTrueValidator()]),\r\n\t\t\tcommercial: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tpromotion: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: '',\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tform.changes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe((_) => {\r\n\t\t\tthis.pushChanges();\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t});\r\n\t\tthis.load$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn NewsletterService.data$().pipe(\r\n\t\t\ttap(data => {\r\n\t\t\t\tconst controls = this.controls;\r\n\t\t\t\tcontrols.occupation.options = FormService.toSelectOptions(data.occupation.options);\r\n\t\t\t\tcontrols.country.options = FormService.toSelectOptions(data.country.options);\r\n\t\t\t\tcontrols.region.options = FormService.toSelectOptions(data.region.options);\r\n\t\t\t\tcontrols.engagement.options = FormService.toSelectOptions(data.engagement.options);\r\n\t\t\t\tcontrols.newsletterLanguage.options = FormService.toSelectOptions(data.newsletterLanguage.options);\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\ttest() {\r\n\t\tconst form = this.form;\r\n\t\tconst controls = this.controls;\r\n\t\tconst occupation = controls.occupation.options.length > 1 ? controls.occupation.options[1].id : null;\r\n\t\tconst country = controls.country.options.length > 1 ? controls.country.options[1].id : null;\r\n\t\tconst region = controls.region.options.length > 1 ? controls.region.options[1].id : null;\r\n\t\tconst engagement = controls.engagement.options.length > 1 ? controls.engagement.options[1].id : null;\r\n\t\tconst newsletterLanguage = controls.newsletterLanguage.options.length > 1 ? controls.newsletterLanguage.options[1].id : null;\r\n\t\tform.patch({\r\n\t\t\tfirstName: 'Jhon',\r\n\t\t\tlastName: 'Appleseed',\r\n\t\t\temail: 'jhonappleseed@gmail.com',\r\n\t\t\ttelephone: '0721 411112',\r\n\t\t\toccupation: occupation,\r\n\t\t\tcountry: country,\r\n\t\t\tregion: region,\r\n\t\t\tcity: 'Pesaro',\r\n\t\t\tengagement: engagement,\r\n\t\t\tnewsletterLanguage: newsletterLanguage,\r\n\t\t\tprivacy: true,\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: ''\r\n\t\t});\r\n\t}\r\n\r\n\treset() {\r\n\t\tconst form = this.form;\r\n\t\tform.reset();\r\n\t}\r\n\r\n\tonSubmit(model) {\r\n\t\tconst form = this.form;\r\n\t\tconsole.log('NewsletterComponent.onSubmit', form.value);\r\n\t\t// console.log('NewsletterComponent.onSubmit', 'form.valid', valid);\r\n\t\tif (form.valid) {\r\n\t\t\t// console.log('NewsletterComponent.onSubmit', form.value);\r\n\t\t\tform.submitted = true;\r\n\t\t\tNewsletterService.submit$(form.value).pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t).subscribe(_ => {\r\n\t\t\t\tthis.success = true;\r\n\t\t\t\tform.reset();\r\n\t\t\t\tGtmService.push({\r\n\t\t\t\t\t'event': \"Newsletter\",\r\n\t\t\t\t\t'form_name': \"Newsletter\"\r\n\t\t\t\t});\r\n\t\t\t}, error => {\r\n\t\t\t\tconsole.log('NewsletterComponent.error', error);\r\n\t\t\t\tthis.error = error;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t\tLocomotiveScrollService.update();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tform.touched = true;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nNewsletterComponent.meta = {\r\n\tselector: '[newsletter]',\r\n};\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { ModalOutletComponent } from '../../common/modal/modal-outlet.component';\r\nimport { ModalService } from '../../common/modal/modal.service';\r\n\r\nexport class OrdersModalComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tconst { parentInstance } = getContext(this);\r\n\t\tif (parentInstance instanceof ModalOutletComponent) {\r\n\t\t\tconst data = parentInstance.modal.data;\r\n\t\t\tthis.orderId = data.orderId;\r\n\t\t\t// console.log('OrdersModalComponent.onInit', data);\r\n\t\t}\r\n\t\tLocomotiveScrollService.stop();\r\n\t}\r\n\r\n\tonClose() {\r\n\t\tModalService.reject();\r\n\t}\r\n\r\n\tonDestroy() {\r\n\t\tLocomotiveScrollService.start();\r\n\t}\r\n}\r\n\r\nOrdersModalComponent.meta = {\r\n\tselector: '[orders-modal]'\r\n};\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { finalize, first, tap } from 'rxjs/operators';\r\nimport { LocationService } from '../../common/location/location.service';\r\nimport { OrdersModalComponent } from './orders-modal.component';\r\nimport { OrdersService } from './orders.service';\r\n\r\nexport class OrdersDetailComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tthis.busy = false;\r\n\t\tthis.order = null;\r\n\t\tconst { parentInstance } = getContext(this);\r\n\t\tif (parentInstance instanceof OrdersModalComponent) {\r\n\t\t\tthis.orderId = parentInstance.orderId;\r\n\t\t} else {\r\n\t\t\tthis.orderId = LocationService.get('orderId');\r\n\t\t}\r\n\t\tif (this.orderId) {\r\n\t\t\tthis.load$().pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t).subscribe();\r\n\t\t\t// console.log('OrdersDetailComponent.onInit', data);\r\n\t\t} else {\r\n\t\t\tconsole.error('OrdersDetailComponent missing orderId');\r\n\t\t}\r\n\t\tconsole.log(this);\r\n\t}\r\n\r\n\tload$() {\r\n\t\tthis.busy = true;\r\n\t\treturn OrdersService.detail$(this.orderId).pipe(\r\n\t\t\ttap(order => {\r\n\t\t\t\tthis.order = order;\r\n\t\t\t}),\r\n\t\t\tfinalize(_ => {\r\n\t\t\t\tthis.busy = false;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n}\r\n\r\nOrdersDetailComponent.meta = {\r\n\tselector: '[orders-detail]',\r\n};\r\n","import { Component } from 'rxcomp';\r\nimport { first, takeUntil, tap } from 'rxjs/operators';\r\nimport { ModalService } from '../../common/modal/modal.service';\r\nimport { environment } from '../../environment';\r\nimport { OrdersService } from './orders.service';\r\n\r\nexport class OrdersComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.orders = [];\r\n\t\tthis.load$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn OrdersService.all$().pipe(\r\n\t\t\ttap(orders => {\r\n\t\t\t\tthis.orders = orders;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tonOpenOrder(order) {\r\n\t\tModalService.open$({ src: environment.template.modal.ordersModal, data: { orderId: order.id } }).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(event => {\r\n\t\t\tconsole.log('OrdersComponent.onOpenOrder', event);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nOrdersComponent.meta = {\r\n\tselector: '[orders]',\r\n};\r\n","import { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class PressService {\r\n\r\n\tstatic all$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/press/all');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/press/all.json');\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { combineLatest } from 'rxjs';\r\nimport { FiltersComponent } from '../../shared/filters/filters.component';\r\nimport { PressService } from './press.service';\r\n\r\nexport class PressComponent extends FiltersComponent {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn combineLatest([\r\n\t\t\tPressService.all$(),\r\n\t\t]);\r\n\t}\r\n\r\n\tdoFilterItem(key, item, value) {\r\n\t\tswitch (key) {\r\n\t\t\tdefault:\r\n\t\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nPressComponent.meta = {\r\n\tselector: '[press]',\r\n};\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { first } from 'rxjs/operators';\r\nimport { GtmService } from '../../common/gtm/gtm.service';\r\nimport { LocationService } from '../../common/location/location.service';\r\nimport { environment } from '../../environment';\r\nimport { CartMiniService } from '../../shared/cart-mini/cart-mini.service';\r\nimport { CartService } from '../cart/cart.service';\r\n\r\nconst breadcumbStyle = `font-size: .8rem; text-transform: uppercase; letter-spacing: 0.075em; color: #37393b; display: none;`;\r\nconst titleStyle = `letter-spacing: 0; font-family: 'Bauer Bodoni', sans-serif; font-size: 2.9rem; margin: 0;word-wrap: break-word;text-transform: uppercase;color:#37393b;`;\r\nconst designerStyle = `font-size: .8rem; letter-spacing: 0.075em;margin-bottom: 15px;word-wrap: break-word;text-transform: uppercase; display: none;`;\r\nconst descriptionStyle = `font-size: .8rem; text-align: left;margin-bottom: 15px; letter-spacing: 0.05em; display: none;`;\r\n\r\nexport class ProductsConfigureComponent extends Component {\r\n\r\n\tget priceListByMarket() {\r\n\t\t// !!! I listini YY possibili sono: A listino EUR, B listino GB, C listino USA, D listino RMB, E listino Medio oriente\r\n\t\tswitch (environment.currentMarket.toLowerCase()) {\r\n\t\t\tdefault:\r\n\t\t\t\treturn 'A';\r\n\t\t}\r\n\t}\r\n\r\n\tget currentMarket() {\r\n\t\tlet currentMarket = environment.currentMarket.toLowerCase();\r\n\t\tswitch (currentMarket) {\r\n\t\t\tcase 'cn':\r\n\t\t\t\tcurrentMarket = currentMarket;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tconst userMarket = environment.userMarket.toLowerCase();\r\n\t\t\t\tif (userMarket !== currentMarket) {\r\n\t\t\t\t\tcurrentMarket = 'xx';\r\n\t\t\t\t}\r\n\t\t}\r\n\t\treturn currentMarket;\r\n\t}\r\n\r\n\tget currentLanguage() {\r\n\t\tlet currentLanguage = environment.currentLanguage.toLowerCase();\r\n\t\tswitch (currentLanguage) {\r\n\t\t\tcase 'zh':\r\n\t\t\t\tcurrentLanguage = 'en';\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn currentLanguage;\r\n\t}\r\n\r\n\tget showefyUrl() {\r\n\t\t// console.log('ProductsConfigureComponent.showefyUrl', 'currentLanguage', this.currentLanguage, 'currentMarket', this.currentMarket, 'priceListByMarket', this.priceListByMarket, environment);\r\n\t\tif (this.product) {\r\n\t\t\treturn `https://www.showefy.com/showroom/giorgetti/?l=${this.currentLanguage}&c=${this.currentMarket}&list=${this.priceListByMarket}&codprod=${this.product.code}${this.product.familyCode ? `&codfam=${this.product.familyCode}` : ''}&autoEnter=1${this.sl ? `&ext&sl=${this.sl}` : ''}`;\r\n\t\t}\r\n\t}\r\n\r\n\tonInit() {\r\n\t\tthis.sl = LocationService.get('sl');\r\n\t\t// console.log(this.code);\r\n\t\tif (!this.product) {\r\n\t\t\tthrow ('ProductsConfigureComponent.error missing product');\r\n\t\t}\r\n\t\tthis.isReady = false;\r\n\t\tthis.isComplete = false;\r\n\t\tthis.isConfiguring = false;\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst iframe = this.iframe = node.querySelector('#showefy');\r\n\t\tif (!iframe) {\r\n\t\t\tthrow ('missing iframe');\r\n\t\t}\r\n\t\tthis.onEvent = this.onEvent.bind(this);\r\n\t\tconst sfy = this.sfy = new SFYFrame(iframe, this.token, this.onEvent);\r\n\t\tsfy.init();\r\n\t\t// console.log('ProductsConfigureComponent.onInit', sfy, iframe);\r\n\t}\r\n\r\n\tgetIframeDocument(iframe) {\r\n\t\tconst content = iframe.contentWindow || iframe.contentDocument\r\n\t\tconst iframeDocument = content.document ? content.document : content;\r\n\t\treturn iframeDocument;\r\n\t}\r\n\r\n\tonEvent(data) {\r\n\t\tconst event = JSON.parse(data);\r\n\t\tconst eventName = event.emit;\r\n\t\tif (event.status == 0) {\r\n\t\t\t// console.log('ProductsConfigureComponent.onEvent', event);\r\n\t\t\tswitch (eventName) {\r\n\t\t\t\tcase 'showefy_ready':\r\n\t\t\t\t\tthis.onReady(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'showefy_complete':\r\n\t\t\t\t\tthis.onShowefyComplete(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'start_configurator':\r\n\t\t\t\t\tthis.onStartConfigurator(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'button_pressed':\r\n\t\t\t\t\tthis.onButtonPressed(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'setButtonStatus':\r\n\t\t\t\t\tthis.onSetButtonStatus(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'getIframeSize':\r\n\t\t\t\t\tthis.onGetIframeSize(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'getProductExtData':\r\n\t\t\t\t\tthis.onGetProductExtData(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'getFastProductExtData':\r\n\t\t\t\t\tthis.onGetFastProductExtData(event);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconsole.log('ProductsConfigureComponent.onEvent.error', event.status, event.statusTxt, eventName);\r\n\t\t}\r\n\t}\r\n\r\n\tonReady(event) {\r\n\t\t// console.log('ProductsConfigureComponent.onReady', event);\r\n\t\tthis.isReady = true;\r\n\t\t// this.addTexts();\r\n\t\tthis.addButtons();\r\n\t\t// this.addBreadcrumb();\r\n\t}\r\n\r\n\tonShowefyComplete(event) {\r\n\t\t// console.log('ProductsConfigureComponent.onShowefyComplete', event);\r\n\t\tif (this.isConfiguring) {\r\n\t\t\tthis.isComplete = true;\r\n\t\t}\r\n\t}\r\n\r\n\tonStartConfigurator(event) {\r\n\t\t// console.log('ProductsConfigureComponent.onStartConfigurator', event);\r\n\t\tthis.isConfiguring = true;\r\n\t}\r\n\r\n\tonButtonPressed(event) {\r\n\t\t// console.log('ProductsConfigureComponent.onButtonPressed', event, 'buttonId', event.data.id);\r\n\t\tswitch (event.data.id) {\r\n\t\t\tcase 'order':\r\n\t\t\t\tthis.sfy.getProductExtData();\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tonSetButtonStatus(event) {\r\n\t\tconsole.log('ProductsConfigureComponent.onSetButtonStatus', event);\r\n\t}\r\n\r\n\tonGetIframeSize(event) {\r\n\t\tconsole.log('ProductsConfigureComponent.onGetIframeSize', event);\r\n\t}\r\n\r\n\tonGetProductExtData(event) {\r\n\t\tconsole.log('ProductsConfigureComponent.onGetProductExtData', event.status, event.data);\r\n\t\tif (event.status === 0) {\r\n\t\t\tthis.onAddToCart(event.data);\r\n\t\t}\r\n\t}\r\n\r\n\tonGetFastProductExtData(event) {\r\n\t\tconsole.log('ProductsConfigureComponent.onGetFastProductExtData', event.status, event.data);\r\n\t\tif (event.status === 0) {\r\n\t\t\tthis.onAddToCart(event.data);\r\n\t\t}\r\n\t}\r\n\r\n\t// methods\r\n\r\n\taddTexts() {\r\n\t\tconst sfy = this.sfy;\r\n\t\tconst html = sfy.HTML;\r\n\t\tlet index = 0;\r\n\t\thtml.text[index++] = /* html */`<h1 style=\"${titleStyle}\">Nome Prodotto</h1>`;\r\n\t\thtml.text[index++] = /* html */`<h5 style=\"${designerStyle}\">Designer</h5>`;\r\n\t\thtml.text[index++] = /* html */`<div style=\"${descriptionStyle}\"><p>Descrizione</p></div>`;\r\n\t\tsfy.printHTML(html);\r\n\t}\r\n\r\n\taddButtons() {\r\n\t\tconst sfy = this.sfy;\r\n\t\tconst buttons = sfy.BUTTONS;\r\n\r\n\t\tlet index = 0;\r\n\t\tbuttons.element[index] = new sfy.PROPERTIES();\r\n\t\tbuttons.element[index].visibility = true;\r\n\t\tbuttons.element[index].id = 'order';\r\n\t\tbuttons.element[index].label = new sfy.LABEL();\r\n\t\tbuttons.element[index].label.it = 'Aggiungi al carrello';\r\n\t\tbuttons.element[index].label.en = 'Add to cart';\r\n\t\tindex++;\r\n\r\n\t\t/*\r\n\t\tbuttons.element[index] = new sfy.PROPERTIES();\r\n\t\tbuttons.element[index].visibility = true;\r\n\t\tbuttons.element[index].id = 'save_configuration';\r\n\t\tbuttons.element[index].label = new sfy.LABEL();\r\n\t\tbuttons.element[index].label.en = 'SAVE CONFIGURATION';\r\n\t\tindex++;\r\n\t\t*/\r\n\r\n\t\tsfy.setButtonStatus(buttons);\r\n\t}\r\n\r\n\taddBreadcrumb() {\r\n\t\tconst sfy = this.sfy;\r\n\t\tconst breadcrumb = sfy.BREADCUMB;\r\n\r\n\t\tlet index = 0;\r\n\r\n\t\tbreadcrumb.element[index] = new sfy.PROPERTIES();\r\n\t\tbreadcrumb.element[index].visibility = true;\r\n\t\tbreadcrumb.element[index].id = 'breadcumb_home';\r\n\t\tbreadcrumb.element[index].label = new sfy.LABEL();\r\n\t\tbreadcrumb.element[index].label.en = /* html */` Home <span aria-hidden='true'>/</span>&nbsp; `;\r\n\t\tbreadcrumb.element[index].style = breadcumbStyle;\r\n\t\tindex++;\r\n\r\n\t\tbreadcrumb.element[index] = new sfy.PROPERTIES();\r\n\t\tbreadcrumb.element[index].visibility = true;\r\n\t\tbreadcrumb.element[index].id = 'breadcumb_products';\r\n\t\tbreadcrumb.element[index].label = new sfy.LABEL();\r\n\t\tbreadcrumb.element[index].label.en = /* html */` Products <span aria-hidden='true'>/</span>&nbsp; `;\r\n\t\tbreadcrumb.element[index].style = breadcumbStyle;\r\n\t\tindex++;\r\n\r\n\t\tbreadcrumb.element[index] = new sfy.PROPERTIES();\r\n\t\tbreadcrumb.element[index].visibility = true;\r\n\t\tbreadcrumb.element[index].id = 'breadcumb_products';\r\n\t\tbreadcrumb.element[index].label = new sfy.LABEL();\r\n\t\tbreadcrumb.element[index].label.en = /* html */` Nome prodotto`;\r\n\t\tbreadcrumb.element[index].style = breadcumbStyle;\r\n\t\tindex++;\r\n\r\n\t\tsfy.printBreadcumb(breadcrumb);\r\n\t}\r\n\r\n\tonAddToCart(data) {\r\n\t\tconst cartItem = this.product;\r\n\t\tcartItem.showefy = data;\r\n\t\tif (data.product_code) {\r\n\t\t\tcartItem.code = data.product_code;\r\n\t\t}\r\n\t\tif (data.image) {\r\n\t\t\tcartItem.image = data.image;\r\n\t\t}\r\n\t\tcartItem.title = `${cartItem.productTitle} ${cartItem.code}`;\r\n\t\tconsole.log('ProductsConfigureComponent.onAddToCart', cartItem);\r\n\t\t// resetting purchase procedure\r\n\t\tCartService.setCart(null);\r\n\t\t// getting showefy price and adding to mini cart\r\n\t\tCartMiniService.getPriceAndAddItem$(cartItem).pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t\tGtmService.push({ 'event': 'step checkout', 'ecommstep': 'Aggiungi al Carrello' });\r\n\t}\r\n}\r\n\r\nProductsConfigureComponent.meta = {\r\n\tselector: '[products-configure]',\r\n\tinputs: ['token', 'product'],\r\n};\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { ModalOutletComponent } from '../../common/modal/modal-outlet.component';\r\nimport { ModalService } from '../../common/modal/modal.service';\r\n\r\nexport class ProductsDetailRequestModalComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.product = null;\r\n\t\tconst { parentInstance } = getContext(this);\r\n\t\tif (parentInstance instanceof ModalOutletComponent) {\r\n\t\t\tconst data = parentInstance.modal.data;\r\n\t\t\tthis.product = data.product;\r\n\t\t\tconsole.log('ProductsDetailRequestModalComponent.onInit', data);\r\n\t\t}\r\n\t\tLocomotiveScrollService.stop();\r\n\t}\r\n\r\n\tonClose() {\r\n\t\tModalService.reject();\r\n\t}\r\n\r\n\tonDestroy() {\r\n\t\tLocomotiveScrollService.start();\r\n\t}\r\n}\r\n\r\nProductsDetailRequestModalComponent.meta = {\r\n\tselector: '[products-detail-request-modal]'\r\n};\r\n","import { map } from 'rxjs/operators';\r\nimport { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class ProductsDetailService {\r\n\r\n\tstatic versions$(productId) {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ProductsDetailService.sort$(ApiService.get$('/products/versions?productId=' + productId));\r\n\t\t} else {\r\n\t\t\treturn ProductsDetailService.sort$(ApiService.get$('/products-detail/versions.json'));\r\n\t\t}\r\n\t}\r\n\r\n\tstatic sort$(items$) {\r\n\t\treturn items$.pipe(\r\n\t\t\tmap(items => {\r\n\t\t\t\titems.sort((a, b) => {\r\n\t\t\t\t\tif (a.configurable !== b.configurable) {\r\n\t\t\t\t\t\treturn a.configurable ? -1 : 1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t/*\r\n\t\t\t\tif (environment.flags.cart) {\r\n\t\t\t\t\titems.sort((a, b) => {\r\n\t\t\t\t\t\tif (a.configurable !== b.configurable) {\r\n\t\t\t\t\t\t\treturn a.configurable ? -1 : 1;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\titems.forEach(x => x.configurable = false);\r\n\t\t\t\t}\r\n\t\t\t\t*/\r\n\t\t\t\treturn items;\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n\tstatic data$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/products-detail/data');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/products-detail/data.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic submit$(payload) {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.post$('/products-detail/submit', payload);\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/products-detail/submit.json');\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { Component } from 'rxcomp';\r\nimport { FormControl, FormGroup, Validators } from 'rxcomp-form';\r\nimport { first, takeUntil, tap } from 'rxjs/operators';\r\nimport { GtmService } from '../../common/gtm/gtm.service';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { FormService } from '../../controls/form.service';\r\nimport RequiredIfValidator from '../../controls/required-if.validator';\r\nimport { ProductsDetailService } from './products-detail.service';\r\n\r\nexport class ProductsDetailRequestComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tconsole.log('ProductsDetailRequestComponent', this.product);\r\n\t\tthis.response = null;\r\n\t\tthis.error = null;\r\n\t\tthis.success = false;\r\n\t\tconst hasNewsletter = RequiredIfValidator(() => Boolean(this.form.value.newsletter));\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\tproductId: new FormControl(this.product.id, [Validators.RequiredValidator()]),\r\n\t\t\tproductTitle: new FormControl(this.product.title, [Validators.RequiredValidator()]),\r\n\t\t\treason: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t//\r\n\t\t\tfirstName: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tlastName: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\temail: new FormControl(null, [Validators.RequiredValidator(), Validators.EmailValidator()]),\r\n\t\t\ttelephone: new FormControl(null),\r\n\t\t\tcompany: new FormControl(null),\r\n\t\t\toccupation: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tcountry: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tcity: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t//\r\n\t\t\tmessage: new FormControl(null),\r\n\t\t\t//\r\n\t\t\tprivacy: new FormControl(null, [Validators.RequiredTrueValidator()]),\r\n\t\t\tnewsletter: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tcommercial: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tpromotion: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t// newsletterLanguage: new FormControl(null, [hasNewsletter]),\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: '',\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tform.changes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe((_) => {\r\n\t\t\tthis.pushChanges();\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t});\r\n\t\tthis.load$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn ProductsDetailService.data$().pipe(\r\n\t\t\ttap(data => {\r\n\t\t\t\tconst controls = this.controls;\r\n\t\t\t\tcontrols.reason.options = FormService.toSelectOptions(data.reason.options);\r\n\t\t\t\tcontrols.occupation.options = FormService.toSelectOptions(data.occupation.options);\r\n\t\t\t\tcontrols.country.options = FormService.toSelectOptions(data.country.options);\r\n\t\t\t\t// controls.newsletterLanguage.options = FormService.toSelectOptions(data.newsletterLanguage.options);\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\ttest() {\r\n\t\tconst form = this.form;\r\n\t\tconst controls = this.controls;\r\n\t\tconst reason = controls.reason.options.length > 1 ? controls.reason.options[1].id : null;\r\n\t\tconst occupation = controls.occupation.options.length > 1 ? controls.occupation.options[1].id : null;\r\n\t\tconst country = controls.country.options.length > 1 ? controls.country.options[1].id : null;\r\n\t\tform.patch({\r\n\t\t\treason: reason,\r\n\t\t\tfirstName: 'Jhon',\r\n\t\t\tlastName: 'Appleseed',\r\n\t\t\temail: 'jhonappleseed@gmail.com',\r\n\t\t\toccupation: occupation,\r\n\t\t\tcountry: country,\r\n\t\t\tcity: 'Pesaro',\r\n\t\t\tprivacy: true,\r\n\t\t\tnewsletter: false,\r\n\t\t\tcommercial: false,\r\n\t\t\tpromotion: false,\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: ''\r\n\t\t});\r\n\t}\r\n\r\n\treset() {\r\n\t\tconst form = this.form;\r\n\t\tform.reset();\r\n\t}\r\n\r\n\tonSubmit(model) {\r\n\t\tconst form = this.form;\r\n\t\tconsole.log('ProductsDetailRequestComponent.onSubmit', form.value);\r\n\t\t// console.log('ProductsDetailRequestComponent.onSubmit', 'form.valid', valid);\r\n\t\tif (form.valid) {\r\n\t\t\t// console.log('ProductsDetailRequestComponent.onSubmit', form.value);\r\n\t\t\tform.submitted = true;\r\n\t\t\tProductsDetailService.submit$(form.value).pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t).subscribe(response => {\r\n\t\t\t\tthis.response = response;\r\n\t\t\t\tthis.success = true;\r\n\t\t\t\tform.reset();\r\n\t\t\t\tGtmService.push({\r\n\t\t\t\t\t'event': \"ProductsDetailRequest\",\r\n\t\t\t\t\t'form_name': \"ProductsDetailRequest\"\r\n\t\t\t\t});\r\n\t\t\t}, error => {\r\n\t\t\t\tconsole.log('ProductsDetailRequestComponent.error', error);\r\n\t\t\t\tthis.error = error;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t\tLocomotiveScrollService.update();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tform.touched = true;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nProductsDetailRequestComponent.meta = {\r\n\tselector: '[products-detail-request]',\r\n\tinputs: ['product'],\r\n};\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { first, takeUntil } from 'rxjs/operators';\r\nimport { GtmService } from '../../common/gtm/gtm.service';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { ModalResolveEvent, ModalService } from '../../common/modal/modal.service';\r\nimport { environment } from '../../environment';\r\nimport { CartMiniService } from '../../shared/cart-mini/cart-mini.service';\r\nimport { HeaderService } from '../../shared/header/header.service';\r\nimport { UserService } from '../../shared/user/user.service';\r\nimport { CartService } from '../cart/cart.service';\r\nimport { ProductsDetailService } from './products-detail.service';\r\n\r\nexport class ProductsDetailComponent extends Component {\r\n\r\n\tget firstConfigurableVersion() {\r\n\t\treturn this.items && this.items.find(x => x.configurable);\r\n\t}\r\n\r\n\tonInit() {\r\n\t\tthis.items = [];\r\n\t\tthis.visibleItems = [];\r\n\t\tProductsDetailService.versions$(this.product.id).pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe(items => {\r\n\t\t\tthis.items = items;\r\n\t\t\tthis.visibleItems = this.items.slice(0, Math.min(4, this.items.length));\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t\tGtmService.push({ 'pageCategory': 'Scheda Prodotto' });\r\n\t}\r\n\r\n\tisAddedToCart(item) {\r\n\t\treturn CartMiniService.hasItem(item);\r\n\t}\r\n\r\n\tonAddToCart(item) {\r\n\t\tif (this.isAddedToCart(item)) {\r\n\t\t\tHeaderService.setHeader('cart');\r\n\t\t} else {\r\n\t\t\t// resetting purchase procedure\r\n\t\t\tCartService.setCart(null);\r\n\t\t\t// getting showefy price and adding to mini cart\r\n\t\t\tCartMiniService.getPriceAndAddItem$(item).pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t).subscribe(_ => {\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tscrollTo(id) {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst target = node.querySelector(id);\r\n\t\tif (target) {\r\n\t\t\tLocomotiveScrollService.scrollTo(target, { offset: -200 });\r\n\t\t}\r\n\t}\r\n\r\n\tshowMore(event) {\r\n\t\tconst pageSize = 12;\r\n\t\tif (this.visibleItems.length + pageSize >= this.items.length) {\r\n\t\t\tthis.visibleItems = this.items.slice();\r\n\t\t} else {\r\n\t\t\tthis.visibleItems = this.items.slice(0, Math.min(this.visibleItems.length + pageSize, this.items.length));\r\n\t\t}\r\n\t\tthis.pushChanges();\r\n\t\tLocomotiveScrollService.update();\r\n\t}\r\n\r\n\tconfigureProduct(version) {\r\n\t\tversion = version || this.firstConfigurableVersion;\r\n\t\tif (!version) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (environment.flags.production) {\r\n\t\t\twindow.location.href = `${this.product.url}/config?productId=${version.productId}&code=${version.code}${version.familyCode ? `&familyCode=${version.familyCode}` : ''}`;\r\n\t\t} else {\r\n\t\t\twindow.location.href = `${environment.slug.configureProduct}?productId=${version.productId}&code=${version.code}${version.familyCode ? `&familyCode=${version.familyCode}` : ''}`;\r\n\t\t}\r\n\t}\r\n\r\n\tonRequestInfo() {\r\n\t\tModalService.open$({ src: environment.template.modal.productsDetailRequestModal, data: { product: this.product } }).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe(event => {\r\n\t\t\tconsole.log('ProductsDetailComponent.onRequestInfo', event);\r\n\t\t\t/*\r\n\t\t\tif (event instanceof ModalResolveEvent) {\r\n\t\t\t\t// info requested!\r\n\t\t\t}\r\n\t\t\t*/\r\n\t\t});\r\n\t}\r\n\r\n\tonReservedArea() {\r\n\t\tUserService.me$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe(user => {\r\n\t\t\tif (user) {\r\n\t\t\t\twindow.location.href = environment.slug.reservedArea;\r\n\t\t\t} else {\r\n\t\t\t\tModalService.open$({ src: environment.template.modal.userModal, data: { view: 1 } }).pipe(\r\n\t\t\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t\t\t).subscribe(event => {\r\n\t\t\t\t\tconsole.log('ProductsDetailComponent.onLogin', event);\r\n\t\t\t\t\tif (event instanceof ModalResolveEvent) {\r\n\t\t\t\t\t\twindow.location.href = environment.slug.reservedArea;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nProductsDetailComponent.meta = {\r\n\tselector: '[products-detail]',\r\n\tinputs: ['product'],\r\n};\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { ModalOutletComponent } from '../../common/modal/modal-outlet.component';\r\nimport { ModalService } from '../../common/modal/modal.service';\r\n\r\nexport class ProjectsRegistrationModalComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tconst { parentInstance } = getContext(this);\r\n\t\tif (parentInstance instanceof ModalOutletComponent) {\r\n\t\t\tconst data = parentInstance.modal.data;\r\n\t\t}\r\n\t\tLocomotiveScrollService.stop();\r\n\t}\r\n\r\n\tonClose() {\r\n\t\tModalService.reject();\r\n\t}\r\n\r\n\tonDestroy() {\r\n\t\tLocomotiveScrollService.start();\r\n\t}\r\n}\r\n\r\nProjectsRegistrationModalComponent.meta = {\r\n\tselector: '[projects-registration-modal]'\r\n};\r\n","import { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class ProjectsRegistrationService {\r\n\r\n\tstatic data$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/projects-registration/data');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/projects-registration/data.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic submit$(payload) {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.post$('/projects-registration/submit', payload);\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/projects-registration/submit.json');\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { Component } from 'rxcomp';\r\nimport { FormControl, FormGroup, Validators } from 'rxcomp-form';\r\nimport { first, takeUntil, tap } from 'rxjs/operators';\r\nimport { GtmService } from '../../common/gtm/gtm.service';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { FormService } from '../../controls/form.service';\r\nimport { ProjectsRegistrationService } from './projects-registration.service';\r\n\r\nexport class ProjectsRegistrationComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.error = null;\r\n\t\tthis.success = false;\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\tdealer: new FormGroup({\r\n\t\t\t\tfullName: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t\tcountry: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t\tcity: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t}),\r\n\t\t\tclient: new FormGroup({\r\n\t\t\t\tfullName: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t\tcountry: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t\tcity: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t}),\r\n\t\t\tarchitect: new FormGroup({\r\n\t\t\t\tfullName: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t\tcountry: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t\tcity: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t\temail: new FormControl(null, [Validators.RequiredValidator(), Validators.EmailValidator()]),\r\n\t\t\t\ttelephone: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t}),\r\n\t\t\ttype: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tdestination: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tproducts: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tpicture: new FormControl(null),\r\n\t\t\tprivacy: new FormControl(null, [Validators.RequiredTrueValidator()]),\r\n\t\t\t// newsletter: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t// commercial: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t// promotion: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\t// newsletterLanguage: new FormControl(null, [RequiredIfValidator(() => Boolean(this.form.value.newsletter))]),\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: '',\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tform.changes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe((_) => {\r\n\t\t\tthis.pushChanges();\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t});\r\n\t\tthis.load$().pipe(\r\n\t\t\tfirst(),\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn ProjectsRegistrationService.data$().pipe(\r\n\t\t\ttap(data => {\r\n\t\t\t\tconst controls = this.controls;\r\n\t\t\t\tcontrols.dealer.controls.country.options = FormService.toSelectOptions(data.country.options);\r\n\t\t\t\tcontrols.client.controls.country.options = FormService.toSelectOptions(data.country.options);\r\n\t\t\t\tcontrols.architect.controls.country.options = FormService.toSelectOptions(data.country.options);\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\ttest() {\r\n\t\tconst form = this.form;\r\n\t\tconst controls = this.controls;\r\n\t\tconst country = controls.dealer.controls.country.options.length > 1 ? controls.dealer.controls.country.options[1].id : null;\r\n\t\tform.patch({\r\n\t\t\tdealer: {\r\n\t\t\t\tfullName: 'Agente Jhon Appleseed',\r\n\t\t\t\tcountry: country,\r\n\t\t\t\tcity: 'Pesaro',\r\n\t\t\t},\r\n\t\t\tclient: {\r\n\t\t\t\tfullName: 'Cliente Jhon Appleseed',\r\n\t\t\t\tcountry: country,\r\n\t\t\t\tcity: 'Pesaro',\r\n\t\t\t},\r\n\t\t\tarchitect: {\r\n\t\t\t\tfullName: 'Architetto Jhon Appleseed',\r\n\t\t\t\tcountry: country,\r\n\t\t\t\tcity: 'Pesaro',\r\n\t\t\t\temail: 'jhonappleseed@gmail.com',\r\n\t\t\t\ttelephone: '0721411112',\r\n\t\t\t},\r\n\t\t\ttype: 'Hotel',\r\n\t\t\tdestination: 'Hospitality',\r\n\t\t\tproducts: 'Adam, Clop',\r\n\t\t\tprivacy: true,\r\n\t\t});\r\n\t}\r\n\r\n\treset() {\r\n\t\tconst form = this.form;\r\n\t\tform.reset();\r\n\t}\r\n\r\n\tonSubmit() {\r\n\t\tconst form = this.form;\r\n\t\tconsole.log('ProjectsRegistrationComponent.onSubmit', form.value);\r\n\t\tif (form.valid) {\r\n\t\t\tform.submitted = true;\r\n\t\t\tProjectsRegistrationService.submit$(form.value).pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t).subscribe(response => {\r\n\t\t\t\tconsole.log('ProjectsRegistrationComponent.onSubmit', response);\r\n\t\t\t\tthis.success = true;\r\n\t\t\t\tGtmService.push({\r\n\t\t\t\t\t'event': \"Project Registration\",\r\n\t\t\t\t\t'form_name': \"Registrazione Progetto\"\r\n\t\t\t\t});\r\n\t\t\t\tif (!this.isModal) {\r\n\t\t\t\t\tform.reset();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.pushChanges();\r\n\t\t\t\t}\r\n\t\t\t}, error => {\r\n\t\t\t\tconsole.log('ProjectsRegistrationComponent.error', error);\r\n\t\t\t\tthis.error = error;\r\n\t\t\t\tform.submitted = false;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t\tLocomotiveScrollService.update();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tform.touched = true;\r\n\t\t}\r\n\t}\r\n\r\n\tonClose() {\r\n\t\tthis.close.next(this.form.value);\r\n\t}\r\n}\r\n\r\nProjectsRegistrationComponent.meta = {\r\n\tselector: '[projects-registration]',\r\n\toutputs: ['close'],\r\n\tinputs: ['isModal'],\r\n};\r\n","import { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class ProjectsService {\r\n\r\n\tstatic all$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/projects/all');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/projects/all.json');\r\n\t\t}\r\n\t}\r\n\r\n\tstatic filters$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/projects/filters');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/projects/filters.json');\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { combineLatest } from 'rxjs';\r\nimport { FiltersComponent } from '../../shared/filters/filters.component';\r\nimport { ProjectsService } from './projects.service';\r\n\r\nexport class ProjectsComponent extends FiltersComponent {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tthis.categoryId = this.categoryId || null;\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn combineLatest([\r\n\t\t\tProjectsService.all$(),\r\n\t\t\tProjectsService.filters$(),\r\n\t\t]);\r\n\t}\r\n\r\n\tsetFiltersParams() {\r\n\t\tif (this.categoryId) {\r\n\t\t\tthis.filters.category.set({ value: this.categoryId });\r\n\t\t}\r\n\t}\r\n\r\n\tdoFilterItem(key, item, value) {\r\n\t\tswitch (key) {\r\n\t\t\tcase 'category':\r\n\t\t\t\treturn item.category.id === value;\r\n\t\t\tcase 'search':\r\n\t\t\t\treturn item.title.toLowerCase().indexOf(value.toLowerCase()) !== -1 ||\r\n\t\t\t\t\titem.country.toLowerCase().indexOf(value.toLowerCase()) !== -1;\r\n\t\t\tdefault:\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nProjectsComponent.meta = {\r\n\tselector: '[projects]',\r\n\tinputs: ['categoryId'],\r\n};\r\n","import { BehaviorSubject, of } from 'rxjs';\r\nimport { map, switchMap } from 'rxjs/operators';\r\nimport { LocalStorageService } from '../../common/storage/local-storage.service';\r\n\r\nexport class FilesService {\r\n\r\n\tstatic files$_ = new BehaviorSubject([]);\r\n\r\n\tstatic get currentFiles() {\r\n\t\treturn this.files$_.getValue();\r\n\t}\r\n\r\n\tstatic hasFile(file) {\r\n\t\tconst files = this.currentFiles;\r\n\t\tconst index = files.reduce((p, c, i) => {\r\n\t\t\treturn p !== -1 ? p : (c.id === file.id ? i : p);\r\n\t\t}, -1);\r\n\t\treturn index !== -1;\r\n\t}\r\n\r\n\tstatic setFiles(files) {\r\n\t\tif (files) {\r\n\t\t\tLocalStorageService.set('files', files);\r\n\t\t} else {\r\n\t\t\tLocalStorageService.delete('files');\r\n\t\t}\r\n\t\tthis.files$_.next(files);\r\n\t}\r\n\r\n\tstatic files$() {\r\n\t\tconst localFiles = LocalStorageService.get('files') || [];\r\n\t\treturn of(localFiles).pipe(\r\n\t\t\tswitchMap(files => {\r\n\t\t\t\tthis.setFiles(files);\r\n\t\t\t\treturn this.files$_;\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tstatic addFile$(file) {\r\n\t\treturn of(file).pipe(\r\n\t\t\tmap(file => {\r\n\t\t\t\tconst files = this.currentFiles.slice();\r\n\t\t\t\tconst index = files.reduce((p, c, i) => {\r\n\t\t\t\t\treturn p !== -1 ? p : (c.id === file.id ? i : p);\r\n\t\t\t\t}, -1);\r\n\t\t\t\tif (index === -1) {\r\n\t\t\t\t\tfiles.push(file);\r\n\t\t\t\t\tthis.setFiles(files);\r\n\t\t\t\t\treturn file;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t)\r\n\t}\r\n\r\n\tstatic removeFile$(file) {\r\n\t\treturn of(file).pipe(\r\n\t\t\tmap(file => {\r\n\t\t\t\tconst files = this.currentFiles.slice();\r\n\t\t\t\tconst index = files.reduce((p, c, i) => {\r\n\t\t\t\t\treturn p !== -1 ? p : (c.id === file.id ? i : p);\r\n\t\t\t\t}, -1);\r\n\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\tfiles.splice(index, 1);\r\n\t\t\t\t\tthis.setFiles(files);\r\n\t\t\t\t\treturn file;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t)\r\n\t}\r\n\r\n\tstatic removeAll$() {\r\n\t\treturn of([]).pipe(\r\n\t\t\tmap(files => {\r\n\t\t\t\tthis.setFiles(files);\r\n\t\t\t\treturn files;\r\n\t\t\t}),\r\n\t\t)\r\n\t}\r\n\r\n}\r\n","import { combineLatest } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\nimport { FilesService } from '../../shared/files/files.service';\r\n\r\nexport class ReservedAreaService {\r\n\r\n\tstatic all$() {\r\n\t\treturn (\r\n\t\t\tenvironment.flags.production ?\r\n\t\t\t\tApiService.post$(`/reserved-area/all`) :\r\n\t\t\t\tApiService.get$(`/reserved-area/all.json`)\r\n\t\t).pipe(\r\n\t\t\tmap(items => {\r\n\t\t\t\titems.forEach(x => {\r\n\t\t\t\t\tx.title = ReservedAreaService.toTitleCase(x.title.replace(/_/g, ' '));\r\n\t\t\t\t});\r\n\t\t\t\treturn items;\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n\tstatic all_$() {\r\n\t\treturn combineLatest([ReservedAreaService.get$(), FilesService.files$()]).pipe(\r\n\t\t\tmap(data => {\r\n\t\t\t\tconst items = data[0];\r\n\t\t\t\tconst files = data[1];\r\n\t\t\t\titems.forEach(item => {\r\n\t\t\t\t\tif (files.find(x => x.id === item.id)) {\r\n\t\t\t\t\t\titem.added = true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\titem.added = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn items;\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tstatic toTitleCase(sentence, seps = ' _-/') {\r\n\t\tconst capitalize = str => str.length ? str[0].toUpperCase() + str.slice(1).toLowerCase() : '';\r\n\t\tconst escape = str => str.replace(/./g, c => `\\\\${c}`);\r\n\t\tlet wordPattern = new RegExp(`[^${escape(seps)}]+`, 'g');\r\n\t\treturn sentence.replace(wordPattern, capitalize);\r\n\t}\r\n\r\n}\r\n","import { Component } from 'rxcomp';\r\nimport { of } from 'rxjs';\r\nimport { first, switchMap, takeUntil, tap } from 'rxjs/operators';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { ModalService } from '../../common/modal/modal.service';\r\nimport { environment } from '../../environment';\r\nimport { FilesService } from '../../shared/files/files.service';\r\nimport { UserService } from '../../shared/user/user.service';\r\nimport { ReservedAreaService } from './reserved-area.service';\r\n\r\nexport class ReservedAreaComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.user = undefined;\r\n\t\tthis.items = [];\r\n\t\tthis.tree = [];\r\n\t\tthis.files = [];\r\n\t\tthis.visibleFiles = [];\r\n\t\tthis.item = null;\r\n\t\tthis.downloadBusy = false;\r\n\t\tthis.load$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn UserService.me$().pipe(\r\n\t\t\tswitchMap(user => {\r\n\t\t\t\tthis.user = user;\r\n\t\t\t\tthis.downloadBusy = true;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t\t// LocomotiveScrollService.update();\r\n\t\t\t\treturn user ? ReservedAreaService.all$() : of([]);\r\n\t\t\t}),\r\n\t\t\ttap(items => {\r\n\t\t\t\tthis.items = items;\r\n\t\t\t\tthis.tree = this.getTree(items);\r\n\t\t\t\tthis.visibleFiles = [];\r\n\t\t\t\tthis.item = null;\r\n\t\t\t\tthis.downloadBusy = false;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t\t// LocomotiveScrollService.update();\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n\tgetTree(items, parentId) {\r\n\t\tlet tree = items.filter(x => x.parentId === parentId && x.type === 'folder').map(x => {\r\n\t\t\tconst item = Object.assign({}, x);\r\n\t\t\titem.items = this.getTree(items, x.id);\r\n\t\t\treturn item;\r\n\t\t});\r\n\t\treturn tree;\r\n\t}\r\n\r\n\tonOpen(item) {\r\n\t\tif (item.active) {\r\n\t\t\tthis.item = item;\r\n\t\t\tthis.files = this.items.filter(x => x.type === 'file' && x.parentId === item.id);\r\n\t\t\tthis.visibleFiles = this.files.slice(0, Math.min(8, this.files.length));\r\n\t\t\tthis.pushChanges();\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t}\r\n\t}\r\n\r\n\tshowMore(event) {\r\n\t\tconst pageSize = 32;\r\n\t\tif (this.visibleFiles.length + pageSize >= this.files.length) {\r\n\t\t\tthis.visibleFiles = this.files.slice();\r\n\t\t} else {\r\n\t\t\tthis.visibleFiles = this.files.slice(0, Math.min(this.visibleFiles.length + pageSize, this.files.length));\r\n\t\t}\r\n\t\tthis.pushChanges();\r\n\t\tLocomotiveScrollService.update();\r\n\t}\r\n\r\n\tonProjectRegistration(event) {\r\n\t\tModalService.open$({ src: environment.template.modal.projectsRegistrationModal }).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(event => {\r\n\t\t\tconsole.log('ReservedAreaComponent.onProjectRegistration', event);\r\n\t\t});\r\n\t}\r\n\r\n\tonToggleFile(file) {\r\n\t\t(this.isAddedToFiles(file) ? FilesService.removeFile$(file) : FilesService.addFile$(file)).pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe(_ => {\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t}\r\n\r\n\tisAddedToFiles(file) {\r\n\t\treturn FilesService.hasFile(file);\r\n\t}\r\n\r\n\tonLogout() {\r\n\t\tUserService.signout$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t}\r\n}\r\n\r\nReservedAreaComponent.meta = {\r\n\tselector: '[reserved-area]',\r\n};\r\n","\r\nexport class MapService {\r\n\r\n\tstatic findNearStores(items, center) {\r\n\t\tif (items) {\r\n\t\t\titems = items.slice();\r\n\t\t\titems.forEach((item) => {\r\n\t\t\t\titem.distance = this.calculateDistance(item.latitude, item.longitude, center.lat, center.lng, 'K');\r\n\t\t\t\t// item.visible = (item.cod_stato == window.userCountry || !window.userCountry) && item.distance <= MAX_DISTANCE /* Km */;\r\n\t\t\t});\r\n\t\t\titems.sort((a, b) => {\r\n\t\t\t\treturn a.distance - b.distance;\r\n\t\t\t});\r\n\t\t\treturn items;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic calculateDistances(items, center) {\r\n\t\tif (items) {\r\n\t\t\titems.forEach((item) => {\r\n\t\t\t\titem.distance = this.calculateDistance(item.latitude, item.longitude, center.lat, center.lng, 'K');\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn items;\r\n\t}\r\n\r\n\tstatic calculateDistance(lat1, lon1, lat2, lon2, unit) {\r\n\t\tif ((lat1 == lat2) && (lon1 == lon2)) {\r\n\t\t\treturn 0;\r\n\t\t} else {\r\n\t\t\tconst radlat1 = Math.PI * lat1 / 180;\r\n\t\t\tconst radlat2 = Math.PI * lat2 / 180;\r\n\t\t\tconst theta = lon1 - lon2;\r\n\t\t\tconst radtheta = Math.PI * theta / 180;\r\n\t\t\tlet dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);\r\n\t\t\tif (dist > 1) {\r\n\t\t\t\tdist = 1;\r\n\t\t\t}\r\n\t\t\tdist = Math.acos(dist);\r\n\t\t\tdist = dist * 180 / Math.PI;\r\n\t\t\tdist = dist * 60 * 1.1515;\r\n\t\t\tif (unit == \"K\") {\r\n\t\t\t\tdist = dist * 1.609344;\r\n\t\t\t}\r\n\t\t\tif (unit == \"N\") {\r\n\t\t\t\tdist = dist * 0.8684;\r\n\t\t\t}\r\n\t\t\treturn dist;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic getBounds(items, count = Number.POSITIVE_INFINITY) {\r\n\t\tconst bounds = new google.maps.LatLngBounds();\r\n\t\titems.forEach((item, i) => {\r\n\t\t\tif (i < count) {\r\n\t\t\t\tconst position = new google.maps.LatLng(item.latitude, item.longitude);\r\n\t\t\t\tbounds.extend(position);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn bounds;\r\n\t}\r\n\r\n}\r\n","import { map } from 'rxjs/operators';\r\nimport { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class StoreLocatorService {\r\n\r\n\tstatic all$() {\r\n\t\treturn (\r\n\t\t\tenvironment.flags.production ?\r\n\t\t\t\tApiService.get$(`/store-locator/all`) :\r\n\t\t\t\tApiService.get$(`/store-locator/all.json`)\r\n\t\t).pipe(\r\n\t\t\tmap(items => items.sort((a, b) => {\r\n\t\t\t\treturn a.rank - b.rank;\r\n\t\t\t})),\r\n\t\t);\r\n\t}\r\n\r\n\tstatic filters$() {\r\n\t\tif (environment.flags.production) {\r\n\t\t\treturn ApiService.get$('/store-locator/filters');\r\n\t\t} else {\r\n\t\t\treturn ApiService.get$('/store-locator/filters.json');\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","import { FormControl } from 'rxcomp-form';\r\nimport { combineLatest } from 'rxjs';\r\nimport { map, takeUntil, tap } from 'rxjs/operators';\r\nimport { GoogleMapsService } from '../../common/googlemaps/googlemaps.service';\r\nimport { environment } from '../../environment';\r\nimport { MapService } from '../../partials/map/map.service';\r\nimport { FiltersComponent } from '../../shared/filters/filters.component';\r\nimport { StoreLocatorService } from './store-locator.service';\r\n\r\nexport class StoreLocatorComponent extends FiltersComponent {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tthis.autocomplete$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn combineLatest([\r\n\t\t\tStoreLocatorService.all$(),\r\n\t\t\tStoreLocatorService.filters$().pipe(\r\n\t\t\t\tmap(filters => {\r\n\t\t\t\t\tdelete filters.search;\r\n\t\t\t\t\tdelete filters.country;\r\n\t\t\t\t\tfilters.bounds = {\r\n\t\t\t\t\t\tlabel: 'Bounds',\r\n\t\t\t\t\t\tmode: 'query',\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn filters;\r\n\t\t\t\t}),\r\n\t\t\t),\r\n\t\t]);\r\n\t}\r\n\r\n\tonLoaded() {\r\n\t\tconst search = this.filters.search;\r\n\t\tif (search && search.values.length) {\r\n\t\t\tconst value = search.values[0];\r\n\t\t\t// console.log('StoreLocatorCompoent.onLoaded', value);\r\n\t\t\tthis.autocomplete.value = value;\r\n\t\t}\r\n\t\tif (environment.detectedCountry) {\r\n\t\t\tthis.geocode$({ address: environment.detectedCountry }, 'country').subscribe(place => {\r\n\t\t\t\tthis.autocomplete.value = place;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tautocompleteSource$(query) {\r\n\t\treturn GoogleMapsService.autocomplete$(query);\r\n\t}\r\n\r\n\tautocomplete$() {\r\n\t\tconst autocomplete = this.autocomplete = new FormControl(null);\r\n\t\treturn autocomplete.changes$.pipe(\r\n\t\t\ttap(value => {\r\n\t\t\t\tlet place;\r\n\t\t\t\tif (value) {\r\n\t\t\t\t\tif (value.geometry) {\r\n\t\t\t\t\t\tthis.setPlace(value);\r\n\t\t\t\t\t} else if (typeof value.getDetails === 'function' && this.map) {\r\n\t\t\t\t\t\tvalue.getDetails(this.map).then(place => {\r\n\t\t\t\t\t\t\t// console.log('StoreLocatorComponent.autocomplete.getDetails', place);\r\n\t\t\t\t\t\t\tplace = {\r\n\t\t\t\t\t\t\t\tname: value.name,\r\n\t\t\t\t\t\t\t\tgeometry: place.geometry,\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tthis.setPlace(place);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tplace = null;\r\n\t\t\t\t\tthis.setPlace(place);\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n\tsetPlace(place) {\r\n\t\tif (this.filters && this.filters.bounds) {\r\n\t\t\tthis.filters.bounds.set(null);\r\n\t\t}\r\n\t\tconst items = this.filteredItems;\r\n\t\tconst map = this.map;\r\n\t\tif (map) {\r\n\t\t\tif (place) {\r\n\t\t\t\tlet minimumBounds = null;\r\n\t\t\t\tif (items.length >= 2) {\r\n\t\t\t\t\tconst center = place.geometry.location;\r\n\t\t\t\t\tcenter.lat = center.lat();\r\n\t\t\t\t\tcenter.lng = center.lng();\r\n\t\t\t\t\tMapService.calculateDistances(items, center);\r\n\t\t\t\t\tthis.doSortItemsByDistance(items);\r\n\t\t\t\t\tminimumBounds = new google.maps.LatLngBounds();\r\n\t\t\t\t\tfor (let i = 0; i < 2; i++) {\r\n\t\t\t\t\t\tconst item = items[i];\r\n\t\t\t\t\t\t// console.log(item);\r\n\t\t\t\t\t\tlet lat = item.latitude;\r\n\t\t\t\t\t\tlet lng = item.longitude;\r\n\t\t\t\t\t\tconst p1 = new google.maps.LatLng(lat, lng);\r\n\t\t\t\t\t\tminimumBounds.extend(p1);\r\n\t\t\t\t\t\tlet lat2 = center.lat + (center.lat - lat);\r\n\t\t\t\t\t\tlet lng2 = center.lng + (center.lng - lng);\r\n\t\t\t\t\t\tconst p2 = new google.maps.LatLng(lat2, lng2);\r\n\t\t\t\t\t\tminimumBounds.extend(p2);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (place.geometry.viewport || minimumBounds) {\r\n\t\t\t\t\tlet bounds = place.geometry.viewport;\r\n\t\t\t\t\tif (minimumBounds) {\r\n\t\t\t\t\t\tbounds = bounds.union(minimumBounds);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgoogle.maps.event.addListenerOnce(map, 'zoom_changed', function() {\r\n\t\t\t\t\t\tmap.setZoom(Math.min(11, map.getZoom()));\r\n\t\t\t\t\t});\r\n\t\t\t\t\tmap.fitBounds(bounds, 0);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmap.setCenter(place.geometry.location);\r\n\t\t\t\t\tmap.setZoom(11);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconst bounds = MapService.getBounds(items);\r\n\t\t\t\tgoogle.maps.event.addListenerOnce(map, 'zoom_changed', function() {\r\n\t\t\t\t\tmap.setZoom(Math.min(11, map.getZoom()));\r\n\t\t\t\t});\r\n\t\t\t\tmap.fitBounds(bounds);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.place = place;\r\n\t}\r\n\r\n\tdoFilterItem(key, item, value) {\r\n\t\tswitch (key) {\r\n\t\t\tcase 'country':\r\n\t\t\t\treturn item.country && item.country.id === value;\r\n\t\t\tcase 'category':\r\n\t\t\t\treturn item.category && item.category.id === value;\r\n\t\t\tcase 'bounds':\r\n\t\t\t\tif (value && typeof value.contains === 'function') {\r\n\t\t\t\t\tconst position = new google.maps.LatLng(item.latitude, item.longitude);\r\n\t\t\t\t\treturn value.contains(position);\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\tcase 'search':\r\n\t\t\t\treturn true;\r\n\t\t\t/*\r\n\t\t\treturn item.name.toLowerCase().indexOf(value.toLowerCase()) !== -1 ||\r\n\t\t\t\t// item.address.toLowerCase().indexOf(value.toLowerCase()) !== -1 ||\r\n\t\t\t\titem.city.toLowerCase().indexOf(value.toLowerCase()) !== -1 ||\r\n\t\t\t\titem.country.name.toLowerCase().indexOf(value.toLowerCase()) !== -1;\r\n\t\t\t\t*/\r\n\t\t\tdefault:\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tdoSortItemsByDistance(items) {\r\n\t\t// console.log('StoreLocatorComponent.doSortItemsByDistance');\r\n\t\titems.sort((a, b) => {\r\n\t\t\treturn a.distance - b.distance;\r\n\t\t});\r\n\t\treturn items;\r\n\t}\r\n\r\n\tdoSortItemsByRank(items) {\r\n\t\t// console.log('StoreLocatorComponent.doSortItemsByRank');\r\n\t\tconst ranks = { 9: 100, 8: 50, 10: 0, 11: 0 };\r\n\t\titems.sort((a, b) => {\r\n\t\t\tconst categoryA = ranks[a.category.id] || 0;\r\n\t\t\tconst categoryB = ranks[b.category.id] || 0;\r\n\t\t\tconst categorySort = categoryB - categoryA;\r\n\t\t\tif (categorySort !== 0) {\r\n\t\t\t\treturn categorySort;\r\n\t\t\t}\r\n\t\t\tconst countrNameA = a.country.name;\r\n\t\t\tconst countrNameB = b.country.name;\r\n\t\t\tif (countrNameA > countrNameB) return 1;\r\n\t\t\tif (countrNameA < countrNameB) return -1;\r\n\t\t\tconst cityNameA = a.city;\r\n\t\t\tconst cityNameB = b.city;\r\n\t\t\tif (cityNameA > cityNameB) return 1;\r\n\t\t\tif (cityNameA < cityNameB) return -1;\r\n\t\t\treturn a.rank - b.rank;\r\n\t\t});\r\n\t\treturn items;\r\n\t}\r\n\r\n\tdoSortItems(items) {\r\n\t\tconst bounds = this.bounds;\r\n\t\tif (bounds) {\r\n\t\t\t/*\r\n\t\t\tconst center = bounds.getCenter();\r\n\t\t\tcenter.lat = center.lat();\r\n\t\t\tcenter.lng = center.lng();\r\n\t\t\tMapService.calculateDistances(items, center);\r\n\t\t\t*/\r\n\t\t\titems = this.doSortItemsByDistance(items);\r\n\t\t} else {\r\n\t\t\titems = this.doSortItemsByRank(items);\r\n\t\t}\r\n\t\t// items = this.place ? this.doSortItemsByDistance(items) : this.doSortItemsByRank(items);\r\n\t\treturn items;\r\n\t}\r\n\r\n\tonMapReady(mapController) {\r\n\t\tthis.mapController = mapController;\r\n\t\tthis.map = mapController.map;\r\n\t}\r\n\r\n\tonMapDidChange(bounds) {\r\n\t\tthis.bounds = bounds;\r\n\t\t// console.log('StoreLocatorComponent.onMapDidChange', bounds, this.filters);\r\n\t\tif (this.filters.bounds) {\r\n\t\t\tthis.filters.bounds.set(bounds);\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\tshowMore(event) {\r\n\t\tlet filteredItems = this.filteredItems;\r\n\t\tif (this.map) {\r\n\t\t\tfilteredItems = this.filteredItems.filter(item => {\r\n\t\t\t\tconst position = new google.maps.LatLng(item.latitude, item.longitude);\r\n\t\t\t\treturn bounds.contains(position);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (this.visibleItems.length + this.pageSize >= filteredItems.length) {\r\n\t\t\tthis.visibleItems = filteredItems.slice();\r\n\t\t} else {\r\n\t\t\tthis.visibleItems = filteredItems.slice(0, Math.min(this.visibleItems.length + this.pageSize, filteredItems.length));\r\n\t\t}\r\n\t\tthis.pushChanges();\r\n\t\tLocomotiveScrollService.update();\r\n\t}\r\n\t*/\r\n\r\n\thasGeolocation() {\r\n\t\treturn this.map && navigator.geolocation;\r\n\t}\r\n\r\n\tonGeolocation(event) {\r\n\t\t// Try HTML5 geolocation.\r\n\t\tif (navigator.geolocation) {\r\n\t\t\tnavigator.geolocation.getCurrentPosition((position) => {\r\n\t\t\t\tconst location = {\r\n\t\t\t\t\tlat: position.coords.latitude,\r\n\t\t\t\t\tlng: position.coords.longitude,\r\n\t\t\t\t};\r\n\t\t\t\tthis.geocode$({ location }).subscribe(place => {\r\n\t\t\t\t\tthis.autocomplete.value = place;\r\n\t\t\t\t});\r\n\t\t\t}, (error) => {\r\n\t\t\t\tconsole.log('StoreLocatorComponent.onGeolocation.error', error);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole.log('Browser doesn\\'t support Geolocation');\r\n\t\t}\r\n\t}\r\n\r\n\tgeocode$(payload, type = 'administrative_area_level_3') {\r\n\t\treturn GoogleMapsService.geocode$(payload).pipe(\r\n\t\t\tmap(results => {\r\n\t\t\t\t// console.log('GoogleMapsService.geocode$', results);\r\n\t\t\t\tlet place = results.find(x => x.types.includes(type));\r\n\t\t\t\tconst address = place.address_components.find(x => x.types.includes(type));\r\n\t\t\t\tplace = {\r\n\t\t\t\t\tname: address ? address.long_name : 'current location',\r\n\t\t\t\t\tgeometry: place.geometry ? place.geometry : { location },\r\n\t\t\t\t}\r\n\t\t\t\t// console.log('StoreLocatorComponent.onGeolocation', place);\r\n\t\t\t\treturn place;\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nStoreLocatorComponent.meta = {\r\n\tselector: '[store-locator]',\r\n};\r\n","/**\n * Copyright 2019 Google LLC. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\nexport interface OverlayViewSafe extends google.maps.OverlayView {}\n\n/**\n * Extends an object's prototype by another's.\n *\n * @param type1 The Type to be extended.\n * @param type2 The Type to extend with.\n * @ignore\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction extend(type1: any, type2: any): void {\n  // eslint-disable-next-line prefer-const\n  for (let property in type2.prototype) {\n    type1.prototype[property] = type2.prototype[property];\n  }\n}\n\n/**\n * @ignore\n */\nexport class OverlayViewSafe {\n  constructor() {\n    // MarkerClusterer implements google.maps.OverlayView interface. We use the\n    // extend function to extend MarkerClusterer with google.maps.OverlayView\n    // because it might not always be available when the code is defined so we\n    // look for it at the last possible moment. If it doesn't exist now then\n    // there is no point going ahead :)\n    extend(OverlayViewSafe, google.maps.OverlayView);\n  }\n}\n","/**\n * Copyright 2019 Google LLC. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * This class represents the object for values in the `styles` array passed\n * to the {@link MarkerClusterer} constructor. The element in this array that is used to\n * style the cluster icon is determined by calling the `calculator` function.\n */\nimport { Cluster } from \"./cluster\";\nimport { OverlayViewSafe } from \"./overlay-view-safe\";\n\n/**\n *\n * @hidden\n */\nfunction toCssText(styles: { [key: string]: string }): string {\n  return Object.keys(styles)\n    .reduce((acc, key) => {\n      if (styles[key]) {\n        acc.push(key + \":\" + styles[key]);\n      }\n      return acc;\n    }, [])\n    .join(\";\");\n}\n\n/**\n *\n * @hidden\n */\nfunction coercePixels(pixels: number): string {\n  return pixels ? pixels + \"px\" : undefined;\n}\n\nexport interface ClusterIconStyle {\n  /** The URL of the cluster icon image file. If not set, img element will not be created */\n  url?: string;\n  /** The name of the CSS class defining styles for the cluster markers. */\n  className?: string;\n  /** Height The display height (in pixels) of the cluster icon. Required. */\n  height: number;\n  /** Width The display width (in pixels) of the cluster icon. Required. */\n  width: number;\n  /**\n   * The position (in pixels) from the center of the cluster icon to\n   * where the text label is to be centered and drawn. The format is `[yoffset, xoffset]`\n   * where `yoffset` increases as you go down from center and `xoffset`\n   * increases to the right of center. The default is `[0, 0]`.\n   */\n  anchorText?: [number, number];\n  /**\n   * The anchor position (in pixels) of the cluster icon. This is the\n   * spot on the cluster icon that is to be aligned with the cluster position. The format is\n   * `[yoffset, xoffset]` where `yoffset` increases as you go down and\n   * `xoffset` increases to the right of the top-left corner of the icon. The default\n   * anchor position is the center of the cluster icon.\n   */\n  anchorIcon?: [number, number];\n  /**\n   * The color of the label text shown on the cluster icon.\n   * @default `\"black\"`\n   */\n  textColor?: string;\n  /** The size (in pixels) of the label text shown on the cluster icon.\n   * @default `11`\n   */\n  textSize?: number;\n\n  /** The line height (in pixels) of the label text shown on the cluster icon.\n   * @default the same as cluster icon height\n   */\n  textLineHeight?: number;\n  /**\n   * The value of the CSS `text-decoration`\n   * property for the label text shown on the cluster icon.\n   *\n   * @default `\"none\"`\n   */\n  textDecoration?: string;\n  /**\n   * The value of the CSS `font-weight`\n   * property for the label text shown on the cluster icon.\n   *\n   *  @default `\"bold\"`\n   */\n  fontWeight?: string;\n  /**\n   *  The value of the CSS `font-style`\n   *  property for the label text shown on the cluster icon.\n   *\n   *  @default `\"normal\"`\n   */\n  fontStyle?: string;\n  /**\n   *  The value of the CSS `font-family`\n   *  property for the label text shown on the cluster icon.\n   *  @default `\"Arial,sans-serif\"`\n   */\n  fontFamily?: string;\n  /**\n   * The position of the cluster icon image\n   * within the image defined by `url`. The format is `\"xpos ypos\"`\n   * (the same format as for the CSS `background-position` property). You must set\n   * this property appropriately when the image defined by `url` represents a sprite\n   * containing multiple images. Note that the position <i>must</i> be specified in px units.\n   *\n   * @default `\"0 0\"`\n   */\n  backgroundPosition?: string;\n}\n\n/**\n * @description This is an object containing general information about a cluster icon. This is\n *  the object that a `calculator` function returns.\n */\nexport interface ClusterIconInfo {\n  /**\n   * The text of the label to be shown on the cluster icon.\n   */\n  text: string;\n  /**\n   * The index plus 1 of the element in the `styles`\n   */\n  index: number;\n  /**\n   * The tooltip to display when the mouse moves over the cluster icon.\n   * If this value is `undefined` or `\"\"`, `title` is set to the\n   * value of the `title` property passed to the MarkerClusterer.\n   */\n  title: string;\n  /**\n   * An override for dynamic cluster icon url (if not provided, the component will use the default style icon)\n   */\n  url?: string;\n}\n\n/**\n * A cluster icon.\n */\nexport class ClusterIcon extends OverlayViewSafe {\n  private className_: string;\n  private center_: google.maps.LatLng = null;\n  private div_: HTMLDivElement = null;\n  private sums_: ClusterIconInfo = null;\n  private visible_ = false;\n\n  private style: ClusterIconStyle = null;\n\n  private anchorText_: [number, number];\n  private anchorIcon_: [number, number];\n\n  private boundsChangedListener_: google.maps.MapsEventListener;\n\n  /**\n   * @param cluster_ The cluster with which the icon is to be associated.\n   * @param styles_ An array of {@link ClusterIconStyle} defining the cluster icons\n   *  to use for various cluster sizes.\n   */\n  constructor(private cluster_: Cluster, private styles_: ClusterIconStyle[]) {\n    super();\n\n    this.setMap(cluster_.getMap()); // Note: this causes onAdd to be called\n  }\n\n  /**\n   * Adds the icon to the DOM.\n   */\n  onAdd(): void {\n    let cMouseDownInCluster: boolean;\n    let cDraggingMapByCluster: boolean;\n\n    const mc = this.cluster_.getMarkerClusterer();\n\n    const [major, minor] = google.maps.version.split(\".\");\n\n    const gmVersion = parseInt(major, 10) * 100 + parseInt(minor, 10);\n\n    this.div_ = document.createElement(\"div\");\n    if (this.visible_) {\n      this.show();\n    }\n\n    this.getPanes().overlayMouseTarget.appendChild(this.div_);\n\n    // Fix for Issue 157\n    this.boundsChangedListener_ = google.maps.event.addListener(\n      this.getMap(),\n      \"bounds_changed\",\n      () => {\n        cDraggingMapByCluster = cMouseDownInCluster;\n      }\n    );\n\n    google.maps.event.addDomListener(this.div_, \"mousedown\", () => {\n      cMouseDownInCluster = true;\n      cDraggingMapByCluster = false;\n    });\n\n    // March 1, 2018: Fix for this 3.32 exp bug, https://issuetracker.google.com/issues/73571522\n    // But it doesn't work with earlier releases so do a version check.\n    if (gmVersion >= 332) {\n      // Ugly version-dependent code\n      google.maps.event.addDomListener(this.div_, \"touchstart\", (e: Event) => {\n        e.stopPropagation();\n      });\n    }\n\n    google.maps.event.addDomListener(this.div_, \"click\", (e: Event) => {\n      cMouseDownInCluster = false;\n      if (!cDraggingMapByCluster) {\n        /**\n         * This event is fired when a cluster marker is clicked.\n         * @name MarkerClusterer#click\n         * @param {Cluster} c The cluster that was clicked.\n         * @event\n         */\n        google.maps.event.trigger(mc, \"click\", this.cluster_);\n        google.maps.event.trigger(mc, \"clusterclick\", this.cluster_); // deprecated name\n\n        // The default click handler follows. Disable it by setting\n        // the zoomOnClick property to false.\n        if (mc.getZoomOnClick()) {\n          // Zoom into the cluster.\n          const mz = mc.getMaxZoom();\n          const theBounds = this.cluster_.getBounds();\n          (mc.getMap() as google.maps.Map).fitBounds(theBounds);\n          // There is a fix for Issue 170 here:\n          setTimeout(() => {\n            (mc.getMap() as google.maps.Map).fitBounds(theBounds);\n            // Don't zoom beyond the max zoom level\n            if (mz !== null && mc.getMap().getZoom() > mz) {\n              mc.getMap().setZoom(mz + 1);\n            }\n          }, 100);\n        }\n\n        // Prevent event propagation to the map:\n        e.cancelBubble = true;\n        if (e.stopPropagation) {\n          e.stopPropagation();\n        }\n      }\n    });\n\n    google.maps.event.addDomListener(this.div_, \"mouseover\", () => {\n      /**\n       * This event is fired when the mouse moves over a cluster marker.\n       * @name MarkerClusterer#mouseover\n       * @param {Cluster} c The cluster that the mouse moved over.\n       * @event\n       */\n      google.maps.event.trigger(mc, \"mouseover\", this.cluster_);\n    });\n\n    google.maps.event.addDomListener(this.div_, \"mouseout\", () => {\n      /**\n       * This event is fired when the mouse moves out of a cluster marker.\n       * @name MarkerClusterer#mouseout\n       * @param {Cluster} c The cluster that the mouse moved out of.\n       * @event\n       */\n      google.maps.event.trigger(mc, \"mouseout\", this.cluster_);\n    });\n  }\n\n  /**\n   * Removes the icon from the DOM.\n   */\n  onRemove(): void {\n    if (this.div_ && this.div_.parentNode) {\n      this.hide();\n      google.maps.event.removeListener(this.boundsChangedListener_);\n      google.maps.event.clearInstanceListeners(this.div_);\n      this.div_.parentNode.removeChild(this.div_);\n      this.div_ = null;\n    }\n  }\n\n  /**\n   * Draws the icon.\n   */\n  draw(): void {\n    if (this.visible_) {\n      const pos = this.getPosFromLatLng_(this.center_);\n      this.div_.style.top = pos.y + \"px\";\n      this.div_.style.left = pos.x + \"px\";\n    }\n  }\n\n  /**\n   * Hides the icon.\n   */\n  hide(): void {\n    if (this.div_) {\n      this.div_.style.display = \"none\";\n    }\n    this.visible_ = false;\n  }\n\n  /**\n   * Positions and shows the icon.\n   */\n  show(): void {\n    if (this.div_) {\n      this.div_.className = this.className_;\n      this.div_.style.cssText = this.createCss_(\n        this.getPosFromLatLng_(this.center_)\n      );\n\n      this.div_.innerHTML =\n        (this.style.url ? this.getImageElementHtml() : \"\") +\n        this.getLabelDivHtml();\n\n      if (typeof this.sums_.title === \"undefined\" || this.sums_.title === \"\") {\n        this.div_.title = this.cluster_.getMarkerClusterer().getTitle();\n      } else {\n        this.div_.title = this.sums_.title;\n      }\n      this.div_.style.display = \"\";\n    }\n    this.visible_ = true;\n  }\n\n  private getLabelDivHtml(): string {\n    const mc = this.cluster_.getMarkerClusterer();\n    const ariaLabel = mc.ariaLabelFn(this.sums_.text);\n\n    const divStyle: { [key: string]: string } = {\n      position: \"absolute\",\n      top: coercePixels(this.anchorText_[0]),\n      left: coercePixels(this.anchorText_[1]),\n      color: this.style.textColor,\n      \"font-size\": coercePixels(this.style.textSize),\n      \"font-family\": this.style.fontFamily,\n      \"font-weight\": this.style.fontWeight,\n      \"font-style\": this.style.fontStyle,\n      \"text-decoration\": this.style.textDecoration,\n      \"text-align\": \"center\",\n      width: coercePixels(this.style.width),\n      \"line-height\": coercePixels(this.style.textLineHeight),\n    };\n\n    return `\n<div aria-label=\"${ariaLabel}\" style=\"${toCssText(divStyle)}\" tabindex=\"0\">\n  <span aria-hidden=\"true\">${this.sums_.text}</span>\n</div>\n`;\n  }\n\n  private getImageElementHtml(): string {\n    // NOTE: values must be specified in px units\n    const bp = (this.style.backgroundPosition || \"0 0\").split(\" \");\n    const spriteH = parseInt(bp[0].replace(/^\\s+|\\s+$/g, \"\"), 10);\n    const spriteV = parseInt(bp[1].replace(/^\\s+|\\s+$/g, \"\"), 10);\n\n    let dimensions: { [key: string]: string } = {};\n\n    if (this.cluster_.getMarkerClusterer().getEnableRetinaIcons()) {\n      dimensions = {\n        width: coercePixels(this.style.width),\n        height: coercePixels(this.style.height),\n      };\n    } else {\n      const [Y1, X1, Y2, X2] = [\n        -1 * spriteV,\n        -1 * spriteH + this.style.width,\n        -1 * spriteV + this.style.height,\n        -1 * spriteH,\n      ];\n      dimensions = {\n        clip: `rect(${Y1}px, ${X1}px, ${Y2}px, ${X2}px)`,\n      };\n    }\n\n    const overrideDimensionsDynamicIcon = this.sums_.url\n      ? { width: \"100%\", height: \"100%\" }\n      : {};\n\n    const cssText = toCssText({\n      position: \"absolute\",\n      top: coercePixels(spriteV),\n      left: coercePixels(spriteH),\n      ...dimensions,\n      ...overrideDimensionsDynamicIcon,\n    });\n\n    return `<img alt=\"${this.sums_.text}\" aria-hidden=\"true\" src=\"${this.style.url}\" style=\"${cssText}\"/>`;\n  }\n\n  /**\n   * Sets the icon styles to the appropriate element in the styles array.\n   *\n   * @ignore\n   * @param sums The icon label text and styles index.\n   */\n  useStyle(sums: ClusterIconInfo): void {\n    this.sums_ = sums;\n    let index = Math.max(0, sums.index - 1);\n    index = Math.min(this.styles_.length - 1, index);\n    this.style = this.sums_.url\n      ? { ...this.styles_[index], url: this.sums_.url }\n      : this.styles_[index];\n\n    this.anchorText_ = this.style.anchorText || [0, 0];\n    this.anchorIcon_ = this.style.anchorIcon || [\n      Math.floor(this.style.height / 2),\n      Math.floor(this.style.width / 2),\n    ];\n\n    this.className_ =\n      this.cluster_.getMarkerClusterer().getClusterClass() +\n      \" \" +\n      (this.style.className || \"cluster-\" + index);\n  }\n\n  /**\n   * Sets the position at which to center the icon.\n   *\n   * @param center The latlng to set as the center.\n   */\n  setCenter(center: google.maps.LatLng): void {\n    this.center_ = center;\n  }\n\n  /**\n   * Creates the `cssText` style parameter based on the position of the icon.\n   *\n   * @param pos The position of the icon.\n   * @return The CSS style text.\n   */\n  private createCss_(pos: google.maps.Point): string {\n    return toCssText({\n      \"z-index\": `${this.cluster_.getMarkerClusterer().getZIndex()}`,\n      top: coercePixels(pos.y),\n      left: coercePixels(pos.x),\n      width: coercePixels(this.style.width),\n      height: coercePixels(this.style.height),\n      cursor: \"pointer\",\n      position: \"absolute\",\n      \"-webkit-user-select\": \"none\",\n      \"-khtml-user-select\": \"none\",\n      \"-moz-user-select\": \"none\",\n      \"-o-user-select\": \"none\",\n      \"user-select\": \"none\",\n    });\n  }\n\n  /**\n   * Returns the position at which to place the DIV depending on the latlng.\n   *\n   * @param latlng The position in latlng.\n   * @return The position in pixels.\n   */\n  private getPosFromLatLng_(latlng: google.maps.LatLng): google.maps.Point {\n    const pos = this.getProjection().fromLatLngToDivPixel(latlng);\n    pos.x = Math.floor(pos.x - this.anchorIcon_[1]);\n    pos.y = Math.floor(pos.y - this.anchorIcon_[0]);\n    return pos;\n  }\n}\n","/**\n * Copyright 2019 Google LLC. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { MarkerClusterer, ClusterAugmentedMarker } from \"./markerclusterer\";\nimport { ClusterIcon } from \"./cluster-icon\";\n\n/**\n * Creates a single cluster that manages a group of proximate markers.\n *  Used internally, do not call this constructor directly.\n */\nexport class Cluster {\n  private map_ = this.markerClusterer_.getMap() as google.maps.Map;\n  private minClusterSize_: number = this.markerClusterer_.getMinimumClusterSize();\n  private averageCenter_: boolean = this.markerClusterer_.getAverageCenter();\n  private markers_: ClusterAugmentedMarker[] = []; // TODO: type;\n  private center_: google.maps.LatLng = null;\n  private bounds_: google.maps.LatLngBounds = null;\n  private clusterIcon_ = new ClusterIcon(\n    this,\n    this.markerClusterer_.getStyles()\n  );\n\n  /**\n   *\n   * @param markerClusterer_ The `MarkerClusterer` object with which this\n   *  cluster is associated.\n   */\n  constructor(private markerClusterer_: MarkerClusterer) {}\n\n  /**\n   * Returns the number of markers managed by the cluster. You can call this from\n   * a `click`, `mouseover`, or `mouseout` event handler for the `MarkerClusterer` object.\n   *\n   * @return The number of markers in the cluster.\n   */\n  public getSize(): number {\n    return this.markers_.length;\n  }\n\n  /**\n   * Returns the array of markers managed by the cluster. You can call this from\n   * a `click`, `mouseover`, or `mouseout` event handler for the `MarkerClusterer` object.\n   *\n   * @return The array of markers in the cluster.\n   */\n  public getMarkers(): google.maps.Marker[] {\n    return this.markers_;\n  }\n\n  /**\n   * Returns the center of the cluster. You can call this from\n   * a `click`, `mouseover`, or `mouseout` event handler\n   * for the `MarkerClusterer` object.\n   *\n   * @return The center of the cluster.\n   */\n  public getCenter(): google.maps.LatLng {\n    return this.center_;\n  }\n\n  /**\n   * Returns the map with which the cluster is associated.\n   *\n   * @return The map.\n   * @ignore\n   */\n  public getMap(): google.maps.Map {\n    return this.map_;\n  }\n\n  /**\n   * Returns the `MarkerClusterer` object with which the cluster is associated.\n   *\n   * @return The associated marker clusterer.\n   * @ignore\n   */\n  public getMarkerClusterer(): MarkerClusterer {\n    return this.markerClusterer_;\n  }\n\n  /**\n   * Returns the bounds of the cluster.\n   *\n   * @return the cluster bounds.\n   * @ignore\n   */\n  public getBounds(): google.maps.LatLngBounds {\n    const bounds = new google.maps.LatLngBounds(this.center_, this.center_);\n    const markers = this.getMarkers();\n    for (let i = 0; i < markers.length; i++) {\n      bounds.extend(markers[i].getPosition());\n    }\n    return bounds;\n  }\n\n  /**\n   * Removes the cluster from the map.\n   *\n   * @ignore\n   */\n  public remove(): void {\n    this.clusterIcon_.setMap(null);\n    this.markers_ = [];\n    delete this.markers_;\n  }\n\n  /**\n   * Adds a marker to the cluster.\n   *\n   * @param marker The marker to be added.\n   * @return True if the marker was added.\n   * @ignore\n   */\n  public addMarker(\n    marker: google.maps.Marker & { isAdded?: boolean }\n  ): boolean {\n    if (this.isMarkerAlreadyAdded_(marker)) {\n      return false;\n    }\n\n    if (!this.center_) {\n      this.center_ = marker.getPosition();\n      this.calculateBounds_();\n    } else {\n      if (this.averageCenter_) {\n        const l = this.markers_.length + 1;\n        const lat =\n          (this.center_.lat() * (l - 1) + marker.getPosition().lat()) / l;\n        const lng =\n          (this.center_.lng() * (l - 1) + marker.getPosition().lng()) / l;\n        this.center_ = new google.maps.LatLng(lat, lng);\n        this.calculateBounds_();\n      }\n    }\n\n    marker.isAdded = true;\n    this.markers_.push(marker);\n\n    const mCount = this.markers_.length;\n    const mz = this.markerClusterer_.getMaxZoom();\n    if (mz !== null && this.map_.getZoom() > mz) {\n      // Zoomed in past max zoom, so show the marker.\n      if (marker.getMap() !== this.map_) {\n        marker.setMap(this.map_);\n      }\n    } else if (mCount < this.minClusterSize_) {\n      // Min cluster size not reached so show the marker.\n      if (marker.getMap() !== this.map_) {\n        marker.setMap(this.map_);\n      }\n    } else if (mCount === this.minClusterSize_) {\n      // Hide the markers that were showing.\n      for (let i = 0; i < mCount; i++) {\n        this.markers_[i].setMap(null);\n      }\n    } else {\n      marker.setMap(null);\n    }\n\n    return true;\n  }\n\n  /**\n   * Determines if a marker lies within the cluster's bounds.\n   *\n   * @param marker The marker to check.\n   * @return True if the marker lies in the bounds.\n   * @ignore\n   */\n  public isMarkerInClusterBounds(marker: google.maps.Marker): boolean {\n    return this.bounds_.contains(marker.getPosition());\n  }\n\n  /**\n   * Calculates the extended bounds of the cluster with the grid.\n   */\n  private calculateBounds_(): void {\n    const bounds = new google.maps.LatLngBounds(this.center_, this.center_);\n    this.bounds_ = this.markerClusterer_.getExtendedBounds(bounds);\n  }\n\n  /**\n   * Updates the cluster icon.\n   */\n  public updateIcon(): void {\n    const mCount = this.markers_.length;\n    const mz = this.markerClusterer_.getMaxZoom();\n\n    if (mz !== null && this.map_.getZoom() > mz) {\n      this.clusterIcon_.hide();\n      return;\n    }\n\n    if (mCount < this.minClusterSize_) {\n      // Min cluster size not yet reached.\n      this.clusterIcon_.hide();\n      return;\n    }\n\n    const numStyles = this.markerClusterer_.getStyles().length;\n    const sums = this.markerClusterer_.getCalculator()(\n      this.markers_,\n      numStyles\n    );\n    this.clusterIcon_.setCenter(this.center_);\n    this.clusterIcon_.useStyle(sums);\n    this.clusterIcon_.show();\n  }\n\n  /**\n   * Determines if a marker has already been added to the cluster.\n   *\n   * @param marker The marker to check.\n   * @return True if the marker has already been added.\n   */\n  private isMarkerAlreadyAdded_(marker: google.maps.Marker): boolean {\n    if (this.markers_.indexOf) {\n      return this.markers_.indexOf(marker) !== -1;\n    } else {\n      for (let i = 0; i < this.markers_.length; i++) {\n        if (marker === this.markers_[i]) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n}\n","/**\n * Copyright 2019 Google LLC. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @name MarkerClustererPlus for Google Maps V3\n * @author Gary Little\n * @fileoverview\n * The library creates and manages per-zoom-level clusters for large amounts of markers.\n * <p>\n * This is an enhanced V3 implementation of the V2 MarkerClusterer by Xiaoxi Wu. It is\n * based on the V3 MarkerClusterer port by Luke Mahe. MarkerClustererPlus was created\n * by Gary Little.\n * <p>\n * v2.0 release: MarkerClustererPlus v2.0 is backward compatible with MarkerClusterer v1.0. It\n *  adds support for the `ignoreHidden`, `title`, `batchSizeIE`,\n *  and `calculator` properties as well as support for four more events. It also allows\n *  greater control over the styling of the text that appears on the cluster marker. The\n *  documentation has been significantly improved and the overall code has been simplified and\n *  polished. Very large numbers of markers can now be managed without causing Javascript timeout\n *  errors on Internet Explorer. Note that the name of the `clusterclick` event has been\n *  deprecated. The new name is `click`, so please change your application code now.\n */\n\nimport { ClusterIconInfo, ClusterIconStyle } from \"./cluster-icon\";\n\nimport { Cluster } from \"./cluster\";\nimport { OverlayViewSafe } from \"./overlay-view-safe\";\n\n/**\n * @param text The text attribute of the cluster\n */\ntype AriaLabelFn = (text: string) => string;\n\nexport type Calculator = (\n  markers: google.maps.Marker[],\n  clusterIconStylesCount: number\n) => ClusterIconInfo;\n\nexport interface ClusterAugmentedMarker extends google.maps.Marker {\n  isAdded?: boolean;\n}\n\n/**\n * This event is fired on the {@link MarkerClusterer} instance when the `MarkerClusterer` stops clustering markers.\n *\n * Example:\n * ```typescript\n *  mc.addListener('clusteringend', (mc: MarkerClusterer) => {})\n * ```\n *\n * @param mc The MarkerClusterer whose markers are being clustered.\n * @event clusteringend\n */\nexport declare function clusteringend(mc: MarkerClusterer): void;\n\n/**\n * This event is fired on the {@link MarkerClusterer} instance when the `MarkerClusterer` begins clustering markers.\n *\n * Example:\n * ```typescript\n *  mc.addListener('clusteringbegin', (mc: MarkerClusterer) => {})\n * ```\n *\n * @param mc The MarkerClusterer whose markers are being clustered.\n * @event clusteringbegin\n */\nexport declare function clusteringbegin(mc: MarkerClusterer): void;\n\n/**\n * Optional parameter passed to the {@link MarkerClusterer} constructor.\n */\nexport interface MarkerClustererOptions {\n  /**\n   * The grid size of a cluster in pixels. The grid is a square.\n   *\n   * @default `60`\n   */\n  gridSize?: number;\n  /**\n   * The maximum zoom level at which clustering is enabled or\n   * `null` if clustering is to be enabled at all zoom levels.\n   *\n   * @default `null`\n   */\n  maxZoom?: number;\n\n  /**\n   * Whether to zoom the map when a cluster marker is\n   * clicked. You may want to set this to `false` if you have installed a handler\n   * for the `click` event and it deals with zooming on its own.\n   *\n   * @default `true`\n   */\n  zoomOnClick?: boolean;\n  /***\n   * Whether the position of a cluster marker should be\n   * the average position of all markers in the cluster. If set to `false`, the\n   * cluster marker is positioned at the location of the first marker added to the cluster.\n   *\n   * @default `false`\n   */\n  averageCenter?: boolean;\n  /**\n   * The minimum number of markers needed in a cluster\n   * before the markers are hidden and a cluster marker appears.\n   *\n   * @default `2`\n   */\n  minimumClusterSize?: number;\n\n  /**\n   *  the z-index of a cluster.\n   *\n   *  @default `google.maps.Marker.MAX_ZINDEX + 1`\n   */\n  zIndex?: number;\n\n  /**\n   * Whether to ignore hidden markers in clusters. You\n   * may want to set this to `true` to ensure that hidden markers are not included\n   * in the marker count that appears on a cluster marker (this count is the value of the\n   * `text` property of the result returned by the default  {@link calculator}).\n   * If set to `true` and you change the visibility of a marker being clustered, be\n   * sure to also call {@link MarkerClusterer#repaint()}.\n   *\n   * @default `false`\n   */\n  ignoreHidden?: boolean;\n  /**\n   * The tooltip to display when the mouse moves over a cluster\n   * marker. (Alternatively, you can use a custom `calculator` function to specify a\n   * different tooltip for each cluster marker.)\n   *\n   * @default `\"\"`\n   */\n  title?: string;\n  /**\n   * The function used to determine\n   * the text to be displayed on a cluster marker and the index indicating which style to use\n   * for the cluster marker. The input parameters for the function are (1) the array of markers\n   * represented by a cluster marker and (2) the number of cluster icon styles. It returns a\n   * {@link ClusterIconInfo} object. The default `calculator` returns a\n   * `text` property which is the number of markers in the cluster and an\n   * `index` property which is one higher than the lowest integer such that\n   * `10^i` exceeds the number of markers in the cluster, or the size of the styles\n   * array, whichever is less. The `styles` array element used has an index of\n   * `index` minus 1. For example, the default `calculator` returns a\n   * `text` value of `\"125\"` and an `index` of `3`\n   * for a cluster icon representing 125 markers so the element used in the `styles`\n   * array is `2`. A `calculator` may also return a `title`\n   * property that contains the text of the tooltip to be used for the cluster marker. If\n   * `title` is not defined, the tooltip is set to the value of the `title`\n   * property for the MarkerClusterer.\n   *\n   * @default {@link MarkerClusterer.CALCULATOR}\n   */\n  calculator?: Calculator;\n  /**\n   * The name of the CSS class defining general styles\n   * for the cluster markers. Use this class to define CSS styles that are not set up by the code\n   * that processes the `styles` array.\n   *\n   * @default `\"cluster\"`\n   */\n  clusterClass?: string;\n  /**\n   * An array of {@link ClusterIconStyle} elements defining the styles\n   * of the cluster markers to be used. The element to be used to style a given cluster marker\n   * is determined by the function defined by the `calculator` property.\n   * The default is an array of {@link ClusterIconStyle} elements whose properties are derived\n   * from the values for `imagePath`, `imageExtension`, and `imageSizes`.\n   *\n   * @default `styles`\n   */\n  styles?: ClusterIconStyle[];\n  /**\n   * Whether to allow the use of cluster icons that\n   * have sizes that are some multiple (typically double) of their actual display size. Icons such\n   * as these look better when viewed on high-resolution monitors such as Apple's Retina displays.\n   * Note: if this property is `true`, sprites cannot be used as cluster icons.\n   *\n   * @default `false`\n   */\n  enableRetinaIcons?: boolean;\n  /**\n   * Set this property to the number of markers to be processed in a single batch when using\n   * a browser other than Internet Explorer (for Internet Explorer, use the batchSizeIE property instead).\n   *\n   * @default `MarkerClusterer.BATCH_SIZE`\n   */\n  batchSize?: number;\n  /**\n   * When Internet Explorer is\n   * being used, markers are processed in several batches with a small delay inserted between\n   * each batch in an attempt to avoid Javascript timeout errors. Set this property to the\n   * number of markers to be processed in a single batch; select as high a number as you can\n   * without causing a timeout error in the browser. This number might need to be as low as 100\n   * if 15,000 markers are being managed, for example.\n   *\n   * @default `MarkerClusterer.BATCH_SIZE_IE`\n   */\n  batchSizeIE?: number;\n  /**\n   * The full URL of the root name of the group of image files to use for cluster icons.\n   * The complete file name is of the form `imagePath`n.`imageExtension`\n   * where n is the image file number (1, 2, etc.).\n   *\n   * @default `MarkerClusterer.IMAGE_PATH`\n   */\n  imagePath?: string;\n  /**\n   * The extension name for the cluster icon image files (e.g., `\"png\"` or\n   * `\"jpg\"`).\n   *\n   * @default `MarkerClusterer.IMAGE_EXTENSION`\n   */\n  imageExtension?: string;\n  /**\n   * An array of numbers containing the widths of the group of\n   * `imagePath`n.`imageExtension` image files.\n   * (The images are assumed to be square.)\n   *\n   * @default `MarkerClusterer.IMAGE_SIZES`\n   */\n  imageSizes?: number[];\n  /**\n   * A function to take the text attribute associated with the cluster and output a string to attach an\n   * ariaLabel to the cluster\n   */\n  ariaLabelFn?: AriaLabelFn;\n}\n\n/**\n * @ignore\n */\nconst getOption = <T, K extends keyof T>(\n  options: T,\n  prop: K,\n  def: T[K]\n): T[K] => {\n  if (options[prop] !== undefined) {\n    return options[prop];\n  } else {\n    return def;\n  }\n};\n\nexport class MarkerClusterer extends OverlayViewSafe {\n  /**\n   * The number of markers to process in one batch.\n   */\n  static BATCH_SIZE = 2000;\n\n  /**\n   * The number of markers to process in one batch (IE only).\n   */\n  static BATCH_SIZE_IE = 500;\n\n  /**\n   * The default root name for the marker cluster images.\n   */\n  static IMAGE_PATH = \"../images/m\";\n\n  /**\n   * The default extension name for the marker cluster images.\n   */\n  static IMAGE_EXTENSION = \"png\";\n\n  /**\n   * The default array of sizes for the marker cluster images.\n   */\n  static IMAGE_SIZES: number[] = [53, 56, 66, 78, 90];\n\n  private markers_: ClusterAugmentedMarker[] = [];\n  private clusters_: Cluster[] = [];\n  private listeners_: google.maps.MapsEventListener[] = [];\n\n  private activeMap_: google.maps.Map = null;\n  private ready_ = false;\n\n  public ariaLabelFn = this.options.ariaLabelFn || ((): string => \"\");\n\n  private zIndex_ =\n    this.options.zIndex || Number(google.maps.Marker.MAX_ZINDEX) + 1;\n  private gridSize_ = this.options.gridSize || 60;\n  private minClusterSize_ = this.options.minimumClusterSize || 2;\n  private maxZoom_ = this.options.maxZoom || null;\n  private styles_: ClusterIconStyle[] = this.options.styles || [];\n  private title_ = this.options.title || \"\";\n\n  private zoomOnClick_ = getOption(this.options, \"zoomOnClick\", true);\n  private averageCenter_ = getOption(this.options, \"averageCenter\", false);\n\n  private ignoreHidden_ = getOption(this.options, \"ignoreHidden\", false);\n  private enableRetinaIcons_ = getOption(\n    this.options,\n    \"enableRetinaIcons\",\n    false\n  );\n\n  private imagePath_ = this.options.imagePath || MarkerClusterer.IMAGE_PATH;\n  private imageExtension_ =\n    this.options.imageExtension || MarkerClusterer.IMAGE_EXTENSION;\n  private imageSizes_ = this.options.imageSizes || MarkerClusterer.IMAGE_SIZES;\n  private calculator_ = this.options.calculator || MarkerClusterer.CALCULATOR;\n  private batchSize_ = this.options.batchSize || MarkerClusterer.BATCH_SIZE;\n  private batchSizeIE_ =\n    this.options.batchSizeIE || MarkerClusterer.BATCH_SIZE_IE;\n  private clusterClass_ = this.options.clusterClass || \"cluster\";\n\n  private prevZoom_: number;\n  private timerRefStatic: number;\n\n  /**\n   * Creates a MarkerClusterer object with the options specified in {@link MarkerClustererOptions}.\n   * @param map The Google map to attach to.\n   * @param markers The markers to be added to the cluster.\n   * @param options The optional parameters.\n   */\n  constructor(\n    map: google.maps.Map,\n    markers: google.maps.Marker[] = [],\n    private options: MarkerClustererOptions = {}\n  ) {\n    super();\n\n    if (navigator.userAgent.toLowerCase().indexOf(\"msie\") !== -1) {\n      // Try to avoid IE timeout when processing a huge number of markers:\n      this.batchSize_ = this.batchSizeIE_;\n    }\n\n    this.setupStyles_();\n\n    this.addMarkers(markers, true);\n    this.setMap(map); // Note: this causes onAdd to be called\n  }\n\n  /**\n   * Implementation of the onAdd interface method.\n   * @ignore\n   */\n  onAdd(): void {\n    this.activeMap_ = this.getMap() as google.maps.Map;\n    this.ready_ = true;\n\n    this.repaint();\n\n    this.prevZoom_ = this.getMap().getZoom();\n\n    // Add the map event listeners\n    this.listeners_ = [\n      google.maps.event.addListener(this.getMap(), \"zoom_changed\", () => {\n        const map: google.maps.Map & {\n          minZoom: number;\n          maxZoom: number;\n          mapTypes: { [type: string]: google.maps.MapType };\n        } = this.getMap() as any; // eslint-disable-line @typescript-eslint/no-explicit-any\n\n        // Fix for bug #407\n        // Determines map type and prevents illegal zoom levels\n        const minZoom = map.minZoom || 0;\n        const maxZoom = Math.min(\n          map.maxZoom || 100,\n          map.mapTypes[map.getMapTypeId()].maxZoom\n        );\n        const zoom = Math.min(\n          Math.max(this.getMap().getZoom(), minZoom),\n          maxZoom\n        );\n\n        if (this.prevZoom_ != zoom) {\n          this.prevZoom_ = zoom;\n          this.resetViewport_(false);\n        }\n      }),\n      google.maps.event.addListener(this.getMap(), \"idle\", () => {\n        this.redraw_();\n      }),\n    ];\n  }\n\n  /**\n   * Implementation of the onRemove interface method.\n   * Removes map event listeners and all cluster icons from the DOM.\n   * All managed markers are also put back on the map.\n   * @ignore\n   */\n  onRemove(): void {\n    // Put all the managed markers back on the map:\n    for (let i = 0; i < this.markers_.length; i++) {\n      if (this.markers_[i].getMap() !== this.activeMap_) {\n        this.markers_[i].setMap(this.activeMap_);\n      }\n    }\n\n    // Remove all clusters:\n    for (let i = 0; i < this.clusters_.length; i++) {\n      this.clusters_[i].remove();\n    }\n    this.clusters_ = [];\n\n    // Remove map event listeners:\n    for (let i = 0; i < this.listeners_.length; i++) {\n      google.maps.event.removeListener(this.listeners_[i]);\n    }\n    this.listeners_ = [];\n\n    this.activeMap_ = null;\n    this.ready_ = false;\n  }\n\n  /**\n   * Implementation of the draw interface method.\n   * @ignore\n   */\n  draw(): void {}\n\n  /**\n   * Sets up the styles object.\n   */\n  private setupStyles_(): void {\n    if (this.styles_.length > 0) {\n      return;\n    }\n\n    for (let i = 0; i < this.imageSizes_.length; i++) {\n      const size = this.imageSizes_[i];\n      this.styles_.push(\n        MarkerClusterer.withDefaultStyle({\n          url: this.imagePath_ + (i + 1) + \".\" + this.imageExtension_,\n          height: size,\n          width: size,\n        })\n      );\n    }\n  }\n\n  /**\n   *  Fits the map to the bounds of the markers managed by the clusterer.\n   */\n  fitMapToMarkers(padding: number | google.maps.Padding): void {\n    const markers = this.getMarkers();\n    const bounds = new google.maps.LatLngBounds();\n    for (let i = 0; i < markers.length; i++) {\n      // March 3, 2018: Bug fix -- honor the ignoreHidden property\n      if (markers[i].getVisible() || !this.getIgnoreHidden()) {\n        bounds.extend(markers[i].getPosition());\n      }\n    }\n\n    (this.getMap() as google.maps.Map).fitBounds(bounds, padding);\n  }\n\n  /**\n   * Returns the value of the `gridSize` property.\n   *\n   * @return The grid size.\n   */\n  getGridSize(): number {\n    return this.gridSize_;\n  }\n\n  /**\n   * Sets the value of the `gridSize` property.\n   *\n   * @param gridSize The grid size.\n   */\n  setGridSize(gridSize: number): void {\n    this.gridSize_ = gridSize;\n  }\n\n  /**\n   * Returns the value of the `minimumClusterSize` property.\n   *\n   * @return The minimum cluster size.\n   */\n  getMinimumClusterSize(): number {\n    return this.minClusterSize_;\n  }\n\n  /**\n   * Sets the value of the `minimumClusterSize` property.\n   *\n   * @param minimumClusterSize The minimum cluster size.\n   */\n  setMinimumClusterSize(minimumClusterSize: number): void {\n    this.minClusterSize_ = minimumClusterSize;\n  }\n\n  /**\n   *  Returns the value of the `maxZoom` property.\n   *\n   *  @return The maximum zoom level.\n   */\n  getMaxZoom(): number {\n    return this.maxZoom_;\n  }\n\n  /**\n   *  Sets the value of the `maxZoom` property.\n   *\n   *  @param maxZoom The maximum zoom level.\n   */\n  setMaxZoom(maxZoom: number): void {\n    this.maxZoom_ = maxZoom;\n  }\n\n  getZIndex(): number {\n    return this.zIndex_;\n  }\n\n  setZIndex(zIndex: number): void {\n    this.zIndex_ = zIndex;\n  }\n\n  /**\n   *  Returns the value of the `styles` property.\n   *\n   *  @return The array of styles defining the cluster markers to be used.\n   */\n  getStyles(): ClusterIconStyle[] {\n    return this.styles_;\n  }\n\n  /**\n   *  Sets the value of the `styles` property.\n   *\n   *  @param styles The array of styles to use.\n   */\n  setStyles(styles: ClusterIconStyle[]): void {\n    this.styles_ = styles;\n  }\n\n  /**\n   * Returns the value of the `title` property.\n   *\n   * @return The content of the title text.\n   */\n  getTitle(): string {\n    return this.title_;\n  }\n\n  /**\n   *  Sets the value of the `title` property.\n   *\n   *  @param title The value of the title property.\n   */\n  setTitle(title: string): void {\n    this.title_ = title;\n  }\n\n  /**\n   * Returns the value of the `zoomOnClick` property.\n   *\n   * @return True if zoomOnClick property is set.\n   */\n  getZoomOnClick(): boolean {\n    return this.zoomOnClick_;\n  }\n\n  /**\n   *  Sets the value of the `zoomOnClick` property.\n   *\n   *  @param zoomOnClick The value of the zoomOnClick property.\n   */\n  setZoomOnClick(zoomOnClick: boolean): void {\n    this.zoomOnClick_ = zoomOnClick;\n  }\n\n  /**\n   * Returns the value of the `averageCenter` property.\n   *\n   * @return True if averageCenter property is set.\n   */\n  getAverageCenter(): boolean {\n    return this.averageCenter_;\n  }\n\n  /**\n   *  Sets the value of the `averageCenter` property.\n   *\n   *  @param averageCenter The value of the averageCenter property.\n   */\n  setAverageCenter(averageCenter: boolean): void {\n    this.averageCenter_ = averageCenter;\n  }\n\n  /**\n   * Returns the value of the `ignoreHidden` property.\n   *\n   * @return True if ignoreHidden property is set.\n   */\n  getIgnoreHidden(): boolean {\n    return this.ignoreHidden_;\n  }\n\n  /**\n   *  Sets the value of the `ignoreHidden` property.\n   *\n   *  @param ignoreHidden The value of the ignoreHidden property.\n   */\n  setIgnoreHidden(ignoreHidden: boolean): void {\n    this.ignoreHidden_ = ignoreHidden;\n  }\n\n  /**\n   * Returns the value of the `enableRetinaIcons` property.\n   *\n   * @return True if enableRetinaIcons property is set.\n   */\n  getEnableRetinaIcons(): boolean {\n    return this.enableRetinaIcons_;\n  }\n\n  /**\n   *  Sets the value of the `enableRetinaIcons` property.\n   *\n   *  @param enableRetinaIcons The value of the enableRetinaIcons property.\n   */\n  setEnableRetinaIcons(enableRetinaIcons: boolean): void {\n    this.enableRetinaIcons_ = enableRetinaIcons;\n  }\n\n  /**\n   * Returns the value of the `imageExtension` property.\n   *\n   * @return The value of the imageExtension property.\n   */\n  getImageExtension(): string {\n    return this.imageExtension_;\n  }\n\n  /**\n   *  Sets the value of the `imageExtension` property.\n   *\n   *  @param imageExtension The value of the imageExtension property.\n   */\n  setImageExtension(imageExtension: string): void {\n    this.imageExtension_ = imageExtension;\n  }\n\n  /**\n   * Returns the value of the `imagePath` property.\n   *\n   * @return The value of the imagePath property.\n   */\n  getImagePath(): string {\n    return this.imagePath_;\n  }\n\n  /**\n   *  Sets the value of the `imagePath` property.\n   *\n   *  @param imagePath The value of the imagePath property.\n   */\n  setImagePath(imagePath: string): void {\n    this.imagePath_ = imagePath;\n  }\n\n  /**\n   * Returns the value of the `imageSizes` property.\n   *\n   * @return The value of the imageSizes property.\n   */\n  getImageSizes(): number[] {\n    return this.imageSizes_;\n  }\n\n  /**\n   *  Sets the value of the `imageSizes` property.\n   *\n   *  @param imageSizes The value of the imageSizes property.\n   */\n  setImageSizes(imageSizes: number[]): void {\n    this.imageSizes_ = imageSizes;\n  }\n\n  /**\n   * Returns the value of the `calculator` property.\n   *\n   * @return the value of the calculator property.\n   */\n  getCalculator(): Calculator {\n    return this.calculator_;\n  }\n\n  /**\n   * Sets the value of the `calculator` property.\n   *\n   * @param calculator The value of the calculator property.\n   */\n  setCalculator(calculator: Calculator): void {\n    this.calculator_ = calculator;\n  }\n\n  /**\n   * Returns the value of the `batchSizeIE` property.\n   *\n   * @return the value of the batchSizeIE property.\n   */\n  getBatchSizeIE(): number {\n    return this.batchSizeIE_;\n  }\n\n  /**\n   * Sets the value of the `batchSizeIE` property.\n   *\n   *  @param batchSizeIE The value of the batchSizeIE property.\n   */\n  setBatchSizeIE(batchSizeIE: number): void {\n    this.batchSizeIE_ = batchSizeIE;\n  }\n\n  /**\n   * Returns the value of the `clusterClass` property.\n   *\n   * @return the value of the clusterClass property.\n   */\n  getClusterClass(): string {\n    return this.clusterClass_;\n  }\n\n  /**\n   * Sets the value of the `clusterClass` property.\n   *\n   *  @param clusterClass The value of the clusterClass property.\n   */\n  setClusterClass(clusterClass: string): void {\n    this.clusterClass_ = clusterClass;\n  }\n\n  /**\n   *  Returns the array of markers managed by the clusterer.\n   *\n   *  @return The array of markers managed by the clusterer.\n   */\n  getMarkers(): google.maps.Marker[] {\n    return this.markers_;\n  }\n\n  /**\n   *  Returns the number of markers managed by the clusterer.\n   *\n   *  @return The number of markers.\n   */\n  getTotalMarkers(): number {\n    return this.markers_.length;\n  }\n\n  /**\n   * Returns the current array of clusters formed by the clusterer.\n   *\n   * @return The array of clusters formed by the clusterer.\n   */\n  getClusters(): Cluster[] {\n    return this.clusters_;\n  }\n\n  /**\n   * Returns the number of clusters formed by the clusterer.\n   *\n   * @return The number of clusters formed by the clusterer.\n   */\n  getTotalClusters(): number {\n    return this.clusters_.length;\n  }\n\n  /**\n   * Adds a marker to the clusterer. The clusters are redrawn unless\n   *  `nodraw` is set to `true`.\n   *\n   * @param marker The marker to add.\n   * @param nodraw Set to `true` to prevent redrawing.\n   */\n  addMarker(marker: google.maps.Marker, nodraw?: boolean): void {\n    this.pushMarkerTo_(marker);\n    if (!nodraw) {\n      this.redraw_();\n    }\n  }\n\n  /**\n   * Adds an array of markers to the clusterer. The clusters are redrawn unless\n   *  `nodraw` is set to `true`.\n   *\n   * @param markers The markers to add.\n   * @param nodraw Set to `true` to prevent redrawing.\n   */\n  addMarkers(markers: google.maps.Marker[], nodraw?: boolean): void {\n    for (const key in markers) {\n      if (Object.prototype.hasOwnProperty.call(markers, key)) {\n        this.pushMarkerTo_(markers[key]);\n      }\n    }\n    if (!nodraw) {\n      this.redraw_();\n    }\n  }\n\n  /**\n   * Pushes a marker to the clusterer.\n   *\n   * @param marker The marker to add.\n   */\n  private pushMarkerTo_(\n    marker: google.maps.Marker & { isAdded?: boolean }\n  ): void {\n    // If the marker is draggable add a listener so we can update the clusters on the dragend:\n    if (marker.getDraggable()) {\n      google.maps.event.addListener(marker, \"dragend\", () => {\n        if (this.ready_) {\n          marker.isAdded = false;\n          this.repaint();\n        }\n      });\n    }\n    marker.isAdded = false;\n    this.markers_.push(marker);\n  }\n\n  /**\n   * Removes a marker from the cluster.  The clusters are redrawn unless\n   *  `nodraw` is set to `true`. Returns `true` if the\n   *  marker was removed from the clusterer.\n   *\n   * @param marker The marker to remove.\n   * @param nodraw Set to `true` to prevent redrawing.\n   * @return True if the marker was removed from the clusterer.\n   */\n  removeMarker(marker: google.maps.Marker, nodraw?: boolean): boolean {\n    const removed = this.removeMarker_(marker);\n\n    if (!nodraw && removed) {\n      this.repaint();\n    }\n\n    return removed;\n  }\n\n  /**\n   * Removes an array of markers from the cluster. The clusters are redrawn unless\n   *  `nodraw` is set to `true`. Returns `true` if markers were removed from the clusterer.\n   *\n   * @param markers The markers to remove.\n   * @param nodraw Set to `true` to prevent redrawing.\n   * @return True if markers were removed from the clusterer.\n   */\n  removeMarkers(markers: google.maps.Marker[], nodraw?: boolean): boolean {\n    let removed = false;\n\n    for (let i = 0; i < markers.length; i++) {\n      const r = this.removeMarker_(markers[i]);\n      removed = removed || r;\n    }\n\n    if (!nodraw && removed) {\n      this.repaint();\n    }\n\n    return removed;\n  }\n\n  /**\n   * Removes a marker and returns true if removed, false if not.\n   *\n   * @param marker The marker to remove\n   * @return Whether the marker was removed or not\n   */\n  private removeMarker_(marker: google.maps.Marker): boolean {\n    let index = -1;\n    if (this.markers_.indexOf) {\n      index = this.markers_.indexOf(marker);\n    } else {\n      for (let i = 0; i < this.markers_.length; i++) {\n        if (marker === this.markers_[i]) {\n          index = i;\n          break;\n        }\n      }\n    }\n\n    if (index === -1) {\n      // Marker is not in our list of markers, so do nothing:\n      return false;\n    }\n\n    marker.setMap(null);\n    this.markers_.splice(index, 1); // Remove the marker from the list of managed markers\n    return true;\n  }\n\n  /**\n   * Removes all clusters and markers from the map and also removes all markers\n   *  managed by the clusterer.\n   */\n  clearMarkers(): void {\n    this.resetViewport_(true);\n    this.markers_ = [];\n  }\n\n  /**\n   * Recalculates and redraws all the marker clusters from scratch.\n   *  Call this after changing any properties.\n   */\n  repaint(): void {\n    const oldClusters = this.clusters_.slice();\n    this.clusters_ = [];\n    this.resetViewport_(false);\n    this.redraw_();\n\n    // Remove the old clusters.\n    // Do it in a timeout to prevent blinking effect.\n    setTimeout(() => {\n      for (let i = 0; i < oldClusters.length; i++) {\n        oldClusters[i].remove();\n      }\n    }, 0);\n  }\n\n  /**\n   * Returns the current bounds extended by the grid size.\n   *\n   * @param bounds The bounds to extend.\n   * @return The extended bounds.\n   * @ignore\n   */\n  getExtendedBounds(\n    bounds: google.maps.LatLngBounds\n  ): google.maps.LatLngBounds {\n    const projection = this.getProjection();\n\n    // Turn the bounds into latlng.\n    const tr = new google.maps.LatLng(\n      bounds.getNorthEast().lat(),\n      bounds.getNorthEast().lng()\n    );\n    const bl = new google.maps.LatLng(\n      bounds.getSouthWest().lat(),\n      bounds.getSouthWest().lng()\n    );\n\n    // Convert the points to pixels and the extend out by the grid size.\n    const trPix = projection.fromLatLngToDivPixel(tr);\n    trPix.x += this.gridSize_;\n    trPix.y -= this.gridSize_;\n\n    const blPix = projection.fromLatLngToDivPixel(bl);\n    blPix.x -= this.gridSize_;\n    blPix.y += this.gridSize_;\n\n    // Convert the pixel points back to LatLng\n    const ne = projection.fromDivPixelToLatLng(trPix);\n    const sw = projection.fromDivPixelToLatLng(blPix);\n\n    // Extend the bounds to contain the new bounds.\n    bounds.extend(ne);\n    bounds.extend(sw);\n\n    return bounds;\n  }\n\n  /**\n   * Redraws all the clusters.\n   */\n  private redraw_(): void {\n    this.createClusters_(0);\n  }\n\n  /**\n   * Removes all clusters from the map. The markers are also removed from the map\n   *  if `hide` is set to `true`.\n   *\n   * @param hide Set to `true` to also remove the markers from the map.\n   */\n  private resetViewport_(hide?: boolean): void {\n    // Remove all the clusters\n    for (let i = 0; i < this.clusters_.length; i++) {\n      this.clusters_[i].remove();\n    }\n    this.clusters_ = [];\n\n    // Reset the markers to not be added and to be removed from the map.\n    for (let i = 0; i < this.markers_.length; i++) {\n      const marker = this.markers_[i];\n      marker.isAdded = false;\n      if (hide) {\n        marker.setMap(null);\n      }\n    }\n  }\n\n  /**\n   * Calculates the distance between two latlng locations in km.\n   *\n   * @param p1 The first lat lng point.\n   * @param p2 The second lat lng point.\n   * @return The distance between the two points in km.\n   * @link http://www.movable-type.co.uk/scripts/latlong.html\n   */\n  private distanceBetweenPoints_(\n    p1: google.maps.LatLng,\n    p2: google.maps.LatLng\n  ): number {\n    const R = 6371; // Radius of the Earth in km\n    const dLat = ((p2.lat() - p1.lat()) * Math.PI) / 180;\n    const dLon = ((p2.lng() - p1.lng()) * Math.PI) / 180;\n    const a =\n      Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n      Math.cos((p1.lat() * Math.PI) / 180) *\n        Math.cos((p2.lat() * Math.PI) / 180) *\n        Math.sin(dLon / 2) *\n        Math.sin(dLon / 2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    return R * c;\n  }\n\n  /**\n   * Determines if a marker is contained in a bounds.\n   *\n   * @param marker The marker to check.\n   * @param bounds The bounds to check against.\n   * @return True if the marker is in the bounds.\n   */\n  private isMarkerInBounds_(\n    marker: google.maps.Marker,\n    bounds: google.maps.LatLngBounds\n  ): boolean {\n    return bounds.contains(marker.getPosition());\n  }\n\n  /**\n   * Adds a marker to a cluster, or creates a new cluster.\n   *\n   * @param marker The marker to add.\n   */\n  private addToClosestCluster_(marker: google.maps.Marker): void {\n    let distance = 40000; // Some large number\n    let clusterToAddTo = null;\n    for (let i = 0; i < this.clusters_.length; i++) {\n      const cluster = this.clusters_[i];\n      const center = cluster.getCenter();\n      if (center) {\n        const d = this.distanceBetweenPoints_(center, marker.getPosition());\n        if (d < distance) {\n          distance = d;\n          clusterToAddTo = cluster;\n        }\n      }\n    }\n\n    if (clusterToAddTo && clusterToAddTo.isMarkerInClusterBounds(marker)) {\n      clusterToAddTo.addMarker(marker);\n    } else {\n      const cluster = new Cluster(this);\n      cluster.addMarker(marker);\n      this.clusters_.push(cluster);\n    }\n  }\n\n  /**\n   * Creates the clusters. This is done in batches to avoid timeout errors\n   *  in some browsers when there is a huge number of markers.\n   *\n   * @param iFirst The index of the first marker in the batch of\n   *  markers to be added to clusters.\n   */\n  private createClusters_(iFirst: number): void {\n    if (!this.ready_) {\n      return;\n    }\n\n    // Cancel previous batch processing if we're working on the first batch:\n    if (iFirst === 0) {\n      google.maps.event.trigger(this, \"clusteringbegin\", this);\n\n      if (typeof this.timerRefStatic !== \"undefined\") {\n        clearTimeout(this.timerRefStatic);\n        delete this.timerRefStatic;\n      }\n    }\n\n    // Get our current map view bounds.\n    // Create a new bounds object so we don't affect the map.\n    //\n    // See Comments 9 & 11 on Issue 3651 relating to this workaround for a Google Maps bug:\n    let mapBounds: google.maps.LatLngBounds;\n\n    if (this.getMap().getZoom() > 3) {\n      mapBounds = new google.maps.LatLngBounds(\n        (this.getMap() as google.maps.Map).getBounds().getSouthWest(),\n        (this.getMap() as google.maps.Map).getBounds().getNorthEast()\n      );\n    } else {\n      mapBounds = new google.maps.LatLngBounds(\n        new google.maps.LatLng(85.02070771743472, -178.48388434375),\n        new google.maps.LatLng(-85.08136444384544, 178.00048865625)\n      );\n    }\n    const bounds = this.getExtendedBounds(mapBounds);\n\n    const iLast = Math.min(iFirst + this.batchSize_, this.markers_.length);\n\n    for (let i = iFirst; i < iLast; i++) {\n      const marker = this.markers_[i];\n      if (!marker.isAdded && this.isMarkerInBounds_(marker, bounds)) {\n        if (\n          !this.ignoreHidden_ ||\n          (this.ignoreHidden_ && marker.getVisible())\n        ) {\n          this.addToClosestCluster_(marker);\n        }\n      }\n    }\n\n    if (iLast < this.markers_.length) {\n      this.timerRefStatic = window.setTimeout(() => {\n        this.createClusters_(iLast);\n      }, 0);\n    } else {\n      delete this.timerRefStatic;\n      google.maps.event.trigger(this, \"clusteringend\", this);\n\n      for (let i = 0; i < this.clusters_.length; i++) {\n        this.clusters_[i].updateIcon();\n      }\n    }\n  }\n\n  /**\n   * The default function for determining the label text and style\n   * for a cluster icon.\n   *\n   * @param markers The array of markers represented by the cluster.\n   * @param numStyles The number of marker styles available.\n   * @return The information resource for the cluster.\n   */\n  static CALCULATOR(\n    markers: google.maps.Marker[],\n    numStyles: number\n  ): ClusterIconInfo {\n    let index = 0;\n    const count: number = markers.length;\n\n    let dv = count;\n    while (dv !== 0) {\n      dv = Math.floor(dv / 10);\n      index++;\n    }\n\n    index = Math.min(index, numStyles);\n    return {\n      text: count.toString(),\n      index: index,\n      title: \"\",\n    };\n  }\n\n  /**\n   * Generates default styles augmented with user passed values.\n   * Useful when you want to override some default values but keep untouched\n   *\n   * @param overrides override default values\n   */\n  static withDefaultStyle(overrides: ClusterIconStyle): ClusterIconStyle {\n    return {\n      textColor: \"black\",\n      textSize: 11,\n      textDecoration: \"none\",\n      textLineHeight: overrides.height,\n      fontWeight: \"bold\",\n      fontStyle: \"normal\",\n      fontFamily: \"Arial,sans-serif\",\n      backgroundPosition: \"0 0\",\n      ...overrides,\n    };\n  }\n}\n","export const MAP_STYLE = [\r\n\t{\r\n\t\t\"featureType\": \"administrative\",\r\n\t\t\"elementType\": \"labels.text.fill\",\r\n\t\t\"stylers\": [\r\n\t\t\t{\r\n\t\t\t\t\"color\": \"#444444\"\r\n\t\t\t}\r\n\t\t]\r\n\t},\r\n\t{\r\n\t\t\"featureType\": \"landscape\",\r\n\t\t\"elementType\": \"all\",\r\n\t\t\"stylers\": [\r\n\t\t\t{\r\n\t\t\t\t\"color\": \"#f2f2f2\"\r\n\t\t\t}\r\n\t\t]\r\n\t},\r\n\t{\r\n\t\t\"featureType\": \"poi\",\r\n\t\t\"elementType\": \"all\",\r\n\t\t\"stylers\": [\r\n\t\t\t{\r\n\t\t\t\t\"visibility\": \"off\"\r\n\t\t\t}\r\n\t\t]\r\n\t},\r\n\t{\r\n\t\t\"featureType\": \"road\",\r\n\t\t\"elementType\": \"all\",\r\n\t\t\"stylers\": [\r\n\t\t\t{\r\n\t\t\t\t\"saturation\": -100\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t\"lightness\": 45\r\n\t\t\t}\r\n\t\t]\r\n\t},\r\n\t{\r\n\t\t\"featureType\": \"road.highway\",\r\n\t\t\"elementType\": \"all\",\r\n\t\t\"stylers\": [\r\n\t\t\t{\r\n\t\t\t\t\"visibility\": \"simplified\"\r\n\t\t\t}\r\n\t\t]\r\n\t},\r\n\t{\r\n\t\t\"featureType\": \"road.arterial\",\r\n\t\t\"elementType\": \"labels.icon\",\r\n\t\t\"stylers\": [\r\n\t\t\t{\r\n\t\t\t\t\"visibility\": \"off\"\r\n\t\t\t}\r\n\t\t]\r\n\t},\r\n\t{\r\n\t\t\"featureType\": \"transit\",\r\n\t\t\"elementType\": \"all\",\r\n\t\t\"stylers\": [\r\n\t\t\t{\r\n\t\t\t\t\"visibility\": \"off\"\r\n\t\t\t}\r\n\t\t]\r\n\t},\r\n\t{\r\n\t\t\"featureType\": \"water\",\r\n\t\t\"elementType\": \"all\",\r\n\t\t\"stylers\": [\r\n\t\t\t{\r\n\t\t\t\t\"color\": \"#e2e0df\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t\"visibility\": \"on\"\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n];\r\n","import MarkerClusterer from '@googlemaps/markerclustererplus';\r\nimport { Component, getContext } from 'rxcomp';\r\nimport { fromEvent } from 'rxjs';\r\nimport { filter, first, map, takeUntil } from 'rxjs/operators';\r\nimport { GoogleMapsService } from '../../common/googlemaps/googlemaps.service';\r\nimport { environment } from '../../environment';\r\nimport { MAP_STYLE } from './map.style';\r\n\r\nconst USE_CLUSTERER = true;\r\nconst FIT_BOUNDS = false;\r\n\r\nexport class MapComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tGoogleMapsService.maps$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe(maps => {\r\n\t\t\tconst google = window.google;\r\n\t\t\tconst { node } = getContext(this);\r\n\t\t\tconst center = this.center;\r\n\t\t\tconst item = this.items && this.items.length ? this.items[0] : null;\r\n\t\t\tconst position = item ? new google.maps.LatLng(item.latitude, item.longitude) : null;\r\n\r\n\t\t\tconst mapOptions = {\r\n\t\t\t\tzoom: 15, // 9,\r\n\t\t\t\tcenter: position,\r\n\t\t\t\t// scrollwheel: false,\r\n\t\t\t\tgestureHandling: 'cooperative',\r\n\t\t\t\t// mapTypeId: google.maps.MapTypeId.ROADMAP,\r\n\t\t\t\tzoomControlOptions: {\r\n\t\t\t\t\tstyle: google.maps.ZoomControlStyle.DEFAULT\r\n\t\t\t\t},\r\n\t\t\t\t// overviewMapControl: true,\r\n\t\t\t\t// scaleControl: false,\r\n\t\t\t\tzoomControl: true,\r\n\t\t\t\tmapTypeControl: false,\r\n\t\t\t\tstreetViewControl: false,\r\n\t\t\t\trotateControl: true,\r\n\t\t\t\tfullscreenControl: true,\r\n\t\t\t\tstyles: MAP_STYLE\r\n\t\t\t};\r\n\r\n\t\t\tconst mapElement = node.querySelector('.map');\r\n\t\t\tconst map = this.map = new google.maps.Map(mapElement, mapOptions);\r\n\t\t\tgoogle.maps.event.addListener(map, 'idle', () => {\r\n\t\t\t\tconst bounds = map.getBounds();\r\n\t\t\t\tthis.change.next(bounds);\r\n\t\t\t\t/*\r\n\t\t\t\tconst ne = bounds.getNorthEast();\r\n\t\t\t\tconst sw = bounds.getSouthWest();\r\n\t\t\t\tthis.change.next([ne.lat(), ne.lng(), sw.lat(), sw.lng()]);\r\n\t\t\t\t*/\r\n\t\t\t});\r\n\t\t\tthis.addMarkers(this.items);\r\n\t\t\tif (!this.items) {\r\n\t\t\t\tmap.fitBounds(this.getItalyBounds());\r\n\t\t\t}\r\n\t\t\tthis.ready.next(this);\r\n\t\t});\r\n\t\tthis.wheel$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\twheel$() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst mapElement = node.querySelector('.map');\r\n\t\treturn fromEvent(mapElement, 'wheel').pipe(\r\n\t\t\tmap((event) => {\r\n\t\t\t\tif (event.ctrlKey == true) {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tevent.stopImmediatePropagation();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t)\r\n\t}\r\n\r\n\tonChanges() {\r\n\t\tif (this.markersDidChange()) {\r\n\t\t\tthis.clearMarkers();\r\n\t\t\tthis.addMarkers(this.items);\r\n\t\t}\r\n\t}\r\n\r\n\tmarkersDidChange() {\r\n\t\tlet changed = false;\r\n\t\tif (!this.markers) {\r\n\t\t\tchanged = true;\r\n\t\t} else if (this.items.length !== this.markers.length) {\r\n\t\t\tchanged = true;\r\n\t\t} else {\r\n\t\t\tchanged = this.markers.reduce((p, marker, i) => {\r\n\t\t\t\treturn p || (marker.item !== this.items[i]);\r\n\t\t\t}, false);\r\n\t\t}\r\n\t\treturn changed;\r\n\t}\r\n\r\n\tclearMarkers() {\r\n\t\tif (this.markerCluster) {\r\n\t\t\tthis.markerCluster.clearMarkers();\r\n\t\t}\r\n\t\tif (this.markers) {\r\n\t\t\tthis.markers.forEach(marker => marker.setMap(null));\r\n\t\t}\r\n\t}\r\n\r\n\taddMarkers(items) {\r\n\t\tconst map = this.map;\r\n\t\tif (map && items) {\r\n\t\t\tconst bounds = new google.maps.LatLngBounds();\r\n\t\t\tconst markers = items.map((item) => {\r\n\t\t\t\tconst position = new google.maps.LatLng(item.latitude, item.longitude);\r\n\t\t\t\tbounds.extend(position);\r\n\t\t\t\tlet content = /* html */`<div class=\"card--store-locator\">\r\n\t\t\t\t\t<div class=\"card__content\">\r\n\t\t\t\t\t\t<div class=\"card__name\"><span>${item.name}</span></div>\r\n\t\t\t\t\t\t<div class=\"card__address\">${item.address}</div>\r\n\t\t\t\t\t\t<div class=\"card__city\">${item.city}</div>\r\n\t\t\t\t\t\t<div class=\"card__country\">${item.country.name}</div>\r\n\t\t\t\t\t\t${item.phone ? `<a class=\"card__phone\" href=\"tel:${item.phone}\">${item.phone}</a>` : ''}\r\n\t\t\t\t\t\t${item.fax ? `<a class=\"card__fax\" href=\"tel:${item.fax}\">${item.fax}</a>` : ''}\r\n\t\t\t\t\t\t${item.email ? `<a class=\"card__email\" href=\"mailto:${item.email}\">${item.email}</a>` : ''}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>`;\r\n\t\t\t\t/*\r\n\t\t\t\t`<div class=\"marker__content\">\r\n\t\t\t\t\t<div class=\"title\"><span>${item.name}</span></div>\r\n\t\t\t\t\t<div class=\"group group--info\">\r\n\t\t\t\t\t\t<div class=\"address\">\r\n\t\t\t\t\t\t\t${item.address}<br>\r\n\t\t\t\t\t\t\t${item.city} ${item.country}<br>\r\n\t\t\t\t\t\t\t${item.phone ? `<span><a href=\"tel:${item.phone}\">${item.phone}</a><br></span>` : ''}\r\n\t\t\t\t\t\t\t${item.fax ? `<span><a href=\"tel:${item.fax}\">${item.fax}</a><br></span>` : ''}\r\n\t\t\t\t\t\t\t${item.email ? `<span><a href=\"mailto:${item.email}\">${item.email}</a><br></span>` : ''}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t${item.address !== '' ? `<div class=\"distance\">${this.labels.approximately} <b>${Math.floor(item.distance)} km</b></div>` : ``}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"group group--cta\">\r\n\t\t\t\t\t\t${item.address !== '' ? `<a id=\"locator-marker\" href=\"https://www.google.it/maps/dir/${position.lat()},${position.lng()}/${item.title}/@${item.latitude},${item.longitude}/\" target=\"_blank\" class=\"btn btn--link\"><span>${this.labels.reachStore}</span></a>` : ``}\r\n\t\t\t\t\t\t${item.type === 8 || item.type === 9 ? `<a id=\"contact-item\" href=\"${window.itemLocatorSettings.urlStoreContact}?item=${item.id}\" target=\"_blank\" class=\"btn btn--link\"><span>${this.labels.contactStore}</span></a>` : ''}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>`\r\n\t\t\t\t*/\r\n\t\t\t\tconst markerImage = new google.maps.MarkerImage(\r\n\t\t\t\t\t`${environment.assets}img/maps/marker-sm.png`,\r\n\t\t\t\t\tnew google.maps.Size(24, 32),\r\n\t\t\t\t);\r\n\t\t\t\tlet marker = new google.maps.Marker({\r\n\t\t\t\t\tposition: position,\r\n\t\t\t\t\tmap: USE_CLUSTERER ? null : map,\r\n\t\t\t\t\ticon: markerImage,\r\n\t\t\t\t\ttitle: item.title,\r\n\t\t\t\t\titem: item,\r\n\t\t\t\t\tcontent: content,\r\n\t\t\t\t});\r\n\t\t\t\tmarker.addListener('click', () => {\r\n\t\t\t\t\tthis.setMarkerWindow(marker.position, content);\r\n\t\t\t\t\t// this.scrollToStore(item);\r\n\t\t\t\t\t// GtmService.push({ event: 'dealerlocator', action: 'marker-click', label: item.title });\r\n\t\t\t\t});\r\n\t\t\t\titem.marker = marker;\r\n\t\t\t\treturn marker;\r\n\t\t\t});\r\n\t\t\tif (USE_CLUSTERER) {\r\n\t\t\t\tconst markerCluster = new MarkerClusterer(this.map, markers, {\r\n\t\t\t\t\timagePath: `${environment.assets}img/maps/cluster-`,\r\n\t\t\t\t});\r\n\t\t\t\tconst styles = markerCluster.getStyles();\r\n\t\t\t\tconst sizes = [48, 56, 64, 72, 80];\r\n\t\t\t\tstyles.forEach((style, i) => {\r\n\t\t\t\t\tstyle.width = sizes[i];\r\n\t\t\t\t\tstyle.height = sizes[i];\r\n\t\t\t\t\tstyle.textLineHeight = sizes[i];\r\n\t\t\t\t\tstyle.textSize = Math.floor(style.width / 5);\r\n\t\t\t\t\tstyle.textColor = '#ffffff';\r\n\t\t\t\t});\r\n\t\t\t\tmarkerCluster.setStyles(styles);\r\n\t\t\t\tthis.markerCluster = markerCluster;\r\n\t\t\t}\r\n\t\t\tthis.markers = markers;\r\n\t\t\tif (FIT_BOUNDS) {\r\n\t\t\t\t// fix for minimum bound size\r\n\t\t\t\tconst boundsNE = bounds.getNorthEast();\r\n\t\t\t\tconst boundsSW = bounds.getSouthWest();\r\n\t\t\t\tconst minLatLng = 0.04;\r\n\t\t\t\tconst lat = Math.abs(boundsNE.lat() - boundsSW.lat());\r\n\t\t\t\tconst lng = Math.abs(boundsNE.lng() - boundsSW.lng());\r\n\t\t\t\tif (lat < minLatLng || lng < minLatLng) {\r\n\t\t\t\t\t// console.log(boundsNE.lat(), boundsNE.lng(), boundsSW.lat(), boundsSW.lng());\r\n\t\t\t\t\tconst dLat = (minLatLng - lat) / 2;\r\n\t\t\t\t\tconst dLng = (minLatLng - lng) / 2;\r\n\t\t\t\t\tconst extendNE = new google.maps.LatLng(boundsNE.lat() + dLat, boundsNE.lng() + dLng);\r\n\t\t\t\t\tconst extendSW = new google.maps.LatLng(boundsSW.lat() - dLat, boundsSW.lng() - dLng);\r\n\t\t\t\t\tbounds.extend(extendNE);\r\n\t\t\t\t\tbounds.extend(extendSW);\r\n\t\t\t\t}\r\n\t\t\t\tmap.fitBounds(bounds);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tgetGeolocation(map) {\r\n\t\tthis.error = null;\r\n\t\tthis.busyLocation = true;\r\n\t\tlet position = this.map.getCenter();\r\n\r\n\t\t// Try HTML5 geolocation.\r\n\t\tif (navigator.geolocation) {\r\n\t\t\tnavigator.geolocation.getCurrentPosition((location) => {\r\n\t\t\t\tposition = new google.maps.LatLng(location.coords.latitude, location.coords.longitude);\r\n\t\t\t\tconst geocoder = this.geocoder || new google.maps.Geocoder();\r\n\t\t\t\tthis.geocoder = geocoder;\r\n\t\t\t\tgeocoder.geocode({ 'location': position }, (results, status) => {\r\n\t\t\t\t\tif (status == 'OK') {\r\n\t\t\t\t\t\tconst filteredInfoCity = results.filter(function(address_component) {\r\n\t\t\t\t\t\t\treturn address_component.types.includes(\"locality\");\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.model.city = filteredInfoCity.length ? filteredInfoCity[0].formatted_address : undefined;\r\n\t\t\t\t\t\tthis.model.address = results[0].formatted_address;\r\n\t\t\t\t\t\tfor (let i = 0; i < results[0].address_components.length; i++) {\r\n\t\t\t\t\t\t\tif (results[0].address_components[i].types[0] == \"country\" || results[0].address_components[i].types[0] == \"political\") {\r\n\t\t\t\t\t\t\t\tthis.searchCountry = results[0].address_components[i].short_name;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.setInfoWindow(position, 1);\r\n\t\t\t\t\t\tthis.searchPosition(position).finally(() => this.busyLocation = false);\r\n\t\t\t\t\t\tthis.map.setCenter(position);\r\n\t\t\t\t\t\tthis.map.setZoom(ZOOM_LEVEL);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}, () => {\r\n\t\t\t\tthis.setInfoWindow(position, 2);\r\n\t\t\t\tthis.searchPosition(position).finally(() => this.busyLocation = false);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\t// Browser doesn't support Geolocation\r\n\t\t\tthis.setInfoWindow(position, 3);\r\n\t\t\tthis.searchPosition(position).finally(() => this.busyLocation = false);\r\n\t\t}\r\n\t}\r\n\r\n\tfitBounds(items) {\r\n\t\tconst map = this.map;\r\n\t\tif (map && items.length) {\r\n\t\t\tconst bounds = new google.maps.LatLngBounds();\r\n\t\t\titems.forEach((item) => {\r\n\t\t\t\tconst position = new google.maps.LatLng(item.latitude, item.longitude);\r\n\t\t\t\tbounds.extend(position);\r\n\t\t\t});\r\n\t\t\tmap.fitBounds(bounds);\r\n\t\t\t// console.log('fitBounds');\r\n\t\t\tthis.setMinimumZoom();\r\n\t\t}\r\n\t}\r\n\r\n\tpanTo(item) {\r\n\t\tconst position = new google.maps.LatLng(item.latitude, item.longitude);\r\n\t\tthis.map.setZoom(ZOOM_LEVEL);\r\n\t\tthis.map.panTo(position);\r\n\t\tconst marker = this.markers.find(x => x.item === item);\r\n\t\tthis.setMarkerWindow(marker.position, marker.content);\r\n\t}\r\n\r\n\tsetMarkerWindow(position, content) {\r\n\t\tif (position) {\r\n\t\t\tif (this.subscription) {\r\n\t\t\t\tthis.subscription.unsubscribe();\r\n\t\t\t\tthis.subscription = null;\r\n\t\t\t}\r\n\t\t\tconst markerWindow = this.markerWindow || new google.maps.InfoWindow({\r\n\t\t\t\tpixelOffset: new google.maps.Size(0, -35)\r\n\t\t\t});\r\n\t\t\tthis.markerWindow = markerWindow;\r\n\t\t\tmarkerWindow.setPosition(position);\r\n\t\t\tmarkerWindow.setContent(content);\r\n\t\t\tmarkerWindow.open(this.map);\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tif (this.subscription) {\r\n\t\t\t\t\tthis.subscription.unsubscribe();\r\n\t\t\t\t\tthis.subscription = null;\r\n\t\t\t\t}\r\n\t\t\t\tthis.subscription = this.clickOutside$('[role=\"dialog\"]').subscribe(() => {\r\n\t\t\t\t\tthis.closeMarkerWindow();\r\n\t\t\t\t});\r\n\t\t\t}, 50);\r\n\t\t} else {\r\n\t\t\tthis.closeMarkerWindow();\r\n\t\t}\r\n\t}\r\n\r\n\tclickOutside$(clickOutsideSelector) {\r\n\t\treturn fromEvent(document, 'click').pipe(\r\n\t\t\tfilter(event => {\r\n\t\t\t\tconst target = event.target;\r\n\t\t\t\tconst clickOutsideTarget = document.querySelector(clickOutsideSelector);\r\n\t\t\t\tconst clickedInside = clickOutsideTarget.contains(target) || !document.contains(target);\r\n\t\t\t\tif (!clickedInside) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t)\r\n\t}\r\n\r\n\tcloseMarkerWindow() {\r\n\t\tif (this.markerWindow) {\r\n\t\t\tthis.markerWindow.close();\r\n\t\t}\r\n\t}\r\n\r\n\tgetWorldBounds() {\r\n\t\treturn new google.maps.LatLngBounds(\r\n\t\t\tnew google.maps.LatLng(61, 60),\r\n\t\t\tnew google.maps.LatLng(-37, -92)\r\n\t\t);\r\n\t}\r\n\r\n\tgetItalyBounds() {\r\n\t\treturn new google.maps.LatLngBounds(\r\n\t\t\tnew google.maps.LatLng(46.4657567, 5.233972),\r\n\t\t\tnew google.maps.LatLng(36.8257773, 18.963541)\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMapComponent.meta = {\r\n\tselector: '[map]',\r\n\tinputs: ['center', 'items'],\r\n\toutputs: ['ready', 'change'],\r\n};\r\n","import { getContext } from 'rxcomp';\r\nimport { SwiperDirective } from '../../common/swiper/swiper.directive';\r\n\r\nexport class SwiperGalleryDirective extends SwiperDirective {\r\n\r\n\tonInit() {\r\n\t\tthis.options = {\r\n\t\t\tslidesPerView: 'auto',\r\n\t\t\tspaceBetween: 40,\r\n\t\t\tspeed: 600,\r\n\t\t\tcenteredSlides: true,\r\n\t\t\t/*\r\n\t\t\tloop: true,\r\n\t\t\tloopAdditionalSlides: 100,\r\n\t\t\t*/\r\n\t\t\tkeyboardControl: true,\r\n\t\t\tmousewheelControl: false,\r\n\t\t\tkeyboard: {\r\n\t\t\t\tenabled: true,\r\n\t\t\t\tonlyInViewport: true,\r\n\t\t\t},\r\n\t\t\tpagination: {\r\n\t\t\t\tel: '.swiper-pagination',\r\n\t\t\t\tclickable: true,\r\n\t\t\t},\r\n\t\t};\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst target = node.classList.contains('swiper-container') ? node : node.querySelector('.swiper-container');\r\n\t\tthis.init_(target);\r\n\t\t// console.log('SwiperGalleryDirective.onInit');\r\n\t}\r\n\r\n}\r\n\r\nSwiperGalleryDirective.meta = {\r\n\tselector: '[swiper-gallery]'\r\n};\r\n","import { getContext } from 'rxcomp';\r\nimport { SwiperDirective } from '../../common/swiper/swiper.directive';\r\n\r\nexport class SwiperHomepageDirective extends SwiperDirective {\r\n\r\n\tonInit() {\r\n\t\tthis.options = {\r\n\t\t\tslidesPerView: 1,\r\n\t\t\tspaceBetween: 0,\r\n\t\t\tspeed: 600,\r\n\t\t\tkeyboardControl: true,\r\n\t\t\tmousewheelControl: false,\r\n\t\t\t/*\r\n\t\t\tautoplay: {\r\n\t\t\t\tdelay: 5000,\r\n\t\t\t\tdisableOnInteraction: true,\r\n\t\t\t\tpauseOnMouseEnter: true,\r\n\t\t\t},\r\n\t\t\t*/\r\n\t\t\tkeyboard: {\r\n\t\t\t\tenabled: true,\r\n\t\t\t\tonlyInViewport: true,\r\n\t\t\t},\r\n\t\t\tpagination: {\r\n\t\t\t\tel: '.swiper-pagination',\r\n\t\t\t\tclickable: true,\r\n\t\t\t},\r\n\t\t\tnavigation: {\r\n\t\t\t\tnextEl: '.swiper-button-next',\r\n\t\t\t\tprevEl: '.swiper-button-prev',\r\n\t\t\t},\r\n\t\t};\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst target = node.classList.contains('swiper-container') ? node : node.querySelector('.swiper-container');\r\n\t\tthis.init_(target);\r\n\t\t// console.log('SwiperHomepageDirective.onInit');\r\n\t}\r\n\r\n}\r\n\r\nSwiperHomepageDirective.meta = {\r\n\tselector: '[swiper-homepage]'\r\n};\r\n","import { getContext } from 'rxcomp';\r\nimport { SwiperDirective } from '../../common/swiper/swiper.directive';\r\n\r\nexport class SwiperNewsPropositionDirective extends SwiperDirective {\r\n\r\n\tonInit() {\r\n\t\tconst inHomepage = document.querySelector('.main--homepage') != null;\r\n\t\tthis.options = {\r\n\t\t\tslidesPerView: 1.5,\r\n\t\t\tspaceBetween: 30,\r\n\t\t\tbreakpoints: inHomepage ? {\r\n\t\t\t\t768: {\r\n\t\t\t\t\tslidesPerView: 2,\r\n\t\t\t\t\tspaceBetween: 40\r\n\t\t\t\t},\r\n\t\t\t\t1024: {\r\n\t\t\t\t\tslidesPerView: 2,\r\n\t\t\t\t\tspaceBetween: 50\r\n\t\t\t\t},\r\n\t\t\t\t1440: {\r\n\t\t\t\t\tslidesPerView: 2,\r\n\t\t\t\t\tspaceBetween: 60\r\n\t\t\t\t},\r\n\t\t\t\t1920: {\r\n\t\t\t\t\tslidesPerView: 2,\r\n\t\t\t\t\tspaceBetween: 70\r\n\t\t\t\t}\r\n\t\t\t} : {\r\n\t\t\t\t768: {\r\n\t\t\t\t\tslidesPerView: 2,\r\n\t\t\t\t\tspaceBetween: 40\r\n\t\t\t\t},\r\n\t\t\t\t1024: {\r\n\t\t\t\t\tslidesPerView: 4,\r\n\t\t\t\t\tspaceBetween: 50\r\n\t\t\t\t},\r\n\t\t\t\t1440: {\r\n\t\t\t\t\tslidesPerView: 4,\r\n\t\t\t\t\tspaceBetween: 60\r\n\t\t\t\t},\r\n\t\t\t\t1920: {\r\n\t\t\t\t\tslidesPerView: 4,\r\n\t\t\t\t\tspaceBetween: 70\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tspeed: 600,\r\n\t\t\tcenteredSlides: false,\r\n\t\t\tloop: false,\r\n\t\t\tloopAdditionalSlides: 100,\r\n\t\t\tkeyboardControl: true,\r\n\t\t\tmousewheelControl: false,\r\n\t\t\tkeyboard: {\r\n\t\t\t\tenabled: true,\r\n\t\t\t\tonlyInViewport: true,\r\n\t\t\t},\r\n\t\t\tpagination: {\r\n\t\t\t\tel: '.swiper-pagination',\r\n\t\t\t\tclickable: true,\r\n\t\t\t},\r\n\t\t};\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst target = node.querySelector('.swiper-container');\r\n\t\tthis.init_(target);\r\n\t\t// console.log('SwiperNewsPropositionDirective.onInit');\r\n\t}\r\n\r\n}\r\n\r\nSwiperNewsPropositionDirective.meta = {\r\n\tselector: '[swiper-news-proposition]'\r\n};\r\n","import { getContext } from 'rxcomp';\r\nimport { SwiperDirective } from '../../common/swiper/swiper.directive';\r\n\r\nexport class SwiperProductsPropositionDirective extends SwiperDirective {\r\n\r\n\tonInit() {\r\n\t\tthis.options = {\r\n\t\t\tslidesPerView: 'auto',\r\n\t\t\t// slidesPerView: 1.5,\r\n\t\t\tspaceBetween: 30,\r\n\t\t\tbreakpoints: {\r\n\t\t\t\t768: {\r\n\t\t\t\t\tslidesPerView: 'auto',\r\n\t\t\t\t\tspaceBetween: 40,\r\n\t\t\t\t},\r\n\t\t\t\t1024: {\r\n\t\t\t\t\tslidesPerView: 'auto',\r\n\t\t\t\t\tspaceBetween: 50\r\n\t\t\t\t},\r\n\t\t\t\t1440: {\r\n\t\t\t\t\tslidesPerView: 'auto',\r\n\t\t\t\t\tspaceBetween: 60\r\n\t\t\t\t},\r\n\t\t\t\t1920: {\r\n\t\t\t\t\tslidesPerView: 'auto',\r\n\t\t\t\t\tspaceBetween: 70\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t/*\r\n\t\t\tslidesPerView: 1.5,\r\n\t\t\tspaceBetween: 30,\r\n\t\t\tbreakpoints: {\r\n\t\t\t\t768: {\r\n\t\t\t\t\tslidesPerView: 2,\r\n\t\t\t\t\tspaceBetween: 40\r\n\t\t\t\t},\r\n\t\t\t\t1024: {\r\n\t\t\t\t\tslidesPerView: 3,\r\n\t\t\t\t\tspaceBetween: 50\r\n\t\t\t\t},\r\n\t\t\t\t1440: {\r\n\t\t\t\t\tslidesPerView: 3,\r\n\t\t\t\t\tspaceBetween: 60\r\n\t\t\t\t},\r\n\t\t\t\t1920: {\r\n\t\t\t\t\tslidesPerView: 3,\r\n\t\t\t\t\tspaceBetween: 70\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t*/\r\n\t\t\tspeed: 600,\r\n\t\t\tcenteredSlides: false,\r\n\t\t\tloop: false,\r\n\t\t\tloopAdditionalSlides: 100,\r\n\t\t\tkeyboardControl: true,\r\n\t\t\tmousewheelControl: false,\r\n\t\t\tkeyboard: {\r\n\t\t\t\tenabled: true,\r\n\t\t\t\tonlyInViewport: true,\r\n\t\t\t},\r\n\t\t\tpagination: {\r\n\t\t\t\tel: '.swiper-pagination',\r\n\t\t\t\tclickable: true,\r\n\t\t\t},\r\n\t\t};\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst target = node.querySelector('.swiper-container');\r\n\t\tthis.init_(target);\r\n\t\t// console.log('SwiperProductsPropositionDirective.onInit');\r\n\t}\r\n\r\n}\r\n\r\nSwiperProductsPropositionDirective.meta = {\r\n\tselector: '[swiper-products-proposition]'\r\n};\r\n","import { getContext } from 'rxcomp';\r\nimport { SwiperDirective } from '../../common/swiper/swiper.directive';\r\n\r\nexport class SwiperProjectsPropositionDirective extends SwiperDirective {\r\n\r\n\tonInit() {\r\n\t\tconst inHomepage = document.querySelector('.main--homepage') != null;\r\n\t\tthis.options = {\r\n\t\t\tslidesPerView: 1.5,\r\n\t\t\tspaceBetween: 30,\r\n\t\t\tbreakpoints: inHomepage ? {\r\n\t\t\t\t768: {\r\n\t\t\t\t\tslidesPerView: 2,\r\n\t\t\t\t\tspaceBetween: 40\r\n\t\t\t\t},\r\n\t\t\t\t1024: {\r\n\t\t\t\t\tslidesPerView: 3,\r\n\t\t\t\t\tspaceBetween: 50\r\n\t\t\t\t},\r\n\t\t\t\t1440: {\r\n\t\t\t\t\tslidesPerView: 3,\r\n\t\t\t\t\tspaceBetween: 60\r\n\t\t\t\t},\r\n\t\t\t\t1920: {\r\n\t\t\t\t\tslidesPerView: 3,\r\n\t\t\t\t\tspaceBetween: 70\r\n\t\t\t\t}\r\n\t\t\t} : {\r\n\t\t\t\t768: {\r\n\t\t\t\t\tslidesPerView: 2,\r\n\t\t\t\t\tspaceBetween: 40\r\n\t\t\t\t},\r\n\t\t\t\t1024: {\r\n\t\t\t\t\tslidesPerView: 4,\r\n\t\t\t\t\tspaceBetween: 50\r\n\t\t\t\t},\r\n\t\t\t\t1440: {\r\n\t\t\t\t\tslidesPerView: 4,\r\n\t\t\t\t\tspaceBetween: 60\r\n\t\t\t\t},\r\n\t\t\t\t1920: {\r\n\t\t\t\t\tslidesPerView: 4,\r\n\t\t\t\t\tspaceBetween: 70\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tspeed: 600,\r\n\t\t\tcenteredSlides: false,\r\n\t\t\tloop: false,\r\n\t\t\tloopAdditionalSlides: 100,\r\n\t\t\tkeyboardControl: true,\r\n\t\t\tmousewheelControl: false,\r\n\t\t\tkeyboard: {\r\n\t\t\t\tenabled: true,\r\n\t\t\t\tonlyInViewport: true,\r\n\t\t\t},\r\n\t\t\tpagination: {\r\n\t\t\t\tel: '.swiper-pagination',\r\n\t\t\t\tclickable: true,\r\n\t\t\t},\r\n\t\t};\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst target = node.querySelector('.swiper-container');\r\n\t\tthis.init_(target);\r\n\t\t// console.log('SwiperProjectsPropositionDirective.onInit');\r\n\t}\r\n\r\n}\r\n\r\nSwiperProjectsPropositionDirective.meta = {\r\n\tselector: '[swiper-projects-proposition]'\r\n};\r\n","import { Component } from 'rxcomp';\r\nimport { first, takeUntil } from 'rxjs/operators';\r\nimport { environment } from '../../environment';\r\nimport { CartService } from '../../pages/cart/cart.service';\r\nimport { HeaderService } from '../header/header.service';\r\nimport { CartMiniService } from './cart-mini.service';\r\n\r\nexport class CartMiniComponent extends Component {\r\n\r\n\tget totalPrice() {\r\n\t\tconst items = this.items || [];\r\n\t\treturn items.reduce((p, c, i) => {\r\n\t\t\treturn p + c.price.price * c.qty;\r\n\t\t}, 0);\r\n\t}\r\n\r\n\tonInit() {\r\n\t\tthis.items = [];\r\n\t\tCartMiniService.items$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(items => {\r\n\t\t\tthis.items = items;\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t}\r\n\r\n\tonIncrement(item) {\r\n\t\tCartMiniService.incrementItem$(item).pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tonDecrement(item) {\r\n\t\tCartMiniService.decrementItem$(item).pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tonBuy(event) {\r\n\t\tCartService.setCart(null);\r\n\t\twindow.location.href = `${environment.slug.cart}`;\r\n\t}\r\n\r\n\tonEdit(item) {\r\n\t\t// console.log('CartMiniComponent.onEdit', item);\r\n\t\tif (environment.flags.production) {\r\n\t\t\twindow.location.href = `${item.url}/config?productId=${item.id}&code=${item.code}${item.showefy ? `&sl=${item.showefy.product_link.split('&sl=')[1]}` : ''}`;\r\n\t\t} else {\r\n\t\t\twindow.location.href = `${environment.slug.configureProduct}?productId=${item.id}&code=${item.code}${item.showefy ? `&sl=${item.showefy.product_link.split('&sl=')[1]}` : ''}`;\r\n\t\t}\r\n\t}\r\n\r\n\tonRemoveAll(event) {\r\n\t\tCartMiniService.removeAll$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tonClose(event) {\r\n\t\tHeaderService.onBack();\r\n\t}\r\n}\r\n\r\nCartMiniComponent.meta = {\r\n\tselector: '[cart-mini]',\r\n};\r\n","import { Component } from 'rxcomp';\r\n\r\nexport class ErrorComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.showDetail = false;\r\n\t\t// console.log('ErrorComponent.onInit', this.error);\r\n\t}\r\n\r\n\tonDetailToggle() {\r\n\t\tthis.showDetail = !this.showDetail;\r\n\t\tthis.pushChanges();\r\n\t}\r\n}\r\n\r\nErrorComponent.meta = {\r\n\tselector: 'error-component',\r\n\tinputs: ['error'],\r\n\ttemplate: /* html */ `\r\n\t<div class=\"error\" (click)=\"onDetailToggle($event)\">\r\n\t\t<div class=\"status\">Error <span [innerHTML]=\"error.status\"></span></div>\r\n\t\t<div class=\"exception-message\" [innerHTML]=\"error.exceptionMessage\"></div>\r\n\t\t<button type=\"button\" class=\"btn--detail\"><svg class=\"caret-down\"><use xlink:href=\"#caret-down\"></use></svg></button>\r\n\t</div>\r\n\t<div class=\"error-details\" *if=\"showDetail\">\r\n\t\t<div class=\"message\" [innerHTML]=\"error.message\"></div>\r\n\t\t<div class=\"exception-type\" [innerHTML]=\"error.exceptionType\"></div>\r\n\t\t<div class=\"stack-trace\" [innerHTML]=\"error.stackTrace\"></div>\r\n\t</div>\r\n\t`\r\n};\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { first, takeUntil } from 'rxjs/operators';\r\nimport { UserService } from '../user/user.service';\r\nimport { FilesService } from './files.service';\r\n\r\nexport class FilesComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.showFiles = false;\r\n\t\tthis.user = null;\r\n\t\tUserService.me$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe(user => {\r\n\t\t\tthis.user = user;\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t\tthis.files = [];\r\n\t\tFilesService.files$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(files => {\r\n\t\t\tthis.files = files;\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t}\r\n\r\n\tonToggleFiles(event) {\r\n\t\tthis.showFiles = !this.showFiles;\r\n\t\tthis.pushChanges();\r\n\t}\r\n\r\n\tonToggleFile(file) {\r\n\t\t(this.isAddedToFiles(file) ? FilesService.removeFile$(file) : FilesService.addFile$(file)).pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe(_ => {\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t}\r\n\r\n\tisAddedToFiles(file) {\r\n\t\treturn FilesService.hasFile(file);\r\n\t}\r\n\r\n\tonDownloadAll(event) {\r\n\t\tevent.preventDefault();\r\n\t\tconst { node } = getContext(this);\r\n\t\tFilesService.currentFiles.forEach(file => {\r\n\t\t\tconst link = document.createElement('a');\r\n\t\t\tlink.setAttribute('href', file.url);\r\n\t\t\tlink.setAttribute('download', file.title);\r\n\t\t\tlink.setAttribute('target', '_blank');\r\n\t\t\tlink.click();\r\n\t\t\t/*\r\n\t\t\tconst item = node.querySelector(`[href]=\"${file.url}\"`);\r\n\t\t\tif (item) {\r\n\t\t\t\titem.click();\r\n\t\t\t}\r\n\t\t\t*/\r\n\t\t\t// window.open(file.url, '_blank');\r\n\t\t});\r\n\t}\r\n\r\n\tonRemoveAll(event) {\r\n\t\tFilesService.removeAll$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n}\r\n\r\nFilesComponent.meta = {\r\n\tselector: '[files]',\r\n};\r\n","import { BehaviorSubject } from 'rxjs';\r\n\r\nexport class MenuService {\r\n\r\n\tstatic menu$_ = new BehaviorSubject(-1);\r\n\r\n\tstatic get currentMenu() {\r\n\t\treturn this.menu$_.getValue();\r\n\t}\r\n\r\n\tstatic setMenu(id) {\r\n\t\tthis.menu$_.next(id);\r\n\t}\r\n\r\n\tstatic toggleMenu(id) {\r\n\t\tthis.menu$_.next(this.currentMenu === id ? -1 : id);\r\n\t}\r\n\r\n\tstatic onBack() {\r\n\t\tthis.menu$_.next(-1);\r\n\t}\r\n\r\n\tstatic menu$() {\r\n\t\treturn this.menu$_;\r\n\t}\r\n\r\n}\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { first, takeUntil } from 'rxjs/operators';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { ModalResolveEvent, ModalService } from '../../common/modal/modal.service';\r\nimport { environment } from '../../environment';\r\nimport { CartMiniService } from '../cart-mini/cart-mini.service';\r\nimport { MenuService } from '../menu/menu.service';\r\nimport { UserService } from '../user/user.service';\r\nimport { HeaderService } from './header.service';\r\n\r\nconst USE_MODAL = false;\r\n\r\nexport class HeaderComponent extends Component {\r\n\r\n\tdirection_ = null;\r\n\tget direction() {\r\n\t\treturn this.direction_;\r\n\t}\r\n\tset direction(direction) {\r\n\t\tif (this.direction_ !== direction) {\r\n\t\t\tconst { node } = getContext(this);\r\n\t\t\tnode.classList.remove(`scrolling-${this.direction_}`);\r\n\t\t\tnode.classList.add(`scrolling-${direction}`);\r\n\t\t\tthis.direction_ = direction;\r\n\t\t}\r\n\t}\r\n\r\n\tscrolled_ = null;\r\n\tget scrolled() {\r\n\t\treturn this.scrolled_;\r\n\t}\r\n\tset scrolled(scrolled) {\r\n\t\tif (this.scrolled_ !== scrolled) {\r\n\t\t\tthis.scrolled_ = scrolled;\r\n\t\t\tconst { node } = getContext(this);\r\n\t\t\tscrolled ? node.classList.add(`scrolled`) : node.classList.remove(`scrolled`);\r\n\t\t}\r\n\t}\r\n\r\n\tonInit() {\r\n\t\tconst body = document.querySelector('body');\r\n\t\tthis.header = HeaderService.currentHeader;\r\n\t\tHeaderService.header$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe(header => {\r\n\t\t\tif (header === 'search') {\r\n\t\t\t\tLocomotiveScrollService.stop();\r\n\t\t\t} else if (this.header === 'search') {\r\n\t\t\t\tLocomotiveScrollService.start();\r\n\t\t\t}\r\n\t\t\tthis.header = header;\r\n\t\t\tthis.pushChanges();\r\n\t\t\tbody.setAttribute('class', header !== -1 ? `${header}-active` : '');\r\n\t\t});\r\n\t\tthis.menu = MenuService.currentMenu;\r\n\t\tMenuService.menu$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe(menu => {\r\n\t\t\tthis.menu = menu;\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t\tthis.cart = CartMiniService;\r\n\t\tthis.user = null;\r\n\t\tUserService.me$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe(user => {\r\n\t\t\tthis.user = user;\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t\tconst pictogram = document.querySelector('.page > .pictogram');\r\n\t\tLocomotiveScrollService.scroll$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe((event) => {\r\n\t\t\tthis.direction = event.direction;\r\n\t\t\tthis.scrolled = event.scroll.y > 100;\r\n\t\t\tconst opacity = 0.1 - 0.1 * Math.min(1, Math.max(0, (event.scroll.y - window.innerHeight * 3) / window.innerHeight / 3));\r\n\t\t\tif (pictogram) {\r\n\t\t\t\tgsap.set(pictogram, { opacity });\r\n\t\t\t}\r\n\t\t\t// console.log('HeaderComponent', event.scroll.y, event.direction, event.speed);\r\n\t\t});\r\n\t}\r\n\r\n\tonOpenMarketAndLanguage() {\r\n\t\tMenuService.onBack();\r\n\t\tHeaderService.onBack();\r\n\t\tModalService.open$({ src: environment.template.modal.marketsAndLanguagesModal }).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(event => {\r\n\t\t\tconsole.log('HeaderComponent.onOpenMarketAndLanguage', event);\r\n\t\t});\r\n\t}\r\n\r\n\tonLogin() {\r\n\t\tMenuService.onBack();\r\n\t\tHeaderService.onBack();\r\n\t\tif (USE_MODAL) {\r\n\t\t\tModalService.open$({ src: environment.template.modal.userModal, data: { view: 1 } }).pipe(\r\n\t\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t\t).subscribe(event => {\r\n\t\t\t\tconsole.log('HeaderComponent.onLogin', event);\r\n\t\t\t\tif (event instanceof ModalResolveEvent) {\r\n\t\t\t\t\twindow.location.href = environment.slug.reservedArea;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\twindow.location.href = environment.slug.reservedArea;\r\n\t\t}\r\n\t}\r\n\r\n\tonLogout() {\r\n\t\tUserService.signout$().pipe(\r\n\t\t\tfirst(),\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tonToggle(id) {\r\n\t\tMenuService.onBack();\r\n\t\tif (id !== 'cart' || !this.isCart) {\r\n\t\t\tHeaderService.toggleHeader(id);\r\n\t\t} else {\r\n\t\t\twindow.location.href = `${environment.slug.cart}?step=1`;\r\n\t\t}\r\n\t}\r\n\r\n\tonBack(event) {\r\n\t\tMenuService.onBack();\r\n\t}\r\n\r\n\tget isCart() {\r\n\t\treturn window.location.href.indexOf(environment.slug.cart) !== -1;\r\n\t}\r\n}\r\n\r\nHeaderComponent.meta = {\r\n\tselector: '[header]',\r\n};\r\n","import { Directive, getContext } from 'rxcomp';\r\nimport { takeUntil } from 'rxjs/operators';\r\nimport { HeaderService } from '../header/header.service';\r\nimport { MenuService } from './menu.service';\r\n\r\nexport class MenuDirective extends Directive {\r\n\r\n\tonInit() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst target = this.target = document.querySelector(`#menu-${this.menu}`);\r\n\t\tconst preview = target.querySelector('[data-target]');\r\n\t\tconst previewSrc = this.previewSrc = preview.src;\r\n\t\tconst container = this.container = target.querySelector(`.container`);\r\n\t\tthis.onClick = this.onClick.bind(this);\r\n\t\tthis.onLeave = this.onLeave.bind(this);\r\n\t\tnode.addEventListener('click', this.onClick);\r\n\t\tMenuService.menu$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe(menu_ => {\r\n\t\t\tif (this.menu === menu_) {\r\n\t\t\t\tthis.onEnter();\r\n\t\t\t} else {\r\n\t\t\t\tthis.onExit();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tonClick(event) {\r\n\t\tevent.preventDefault();\r\n\t\t// console.log('MenuDirective.onClick', this.menu);\r\n\t\tif (HeaderService.currentHeader !== 'menu') {\r\n\t\t\tHeaderService.onBack();\r\n\t\t}\r\n\t\tMenuService.toggleMenu(this.menu);\r\n\t}\r\n\r\n\tonLeave() {\r\n\t\t// console.log('MenuDirective.onLeave', this.menu);\r\n\t\tMenuService.onBack();\r\n\t\tthis.onExit();\r\n\t}\r\n\r\n\tonEnter() {\r\n\t\t// console.log('MenuDirective.onEnter', this.menu);\r\n\t\tconst target = this.target;\r\n\t\tconst preview = target.querySelector('[data-target]');\r\n\t\tpreview.src = this.previewSrc;\r\n\t\tconst container = this.container;\r\n\t\tcontainer.addEventListener('mouseleave', this.onLeave);\r\n\t}\r\n\r\n\tonExit() {\r\n\t\t// console.log('MenuDirective.onExit', this.menu);\r\n\t\tconst container = this.container;\r\n\t\tcontainer.removeEventListener('mouseleave', this.onLeave);\r\n\t}\r\n\r\n\tonDestroy() {\r\n\t\tthis.onExit();\r\n\t\tconst { node } = getContext(this);\r\n\t\tnode.removeEventListener('click', this.onClick);\r\n\t}\r\n}\r\n\r\nMenuDirective.meta = {\r\n\tselector: '[menu]',\r\n\tinputs: ['menu'],\r\n};\r\n","import { Component } from 'rxcomp';\r\nimport { FormControl, FormGroup, Validators } from 'rxcomp-form';\r\nimport { takeUntil } from 'rxjs/operators';\r\nimport { LocationService } from '../../common/location/location.service';\r\n\r\nexport class NewsletterPropositionComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\temail: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tform.changes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe((_) => {\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t}\r\n\r\n\tonNewsletter(event) {\r\n\t\tconsole.log('NewsletterPropositionComponent.onNewsletter', this.form.value);\r\n\t\tconst encoded = LocationService.encode('email', this.form.value.email, {});\r\n\t\twindow.location.href = `${this.action}?params=${encoded}`;\r\n\t}\r\n}\r\n\r\nNewsletterPropositionComponent.meta = {\r\n\tselector: '[newsletter-proposition]',\r\n\tinputs: ['action'],\r\n};\r\n","import { of } from 'rxjs';\r\nimport { map, tap } from 'rxjs/operators';\r\nimport { ApiService } from '../../common/api/api.service';\r\nimport { environment } from '../../environment';\r\n\r\nexport class SearchService {\r\n\r\n\tstatic search$_() {\r\n\t\tif (SearchService.items_) {\r\n\t\t\treturn of(SearchService.items_);\r\n\t\t} else {\r\n\t\t\treturn (\r\n\t\t\t\tenvironment.flags.production ?\r\n\t\t\t\t\tApiService.get$(`/search/search`) :\r\n\t\t\t\t\tApiService.get$(`/search/search.json`)\r\n\t\t\t).pipe(\r\n\t\t\t\ttap(items => {\r\n\t\t\t\t\titems.forEach(item => {\r\n\t\t\t\t\t\titem.title = SearchService.toTitleCase(item.title);\r\n\t\t\t\t\t\tif (item.abstract) {\r\n\t\t\t\t\t\t\titem.abstract = SearchService.toTitleCase(item.abstract);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tSearchService.items_ = items;\r\n\t\t\t\t}),\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tstatic search$(query) {\r\n\t\tquery = query.toLowerCase();\r\n\t\treturn this.search$_().pipe(\r\n\t\t\tmap(items => {\r\n\t\t\t\titems = items.filter(item => {\r\n\t\t\t\t\tif (item.title.toLowerCase().indexOf(query) !== -1) {\r\n\t\t\t\t\t\titem.result = item.title;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t} else if (item.abstract && item.abstract.toLowerCase().indexOf(query) !== -1) {\r\n\t\t\t\t\t\titem.result = item.abstract;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\titems.sort((a, b) => {\r\n\t\t\t\t\treturn a.result.toLowerCase().indexOf(query) - b.result.toLowerCase().indexOf(query);\r\n\t\t\t\t});\r\n\t\t\t\treturn items;\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n\tstatic toTitleCase(sentence, seps = ' _-/') {\r\n\t\tconst capitalize = str => str.length ? str[0].toUpperCase() + str.slice(1).toLowerCase() : '';\r\n\t\tconst escape = str => str.replace(/./g, c => `\\\\${c}`);\r\n\t\tlet wordPattern = new RegExp(`[^${escape(seps)}]+`, 'g');\r\n\t\treturn sentence.replace(wordPattern, capitalize);\r\n\t}\r\n\r\n}\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { FormControl, FormGroup, Validators } from 'rxcomp-form';\r\nimport { of } from 'rxjs';\r\nimport { auditTime, delay, distinctUntilChanged, map, switchMap, takeUntil } from 'rxjs/operators';\r\nimport { SearchService } from './search.service';\r\n\r\nexport const SEARCH_LIMIT_RESULT = 50;\r\n\r\nexport class SearchComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.busy = false;\r\n\t\tthis.items = [];\r\n\t\tthis.visibleItems = [];\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\tsearch: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tthis.search$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$),\r\n\t\t).subscribe((items) => {\r\n\t\t\tthis.items = items;\r\n\t\t\tthis.visibleItems = items.slice(0, Math.min(SEARCH_LIMIT_RESULT, items.length));\r\n\t\t\tthis.busy = false;\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t\tsetTimeout(() => {\r\n\t\t\tconst { node } = getContext(this);\r\n\t\t\tconst input = node.querySelector('.control--text');\r\n\t\t\tif (input) {\r\n\t\t\t\tinput.focus();\r\n\t\t\t}\r\n\t\t\t// console.log('SearchComponent', input);\r\n\t\t}, 300);\r\n\t}\r\n\r\n\tsearch$() {\r\n\t\treturn this.form.changes$.pipe(\r\n\t\t\tauditTime(500),\r\n\t\t\tmap(changes => changes.search),\r\n\t\t\tdistinctUntilChanged(),\r\n\t\t\tswitchMap(query => {\r\n\t\t\t\tif (query != null && query.length > 1) {\r\n\t\t\t\t\tthis.busy = true;\r\n\t\t\t\t\tthis.pushChanges();\r\n\t\t\t\t\treturn SearchService.search$(query).pipe(\r\n\t\t\t\t\t\tdelay(1),\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn of([]);\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n}\r\n\r\nSearchComponent.meta = {\r\n\tselector: '[search]',\r\n};\r\n","import { Directive, getContext } from 'rxcomp';\r\n\r\nexport class SubmenuDirective extends Directive {\r\n\r\n\tonInit() {\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst items = Array.prototype.slice.call(node.querySelectorAll('[data-picture]'));\r\n\t\tconst target = node.querySelector('[data-target]');\r\n\t\tgsap.set(target, { opacity: 1 });\r\n\t\titems.forEach(item => {\r\n\t\t\titem.addEventListener('mouseover', (event) => {\r\n\t\t\t\tconst picture = item.getAttribute('data-picture');\r\n\t\t\t\tgsap.set(target, { opacity: 0 });\r\n\t\t\t\ttarget.onload = () => {\r\n\t\t\t\t\tgsap.to(target, {\r\n\t\t\t\t\t\tduration: 0.5,\r\n\t\t\t\t\t\tdelay: 0.1,\r\n\t\t\t\t\t\topacity: 1,\r\n\t\t\t\t\t\tease: Power4.easeOut,\r\n\t\t\t\t\t\toverwrite: 'all',\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\ttarget.src = picture;\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\nSubmenuDirective.meta = {\r\n\tselector: '[submenu]'\r\n};\r\n","import { Component } from 'rxcomp';\r\n\r\nexport class TreeComponent extends Component {\r\n\r\n\thasItems(item) {\r\n\t\treturn item.items && item.items.length > 0;\r\n\t}\r\n\r\n\tonClick(item) {\r\n\t\tthis.tree.forEach(x => {\r\n\t\t\tx.active = x.id === item.id ? (this.hasItems(item) ? !item.active : true) : false;\r\n\t\t});\r\n\t\tif (item.active) {\r\n\t\t\tthis.open.next(item);\r\n\t\t}\r\n\t\tthis.pushChanges();\r\n\t}\r\n\r\n\tonOpen(item) {\r\n\t\tthis.open.next(item);\r\n\t}\r\n\r\n}\r\n\r\nTreeComponent.meta = {\r\n\tselector: '[tree]',\r\n\tinputs: ['tree'],\r\n\toutputs: ['open'],\r\n\ttemplate: /* html */ `\r\n\t\t<li class=\"folder\" [class]=\"{ active: item.active }\" *for=\"let item of tree\">\r\n\t\t\t<span [innerHTML]=\"item.title\" (click)=\"onClick(item)\"></span>\r\n\t\t\t<ul [tree]=\"item.items\" (open)=\"onOpen($event)\"></ul>\r\n\t\t</li>\r\n\t`\r\n};\r\n","import { Component } from 'rxcomp';\r\nimport { FormControl, FormGroup, Validators } from 'rxcomp-form';\r\nimport { first, switchMap, takeUntil } from 'rxjs/operators';\r\nimport { GtmService } from '../../common/gtm/gtm.service';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { UserService } from './user.service';\r\n\r\nexport class UserAccessDataComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.error = null;\r\n\t\tthis.success = false;\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\temail: new FormControl(null, [Validators.RequiredValidator(), Validators.EmailValidator()]),\r\n\t\t\tpassword: new FormControl(null, Validators.RequiredValidator()),\r\n\t\t\tnewPassword: new FormControl(null, Validators.RequiredValidator()),\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: '',\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tform.changes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe((_) => {\r\n\t\t\tthis.pushChanges();\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t});\r\n\t\tUserService.me$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(user => {\r\n\t\t\tif (user) {\r\n\t\t\t\tform.patch({ email: user.email }, true);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tonSubmit() {\r\n\t\tconst form = this.form;\r\n\t\tconsole.log('UserAccessDataComponent.onSubmit', form.value);\r\n\t\tif (form.valid) {\r\n\t\t\tform.submitted = true;\r\n\t\t\tUserService.accessData$(form.value).pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t\t//switchMap(_ => UserService.signout$())\r\n\t\t\t).subscribe(response => {\r\n\t\t\t\tconsole.log('UserAccessDataComponent.onSubmit', response);\r\n\t\t\t\tthis.success = true;\r\n\t\t\t\tGtmService.push({\r\n\t\t\t\t\t'event': \"AccessData\",\r\n\t\t\t\t\t'form_name': \"AccessData\"\r\n\t\t\t\t});\r\n\t\t\t\tform.reset();\r\n\t\t\t}, error => {\r\n\t\t\t\tconsole.log('UserAccessDataComponent.error', error);\r\n\t\t\t\tthis.error = error;\r\n\t\t\t\tform.submitted = false;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t\tLocomotiveScrollService.update();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tform.touched = true;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nUserAccessDataComponent.meta = {\r\n\tselector: '[user-access-data]',\r\n};\r\n","import { Component } from 'rxcomp';\r\nimport { FormControl, FormGroup, Validators } from 'rxcomp-form';\r\nimport { first, switchMap, takeUntil } from 'rxjs/operators';\r\nimport { GtmService } from '../../common/gtm/gtm.service';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { UserService } from './user.service';\r\n\r\nexport class UserDeleteComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.error = null;\r\n\t\tthis.success = false;\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\temail: new FormControl(null, [Validators.RequiredValidator(), Validators.EmailValidator()]),\r\n\t\t\tpassword: new FormControl(null, Validators.RequiredValidator()),\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: '',\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tform.changes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe((_) => {\r\n\t\t\tthis.pushChanges();\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t});\r\n\t\tUserService.me$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(user => {\r\n\t\t\tif (user) {\r\n\t\t\t\tform.patch({ email: user.email }, true);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tonSubmit() {\r\n\t\tconst form = this.form;\r\n\t\tconsole.log('UserDeleteComponent.onSubmit', form.value);\r\n\t\tif (form.valid) {\r\n\t\t\tform.submitted = true;\r\n\t\t\tUserService.delete$(form.value).pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t\tswitchMap(_ => UserService.signout$())\r\n\t\t\t).subscribe(response => {\r\n\t\t\t\tconsole.log('UserDeleteComponent.onSubmit', response);\r\n\t\t\t\tthis.success = true;\r\n\t\t\t\tGtmService.push({\r\n\t\t\t\t\t'event': \"AccessData\",\r\n\t\t\t\t\t'form_name': \"AccessData\"\r\n\t\t\t\t});\r\n\t\t\t\tform.reset();\r\n\t\t\t}, error => {\r\n\t\t\t\tconsole.log('UserDeleteComponent.error', error);\r\n\t\t\t\tthis.error = error;\r\n\t\t\t\tform.submitted = false;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t\tLocomotiveScrollService.update();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tform.touched = true;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nUserDeleteComponent.meta = {\r\n\tselector: '[user-delete]',\r\n};\r\n","import { Component } from 'rxcomp';\r\nimport { combineLatest } from 'rxjs';\r\nimport { first, takeUntil, tap } from 'rxjs/operators';\r\nimport { ModalService } from '../../common/modal/modal.service';\r\nimport { environment } from '../../environment';\r\nimport { UserService } from './user.service';\r\n\r\nexport class UserDetailComponent extends Component {\r\n\r\n\tget countryName() {\r\n\t\tlet countryName = null;\r\n\t\tif (this.user && this.countries.length) {\r\n\t\t\tconst country = this.countries.find(x => x.value === this.user.country);\r\n\t\t\tif (country) {\r\n\t\t\t\tcountryName = country.label;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn countryName;\r\n\t}\r\n\r\n\tget occupationName() {\r\n\t\tlet occupationName = null;\r\n\t\tif (this.user && this.occupations.length) {\r\n\t\t\tconst occupation = this.occupations.find(x => x.value === this.user.occupation);\r\n\t\t\tif (occupation) {\r\n\t\t\t\toccupationName = occupation.label;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn occupationName;\r\n\t}\r\n\r\n\tget newsletterLanguageName() {\r\n\t\tlet newsletterLanguageName = null;\r\n\t\tif (this.user && this.newsletterLanguages.length) {\r\n\t\t\tconst newsletterLanguage = this.newsletterLanguages.find(x => x.value === this.user.newsletterLanguage);\r\n\t\t\tif (newsletterLanguage) {\r\n\t\t\t\tnewsletterLanguageName = newsletterLanguage.label;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn newsletterLanguageName;\r\n\t}\r\n\r\n\tonInit() {\r\n\t\tthis.countries = [];\r\n\t\tthis.occupations = [];\r\n\t\tthis.newsletterLanguages = [];\r\n\t\tthis.gdpr = [];\r\n\t\tUserService.me$().pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(user => {\r\n\t\t\tthis.user = user;\r\n\t\t\tthis.pushChanges();\r\n\t\t});\r\n\t\tthis.load$().pipe(\r\n\t\t\tfirst(),\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn combineLatest([\r\n\t\t\tUserService.data$(),\r\n\t\t\tUserService.gdpr$(),\r\n\t\t]).pipe(\r\n\t\t\ttap(datas => {\r\n\t\t\t\tconst data = datas[0];\r\n\t\t\t\tthis.countries = data.country.options;\r\n\t\t\t\tthis.occupations = data.occupation.options;\r\n\t\t\t\tthis.newsletterLanguages = data.newsletterLanguage.options;\r\n\t\t\t\tconst gdpr = datas[1];\r\n\t\t\t\tthis.gdpr = gdpr;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\tonModalUserUpdate(event) {\r\n\t\t// console.log('UserDetailComponent.onModalUserUpdate');\r\n\t\tModalService.open$({ src: environment.template.modal.userModal, data: { view: 4 } }).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(event => {\r\n\t\t\t// console.log('UserDetailComponent.onModalSignUp', event);\r\n\t\t});\r\n\t}\r\n\r\n\tonModalGdpr(legalNote) {\r\n\t\t// console.log('UserDetailComponent.onModalUserUpdate');\r\n\t\tModalService.open$({ src: environment.template.modal.genericModal, data: { title: legalNote.title, description: legalNote.description } }).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(event => {\r\n\t\t\t// console.log('UserDetailComponent.onModalGdpr', event);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nUserDetailComponent.meta = {\r\n\tselector: '[user-detail]',\r\n};\r\n","import { Component } from 'rxcomp';\r\nimport { FormControl, FormGroup, Validators } from 'rxcomp-form';\r\nimport { first, switchMap, takeUntil } from 'rxjs/operators';\r\nimport { GtmService } from '../../common/gtm/gtm.service';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { UserService } from './user.service';\r\n\r\nexport class UserEditPasswordComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.error = null;\r\n\t\tthis.success = false;\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\ttokenEncoded: this.tokenEncoded,\r\n\t\t\temail: new FormControl(null, [Validators.RequiredValidator(), Validators.EmailValidator()]),\r\n\t\t\tpassword: new FormControl(null, Validators.RequiredValidator()),\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: '',\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tform.changes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe((_) => {\r\n\t\t\tthis.pushChanges();\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t});\r\n\t}\r\n\r\n\tonSubmit() {\r\n\t\tconst form = this.form;\r\n\t\tconsole.log('UserEditPasswordComponent.onSubmit', form.value);\r\n\t\tif (form.valid) {\r\n\t\t\tform.submitted = true;\r\n\t\t\tUserService.editPassword$(form.value).pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t\tswitchMap(_ => UserService.signout$())\r\n\t\t\t).subscribe(response => {\r\n\t\t\t\tconsole.log('UserEditPasswordComponent.onSubmit', response);\r\n\t\t\t\tthis.success = true;\r\n\t\t\t\tGtmService.push({\r\n\t\t\t\t\t'event': \"EditPassword\",\r\n\t\t\t\t\t'form_name': \"EditPassword\"\r\n\t\t\t\t});\r\n\t\t\t\tform.reset();\r\n\t\t\t}, error => {\r\n\t\t\t\tconsole.log('UserEditPasswordComponent.error', error);\r\n\t\t\t\tthis.error = error;\r\n\t\t\t\tform.submitted = false;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t\tLocomotiveScrollService.update();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tform.touched = true;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nUserEditPasswordComponent.meta = {\r\n\tselector: '[user-edit-password]',\r\n\tinputs: ['tokenEncoded'],\r\n};\r\n","import { Component } from 'rxcomp';\r\nimport { FormControl, FormGroup, Validators } from 'rxcomp-form';\r\nimport { combineLatest } from 'rxjs';\r\nimport { first, takeUntil, tap } from 'rxjs/operators';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { FormService } from '../../controls/form.service';\r\nimport RequiredIfValidator from '../../controls/required-if.validator';\r\nimport { UserService } from './user.service';\r\n\r\nexport class UserEditComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.user = null;\r\n\t\tthis.error = null;\r\n\t\tthis.success = false;\r\n\t\tthis.responseMessage = null;\r\n\t\tconst hasNewsletter = RequiredIfValidator(() => Boolean(this.form.value.newsletter));\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\tfirstName: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tlastName: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tcountry: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tcity: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tcompany: new FormControl(null),\r\n\t\t\toccupation: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\temail: new FormControl(null, [Validators.RequiredValidator(), Validators.EmailValidator()]),\r\n\t\t\tprivacy: new FormControl(null, [Validators.RequiredTrueValidator()]),\r\n\t\t\tnewsletter: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tcommercial: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tpromotion: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tnewsletterLanguage: new FormControl(null, [hasNewsletter]),\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: '',\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tform.changes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe((_) => {\r\n\t\t\tthis.pushChanges();\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t});\r\n\t\tthis.load$().pipe(\r\n\t\t\tfirst(),\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn combineLatest([UserService.data$(), UserService.me$()]).pipe(\r\n\t\t\ttap(results => {\r\n\t\t\t\tconst data = results[0];\r\n\t\t\t\tconst controls = this.controls;\r\n\t\t\t\tcontrols.country.options = FormService.toSelectOptions(data.country.options);\r\n\t\t\t\tcontrols.occupation.options = FormService.toSelectOptions(data.occupation.options);\r\n\t\t\t\tcontrols.newsletterLanguage.options = FormService.toSelectOptions(data.newsletterLanguage.options);\r\n\t\t\t\tconst user = results[1];\r\n\t\t\t\tthis.user = user;\r\n\t\t\t\tif (user) {\r\n\t\t\t\t\tconst form = this.form;\r\n\t\t\t\t\tform.patch(user, true);\r\n\t\t\t\t}\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n\ttest() {\r\n\t\tconst form = this.form;\r\n\t\tconst controls = this.controls;\r\n\t\tconst country = controls.country.options.length > 1 ? controls.country.options[1].id : null;\r\n\t\tconst occupation = controls.occupation.options.length > 1 ? controls.occupation.options[1].id : null;\r\n\t\tform.patch({\r\n\t\t\tfirstName: 'Jhon',\r\n\t\t\tlastName: 'Appleseed',\r\n\t\t\tcountry: country,\r\n\t\t\tcity: 'Pesaro',\r\n\t\t\tcompany: 'Websolute',\r\n\t\t\toccupation: occupation,\r\n\t\t\temail: 'jhonappleseed@gmail.com',\r\n\t\t\tprivacy: true,\r\n\t\t});\r\n\t}\r\n\r\n\treset() {\r\n\t\tconst form = this.form;\r\n\t\tform.reset();\r\n\t}\r\n\r\n\tonSubmit() {\r\n\t\tthis.responseMessage = null;\r\n\t\tconst form = this.form;\r\n\t\tconsole.log('UserEditComponent.onSubmit', form.value);\r\n\t\tif (form.valid) {\r\n\t\t\tform.submitted = true;\r\n\t\t\tUserService.edit$(form.value).pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t).subscribe(response => {\r\n\t\t\t\tconsole.log('UserEditComponent.onSubmit', response);\r\n\t\t\t\tthis.responseMessage = response.responseMessage;\r\n\t\t\t\tthis.success = true;\r\n\t\t\t\t/*\r\n\t\t\t\tGtmService.push({\r\n\t\t\t\t\t'event': \"Registration\",\r\n\t\t\t\t\t'form_name': \"Registrazione\"\r\n\t\t\t\t});\r\n\t\t\t\t*/\r\n\t\t\t\tform.reset();\r\n\t\t\t}, error => {\r\n\t\t\t\tconsole.log('UserEditComponent.error', error);\r\n\t\t\t\tthis.error = error;\r\n\t\t\t\tform.submitted = false;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t\tLocomotiveScrollService.update();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tform.touched = true;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nUserEditComponent.meta = {\r\n\tselector: '[user-edit]',\r\n};\r\n","import { Component } from 'rxcomp';\r\nimport { FormControl, FormGroup, Validators } from 'rxcomp-form';\r\nimport { first, takeUntil } from 'rxjs/operators';\r\nimport { GtmService } from '../../common/gtm/gtm.service';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { UserService } from './user.service';\r\n\r\nexport class UserForgotComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.error = null;\r\n\t\tthis.success = false;\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\temail: new FormControl(null, [Validators.RequiredValidator(), Validators.EmailValidator()]),\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: '',\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tform.changes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe((_) => {\r\n\t\t\tthis.pushChanges();\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t});\r\n\t}\r\n\r\n\ttest() {\r\n\t\tconst form = this.form;\r\n\t\tform.patch({\r\n\t\t\temail: 'jhonappleseed@gmail.com',\r\n\t\t});\r\n\t}\r\n\r\n\treset() {\r\n\t\tconst form = this.form;\r\n\t\tform.reset();\r\n\t}\r\n\r\n\tonSubmit() {\r\n\t\tconst form = this.form;\r\n\t\tconsole.log('UserForgotComponent.onSubmit', form.value);\r\n\t\tif (form.valid) {\r\n\t\t\tform.submitted = true;\r\n\t\t\tUserService.forgot$(form.value).pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t).subscribe(response => {\r\n\t\t\t\tconsole.log('UserForgotComponent.onSubmit', response);\r\n\t\t\t\tthis.success = true;\r\n\t\t\t\tGtmService.push({\r\n\t\t\t\t\t'event': \"Forgot\",\r\n\t\t\t\t\t'form_name': \"Recupero Password\"\r\n\t\t\t\t});\r\n\t\t\t\tform.reset();\r\n\t\t\t\tthis.forgot.next(true);\r\n\t\t\t}, error => {\r\n\t\t\t\tconsole.log('UserForgotComponent.error', error);\r\n\t\t\t\tthis.error = error;\r\n\t\t\t\tform.submitted = false;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t\tLocomotiveScrollService.update();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tform.touched = true;\r\n\t\t}\r\n\t}\r\n\r\n\tonSignIn() {\r\n\t\tthis.viewSignIn.next();\r\n\t}\r\n\r\n\tonSignUp() {\r\n\t\tthis.viewSignUp.next();\r\n\t}\r\n}\r\n\r\nUserForgotComponent.meta = {\r\n\tselector: '[user-forgot]',\r\n\toutputs: ['forgot', 'viewSignIn', 'viewSignUp'],\r\n};\r\n","import { Component, getContext } from 'rxcomp';\r\nimport { takeUntil } from 'rxjs/operators';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { ModalService } from '../../common/modal/modal.service';\r\nimport { environment } from '../../environment';\r\nimport { UserService, UserViews } from './user.service';\r\n\r\nexport class UserComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.views = UserViews;\r\n\t\tthis.view = this.view || UserViews.SIGN_UP;\r\n\t}\r\n\r\n\tonModalSignIn(event) {\r\n\t\t// console.log('UserComponent.onModalSignIn');\r\n\t\tModalService.open$({ src: environment.template.modal.userModal, data: { view: 1 } }).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(event => {\r\n\t\t\tconsole.log('UserComponent.onModalSignIn', event);\r\n\t\t});\r\n\t}\r\n\r\n\tonModalSignUp(event) {\r\n\t\t// console.log('UserComponent.onModalSignUp');\r\n\t\tModalService.open$({ src: environment.template.modal.userModal, data: { view: 2, skipAutoClose: true } }).pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe(event => {\r\n\t\t\tconsole.log('UserComponent.onModalSignUp', event);\r\n\t\t});\r\n\t}\r\n\r\n\tsetView(view) {\r\n\t\tthis.view = view;\r\n\t\tthis.pushChanges();\r\n\t\tconst { node } = getContext(this);\r\n\t\tLocomotiveScrollService.scrollTo(node, { offset: -100 });\r\n\t}\r\n\r\n\tonViewSignIn(event) {\r\n\t\t// console.log('UserComponent.onViewSignIn');\r\n\t\tthis.setView(UserViews.SIGN_IN);\r\n\t}\r\n\r\n\tonViewSignUp(event) {\r\n\t\t// console.log('UserComponent.onViewSignIn');\r\n\t\tthis.setView(UserViews.SIGN_UP);\r\n\t}\r\n\r\n\tonViewForgot(event) {\r\n\t\t// console.log('UserComponent.onViewForgot');\r\n\t\tthis.setView(UserViews.FORGOTTEN);\r\n\t}\r\n\r\n\tonSignIn(user) {\r\n\t\tconsole.log('UserComponent.onSignIn', user);\r\n\t\tUserService.setUser(user);\r\n\t\tif (this.navTo) {\r\n\t\t\twindow.location.href = this.navTo;\r\n\t\t}\r\n\t\t// nav to profile\r\n\t}\r\n\r\n\tonSignUp(user) {\r\n\t\tconsole.log('UserComponent.onSignUp', user);\r\n\t\tUserService.setUser(user);\r\n\t\tif (this.navTo) {\r\n\t\t\twindow.location.href = this.navTo;\r\n\t\t}\r\n\t\t// nav to profile\r\n\t}\r\n\r\n\tonForgot(email) {\r\n\t\t/*\r\n\t\tconsole.log('UserComponent.onForgot', email);\r\n\t\tthis.setView(UserViews.SIGN_IN);\r\n\t\t*/\r\n\t}\r\n}\r\n\r\nUserComponent.meta = {\r\n\tselector: '[user]',\r\n\tinputs: ['navTo', 'view']\r\n};\r\n","import { getContext } from 'rxcomp';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { ModalOutletComponent } from '../../common/modal/modal-outlet.component';\r\nimport { ModalService } from '../../common/modal/modal.service';\r\nimport { UserComponent } from './user.component';\r\nimport { UserViews } from './user.service';\r\n\r\nexport class UserModalComponent extends UserComponent {\r\n\r\n\tonInit() {\r\n\t\tsuper.onInit();\r\n\t\tconst { parentInstance } = getContext(this);\r\n\t\tif (parentInstance instanceof ModalOutletComponent) {\r\n\t\t\tconst data = parentInstance.modal.data;\r\n\t\t\tthis.view = data.view;\r\n\t\t\tthis.me = data.me;\r\n\t\t\tthis.skipAutoClose = data.skipAutoClose;\r\n\t\t\t// console.log('UserModalComponent.onInit', data);\r\n\t\t}\r\n\t\tLocomotiveScrollService.stop();\r\n\t}\r\n\r\n\tsetView(view) {\r\n\t\tthis.view = view;\r\n\t\tthis.pushChanges();\r\n\t\tconst { node } = getContext(this);\r\n\t\tconst target = window.innerWidth >= 1024 ? node.querySelector('.modal__inner') : node;\r\n\t\ttarget.scrollTo(0, 0);\r\n\t}\r\n\r\n\tonViewForgot() {\r\n\t\tconsole.log('UserModalComponent.onViewForgot');\r\n\t\tthis.setView(UserViews.FORGOTTEN);\r\n\t}\r\n\r\n\tonViewSignIn() {\r\n\t\tconsole.log('UserModalComponent.onViewSignIn');\r\n\t\tthis.setView(UserViews.SIGN_IN);\r\n\t}\r\n\r\n\tonViewSignUp() {\r\n\t\tconsole.log('UserModalComponent.onViewSignUp');\r\n\t\tthis.setView(UserViews.SIGN_UP);\r\n\t}\r\n\r\n\tonClose() {\r\n\t\tModalService.reject();\r\n\t}\r\n\r\n\tonSignUp(user) {\r\n\t\t// console.log('UserModalComponent.onSignUp', user);\r\n\t\tif (!this.skipAutoClose) {\r\n\t\t\tModalService.resolve(user);\r\n\t\t}\r\n\t}\r\n\r\n\tonSignIn(user) {\r\n\t\t// console.log('UserModalComponent.onSignIn', user);\r\n\t\tModalService.resolve(user);\r\n\t}\r\n\r\n\tonDestroy() {\r\n\t\tLocomotiveScrollService.start();\r\n\t}\r\n}\r\n\r\nUserModalComponent.meta = {\r\n\tselector: '[user-modal]'\r\n};\r\n","import { Component } from 'rxcomp';\r\nimport { FormControl, FormGroup, Validators } from 'rxcomp-form';\r\nimport { first, takeUntil } from 'rxjs/operators';\r\nimport { GtmService } from '../../common/gtm/gtm.service';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { UserService } from './user.service';\r\n\r\nexport class UserSigninComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.error = null;\r\n\t\tthis.success = false;\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\temail: new FormControl(null, [Validators.RequiredValidator(), Validators.EmailValidator()]),\r\n\t\t\tpassword: new FormControl(null, Validators.RequiredValidator()),\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: '',\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tform.changes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe((_) => {\r\n\t\t\tthis.pushChanges();\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t});\r\n\t}\r\n\r\n\ttest() {\r\n\t\tconst form = this.form;\r\n\t\tform.patch({\r\n\t\t\temail: 'jhonappleseed@gmail.com',\r\n\t\t\tpassword: '********',\r\n\t\t});\r\n\t}\r\n\r\n\treset() {\r\n\t\tconst form = this.form;\r\n\t\tform.reset();\r\n\t}\r\n\r\n\tonSubmit() {\r\n\t\tconst form = this.form;\r\n\t\tconsole.log('UserSigninComponent.onSubmit', form.value);\r\n\t\tif (form.valid) {\r\n\t\t\tform.submitted = true;\r\n\t\t\tUserService.signin$(form.value).pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t).subscribe(response => {\r\n\t\t\t\tconsole.log('UserSigninComponent.onSubmit', response);\r\n\t\t\t\tthis.success = true;\r\n\t\t\t\tGtmService.push({\r\n\t\t\t\t\t'event': \"Signin\",\r\n\t\t\t\t\t'form_name': \"Login\"\r\n\t\t\t\t});\r\n\t\t\t\tform.reset();\r\n\t\t\t\tthis.signIn.next(response);\r\n\t\t\t}, error => {\r\n\t\t\t\tconsole.log('UserSigninComponent.error', error);\r\n\t\t\t\tthis.error = error;\r\n\t\t\t\tform.submitted = false;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t\tLocomotiveScrollService.update();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tform.touched = true;\r\n\t\t}\r\n\t}\r\n\r\n\tonForgot(event) {\r\n\t\tthis.viewForgot.next();\r\n\t}\r\n\r\n\tonSignUp(event) {\r\n\t\tthis.viewSignUp.next();\r\n\t}\r\n}\r\n\r\nUserSigninComponent.meta = {\r\n\tselector: '[user-signin]',\r\n\toutputs: ['signIn', 'viewForgot', 'viewSignUp'],\r\n};\r\n","import { FormValidator } from 'rxcomp-form';\r\n\r\nexport default function MatchValidator(fieldName, formGroup) {\r\n\r\n\treturn new FormValidator((value) => {\r\n\t\tconst field = formGroup ? formGroup.get(fieldName) : null;\r\n\t\tif (!value || !field) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn value !== field.value ? { match: { value: value, match: field.value } } : null;\r\n\t});\r\n\r\n}\r\n","import { Component } from 'rxcomp';\r\nimport { FormControl, FormGroup, Validators } from 'rxcomp-form';\r\nimport { first, takeUntil, tap } from 'rxjs/operators';\r\nimport { GtmService } from '../../common/gtm/gtm.service';\r\nimport { LocomotiveScrollService } from '../../common/locomotive-scroll/locomotive-scroll.service';\r\nimport { FormService } from '../../controls/form.service';\r\nimport MatchValidator from '../../controls/match.validator';\r\nimport RequiredIfValidator from '../../controls/required-if.validator';\r\nimport { UserService } from './user.service';\r\n\r\nexport class UserSignupComponent extends Component {\r\n\r\n\tonInit() {\r\n\t\tthis.me = this.me || {};\r\n\t\tthis.user = this.user || null;\r\n\t\tthis.error = null;\r\n\t\tthis.success = false;\r\n\t\tthis.responseMessage = null;\r\n\t\tconst hasNewsletter = RequiredIfValidator(() => Boolean(this.form.value.newsletter));\r\n\t\tconst form = this.form = new FormGroup({\r\n\t\t\tfirstName: new FormControl(this.me.firstName || null, [Validators.RequiredValidator()]),\r\n\t\t\tlastName: new FormControl(this.me.lastName || null, [Validators.RequiredValidator()]),\r\n\t\t\tcountry: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tcity: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tcompany: new FormControl(null),\r\n\t\t\toccupation: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\temail: new FormControl(this.me.email || null, [Validators.RequiredValidator(), Validators.EmailValidator()]),\r\n\t\t\tpassword: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tpasswordConfirm: new FormControl(null, [Validators.RequiredValidator(), MatchValidator('password', form)]),\r\n\t\t\tprivacy: new FormControl(null, [Validators.RequiredTrueValidator()]),\r\n\t\t\tnewsletter: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tcommercial: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tpromotion: new FormControl(null, [Validators.RequiredValidator()]),\r\n\t\t\tnewsletterLanguage: new FormControl(null, [hasNewsletter]),\r\n\t\t\tcheckRequest: window.antiforgery,\r\n\t\t\tcheckField: '',\r\n\t\t});\r\n\t\tconst controls = this.controls = form.controls;\r\n\t\tform.changes$.pipe(\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe((_) => {\r\n\t\t\tthis.pushChanges();\r\n\t\t\tLocomotiveScrollService.update();\r\n\t\t});\r\n\t\tthis.load$().pipe(\r\n\t\t\tfirst(),\r\n\t\t\ttakeUntil(this.unsubscribe$)\r\n\t\t).subscribe();\r\n\t}\r\n\r\n\tload$() {\r\n\t\treturn UserService.data$().pipe(\r\n\t\t\ttap(data => {\r\n\t\t\t\tconst controls = this.controls;\r\n\t\t\t\tcontrols.country.options = FormService.toSelectOptions(data.country.options);\r\n\t\t\t\tcontrols.occupation.options = FormService.toSelectOptions(data.occupation.options);\r\n\t\t\t\tcontrols.newsletterLanguage.options = FormService.toSelectOptions(data.newsletterLanguage.options);\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\r\n\ttest() {\r\n\t\tconst form = this.form;\r\n\t\tconst controls = this.controls;\r\n\t\tconst country = controls.country.options.length > 1 ? controls.country.options[1].id : null;\r\n\t\tconst occupation = controls.occupation.options.length > 1 ? controls.occupation.options[1].id : null;\r\n\t\tform.patch({\r\n\t\t\tfirstName: 'Jhon',\r\n\t\t\tlastName: 'Appleseed',\r\n\t\t\tcountry: country,\r\n\t\t\tcity: 'Pesaro',\r\n\t\t\tcompany: 'Websolute',\r\n\t\t\toccupation: occupation,\r\n\t\t\temail: 'jhonappleseed@gmail.com',\r\n\t\t\tpassword: '********',\r\n\t\t\tpasswordConfirm: '********',\r\n\t\t\tprivacy: true,\r\n\t\t\tnewsletter: false,\r\n\t\t\tcommercial: false,\r\n\t\t\tpromotion: false,\r\n\t\t});\r\n\t}\r\n\r\n\treset() {\r\n\t\tconst form = this.form;\r\n\t\tform.reset();\r\n\t}\r\n\r\n\tonSubmit() {\r\n\t\tthis.responseMessage = null;\r\n\t\tconst form = this.form;\r\n\t\tconsole.log('UserSignupComponent.onSubmit', form.value);\r\n\t\tif (form.valid) {\r\n\t\t\tform.submitted = true;\r\n\t\t\tUserService.signup$(form.value).pipe(\r\n\t\t\t\tfirst(),\r\n\t\t\t).subscribe(response => {\r\n\t\t\t\tconsole.log('UserSignupComponent.onSubmit', response);\r\n\t\t\t\tthis.responseMessage = response.responseMessage;\r\n\t\t\t\tthis.success = true;\r\n\t\t\t\tGtmService.push({\r\n\t\t\t\t\t'event': \"Registration\",\r\n\t\t\t\t\t'form_name': \"Registrazione\"\r\n\t\t\t\t});\r\n\t\t\t\tform.reset();\r\n\t\t\t\tthis.signUp.next(response.user);\r\n\t\t\t}, error => {\r\n\t\t\t\tconsole.log('UserSignupComponent.error', error);\r\n\t\t\t\tthis.error = error;\r\n\t\t\t\tform.submitted = false;\r\n\t\t\t\tthis.pushChanges();\r\n\t\t\t\tLocomotiveScrollService.update();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tform.touched = true;\r\n\t\t}\r\n\t}\r\n\r\n\tonSignIn() {\r\n\t\tthis.viewSignIn.next();\r\n\t}\r\n}\r\n\r\nUserSignupComponent.meta = {\r\n\tselector: '[user-signup]',\r\n\toutputs: ['signUp', 'viewSignIn'],\r\n\tinputs: ['me', 'user'],\r\n};\r\n","import { Module } from 'rxcomp';\r\nimport { MapComponent } from '../partials/map/map.component';\r\nimport { SwiperGalleryDirective } from '../partials/swiper-gallery/swiper-gallery.directive';\r\nimport { SwiperHomepageDirective } from '../partials/swiper-homepage/swiper-homepage.directive';\r\nimport { SwiperNewsPropositionDirective } from '../partials/swiper-news-proposition/swiper-news-proposition.directive';\r\nimport { SwiperProductsPropositionDirective } from '../partials/swiper-products-proposition/swiper-products-proposition.directive';\r\nimport { SwiperProjectsPropositionDirective } from '../partials/swiper-projects-proposition/swiper-projects-proposition.directive';\r\nimport { CartMiniComponent } from './cart-mini/cart-mini.component';\r\nimport { ErrorComponent } from './error/error.component';\r\nimport { FilesComponent } from './files/files.component';\r\nimport { HeaderComponent } from './header/header.component';\r\nimport { MenuDirective } from './menu/menu.directive';\r\nimport { NewsletterPropositionComponent } from './newsletter-proposition/newsletter-proposition.component';\r\nimport { SearchComponent } from './search/search.component';\r\nimport { SubmenuDirective } from './submenu/submenu.directive';\r\nimport { TreeComponent } from './tree/tree.component';\r\nimport { UserAccessDataComponent } from './user/user-access-data.component';\r\nimport { UserDeleteComponent } from './user/user-delete.component';\r\nimport { UserDetailComponent } from './user/user-detail.component';\r\nimport { UserEditPasswordComponent } from './user/user-edit-password.component';\r\nimport { UserEditComponent } from './user/user-edit.component';\r\nimport { UserForgotComponent } from './user/user-forgot.component';\r\nimport { UserModalComponent } from './user/user-modal.component';\r\nimport { UserSigninComponent } from './user/user-signin.component';\r\nimport { UserSignupComponent } from './user/user-signup.component';\r\nimport { UserComponent } from './user/user.component';\r\n\r\nconst factories = [\r\n\tCartMiniComponent,\r\n\tErrorComponent,\r\n\tFilesComponent,\r\n\tHeaderComponent,\r\n\tMapComponent,\r\n\tMenuDirective,\r\n\tNewsletterPropositionComponent,\r\n\tSearchComponent,\r\n\tSubmenuDirective,\r\n\tSwiperGalleryDirective,\r\n\tSwiperHomepageDirective,\r\n\tSwiperNewsPropositionDirective,\r\n\tSwiperProductsPropositionDirective,\r\n\tSwiperProjectsPropositionDirective,\r\n\tTreeComponent,\r\n\tUserAccessDataComponent,\r\n\tUserComponent,\r\n\tUserDeleteComponent,\r\n\tUserEditComponent,\r\n\tUserEditPasswordComponent,\r\n\tUserForgotComponent,\r\n\tUserModalComponent,\r\n\tUserDetailComponent,\r\n\tUserSigninComponent,\r\n\tUserSignupComponent,\r\n];\r\n\r\nconst pipes = [\r\n];\r\n\r\nexport class SharedModule extends Module { }\r\n\r\nSharedModule.meta = {\r\n\timports: [\r\n\t],\r\n\tdeclarations: [\r\n\t\t...factories,\r\n\t\t...pipes,\r\n\t],\r\n\texports: [\r\n\t\t...factories,\r\n\t\t...pipes,\r\n\t],\r\n};\r\n","import { CoreModule, Module } from 'rxcomp';\r\nimport { FormModule } from 'rxcomp-form';\r\nimport { AppComponent } from './app.component';\r\nimport { CommonModule } from './common/common.module';\r\nimport { ControlsModule } from './controls/controls.module';\r\nimport { AmbienceComponent } from './pages/ambience/ambience.component';\r\nimport { AteliersAndStoresComponent } from './pages/ateliers-and-stores/ateliers-and-stores.component';\r\nimport { CareersModalComponent } from './pages/careers/careers-modal.component';\r\nimport { CareersComponent } from './pages/careers/careers.component';\r\nimport { CartComponent } from './pages/cart/cart.component';\r\nimport { CataloguesComponent } from './pages/catalogues/catalogues.component';\r\nimport { ContactsComponent } from './pages/contacts/contacts.component';\r\nimport { DealersComponent } from './pages/dealers/dealers.component';\r\nimport { DesignersComponent } from './pages/designers/designers.component';\r\nimport { GenericModalComponent } from './pages/generic/generic-modal.component';\r\nimport { MagazineRequestModalComponent } from './pages/magazine-request/magazine-request-modal.component';\r\nimport { MagazineRequestPropositionComponent } from './pages/magazine-request/magazine-request-proposition.component';\r\nimport { MagazineRequestComponent } from './pages/magazine-request/magazine-request.component';\r\nimport { MagazineComponent } from './pages/magazine/magazine.component';\r\nimport { MarketPropositionModalComponent } from './pages/market-proposition/market-proposition-modal.component';\r\nimport { MarketsAndLanguagesModalComponent } from './pages/markets-and-languages/markets-and-languages-modal.component';\r\nimport { MaterialsModalComponent } from './pages/materials/materials-modal.component';\r\nimport { MaterialsComponent } from './pages/materials/materials.component';\r\nimport { NewsComponent } from './pages/news/news.component';\r\nimport { NewsletterComponent } from './pages/newsletter/newsletter.component';\r\nimport { OrdersDetailComponent } from './pages/orders/orders-detail.component';\r\nimport { OrdersModalComponent } from './pages/orders/orders-modal.component';\r\nimport { OrdersComponent } from './pages/orders/orders.component';\r\nimport { PressComponent } from './pages/press/press.component';\r\nimport { ProductsConfigureComponent } from './pages/products-configure/products-configure.component';\r\nimport { ProductsDetailRequestModalComponent } from './pages/products-detail/products-detail-request-modal.component';\r\nimport { ProductsDetailRequestComponent } from './pages/products-detail/products-detail-request.component';\r\nimport { ProductsDetailComponent } from './pages/products-detail/products-detail.component';\r\nimport { ProductsComponent } from './pages/products/products.component';\r\nimport { ProjectsRegistrationModalComponent } from './pages/projects-registration/projects-registration-modal.component';\r\nimport { ProjectsRegistrationComponent } from './pages/projects-registration/projects-registration.component';\r\nimport { ProjectsComponent } from './pages/projects/projects.component';\r\nimport { ReservedAreaComponent } from './pages/reserved-area/reserved-area.component';\r\nimport { StoreLocatorComponent } from './pages/store-locator/store-locator.component';\r\nimport { SharedModule } from './shared/shared.module';\r\n\r\nexport class AppModule extends Module { }\r\n\r\nAppModule.meta = {\r\n\timports: [\r\n\t\tCoreModule,\r\n\t\tFormModule,\r\n\t\tCommonModule,\r\n\t\tControlsModule,\r\n\t\tSharedModule,\r\n\t],\r\n\tdeclarations: [\r\n\t\tAmbienceComponent,\r\n\t\tAteliersAndStoresComponent,\r\n\t\tCareersComponent,\r\n\t\tCareersModalComponent,\r\n\t\tCartComponent,\r\n\t\tCataloguesComponent,\r\n\t\tContactsComponent,\r\n\t\tDealersComponent,\r\n\t\tDesignersComponent,\r\n\t\tGenericModalComponent,\r\n\t\tMagazineComponent,\r\n\t\tMagazineRequestComponent,\r\n\t\tMagazineRequestModalComponent,\r\n\t\tMagazineRequestPropositionComponent,\r\n\t\tMarketPropositionModalComponent,\r\n\t\tMarketsAndLanguagesModalComponent,\r\n\t\tMaterialsComponent,\r\n\t\tMaterialsModalComponent,\r\n\t\tNewsComponent,\r\n\t\tNewsletterComponent,\r\n\t\tOrdersComponent,\r\n\t\tOrdersDetailComponent,\r\n\t\tOrdersModalComponent,\r\n\t\tPressComponent,\r\n\t\tProductsComponent,\r\n\t\tProductsConfigureComponent,\r\n\t\tProductsDetailComponent,\r\n\t\tProductsDetailRequestComponent,\r\n\t\tProductsDetailRequestModalComponent,\r\n\t\tProjectsComponent,\r\n\t\tProjectsRegistrationComponent,\r\n\t\tProjectsRegistrationModalComponent,\r\n\t\tReservedAreaComponent,\r\n\t\tStoreLocatorComponent,\r\n\t],\r\n\tbootstrap: AppComponent,\r\n};\r\n","import { Browser } from 'rxcomp';\r\nimport { AppModule } from './app.module';\r\n\r\nBrowser.bootstrap(AppModule);\r\n"]}