/**
 * @license giorgetti v1.0.0
 * (c) 2021 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("rxcomp"),require("rxcomp-form"),require("rxjs/operators"),require("rxjs")):"function"==typeof define&&define.amd?define(["rxcomp","rxcomp-form","rxjs/operators","rxjs"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).rxcomp,t.rxcomp.form,t.rxjs.operators,t.rxjs)}(this,(function(t,e,n,i){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,l(t,e)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var c=function(e){function n(){return e.apply(this,arguments)||this}return a(n,e),n.prototype.onInit=function(){t.getContext(this).node.classList.remove("hidden"),console.log("AppComponent.onInit")},n}(t.Component);c.meta={selector:"[app-component]"};var h=1e6,p=function(e){function i(){return e.apply(this,arguments)||this}a(i,e);var r=i.prototype;return r.onInit=function(){var e=this,r=t.getContext(this).node,o=r.getAttribute("dropdown-trigger");this.trigger=o?r.querySelector(o):r,this.opened=null,this.onClick=this.onClick.bind(this),this.onDocumentClick=this.onDocumentClick.bind(this),this.openDropdown=this.openDropdown.bind(this),this.closeDropdown=this.closeDropdown.bind(this),this.addListeners(),i.dropdown$.pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(t){e.id===t?r.classList.add("dropped"):r.classList.remove("dropped")}))},r.onClick=function(e){var n=t.getContext(this).node;null===this.opened?this.openDropdown():n.querySelector("[dropdown-item]")||this.closeDropdown()},r.onDocumentClick=function(e){var n=t.getContext(this).node;n===e.target||n.contains(e.target)||this.closeDropdown()},r.openDropdown=function(){null===this.opened&&(this.opened=!0,this.addDocumentListeners(),i.dropdown$.next(this.id),this.dropped.next(this.id))},r.closeDropdown=function(){null!==this.opened&&(this.removeDocumentListeners(),this.opened=null,i.dropdown$.getValue()===this.id&&(i.dropdown$.next(null),this.dropped.next(null)))},r.addListeners=function(){this.trigger.addEventListener("click",this.onClick)},r.addDocumentListeners=function(){document.addEventListener("click",this.onDocumentClick)},r.removeListeners=function(){this.trigger.removeEventListener("click",this.onClick)},r.removeDocumentListeners=function(){document.removeEventListener("click",this.onDocumentClick)},r.onDestroy=function(){this.removeListeners(),this.removeDocumentListeners()},i.nextId=function(){return h++},o(i,[{key:"id",get:function(){return this.dropdown||this.id_||(this.id_=i.nextId())}}]),i}(t.Directive);p.meta={selector:"[dropdown]",inputs:["dropdown","dropdown-trigger"],outputs:["dropped"]},p.dropdown$=new i.BehaviorSubject(null);var d=function(e){function i(){return e.apply(this,arguments)||this}return a(i,e),i.prototype.onInit=function(){var e=this,i=t.getContext(this).node;i.classList.add("dropdown-item"),p.dropdown$.pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(t){e.id===t?i.classList.add("dropped"):i.classList.remove("dropped")}))},o(i,[{key:"id",get:function(){return this["dropdown-item"]}}]),i}(t.Directive);d.meta={selector:"[dropdown-item], [[dropdown-item]]",inputs:["dropdown-item"]};var f=function(){function t(){}return t.merge=function(t,e){var n=this;return"object"==typeof e&&Object.keys(e).forEach((function(i){var r=e[i];"object"!=typeof r||Array.isArray(r)?t[i]=r:t[i]=n.merge(t[i],r)})),t},t}(),g="undefined"!=typeof module&&module.exports,m=((g?{get:function(){}}:new URLSearchParams(window.location.search)).get("debug"),g?null:document.querySelector("base").getAttribute("href")),v=!g&&(window&&-1!==window.location.host.indexOf("herokuapp")),y=!g&&(v||window&&("48481"===window.location.port||"5000"===window.location.port||"6443"===window.location.port||"actarian.github.io"===window.location.host)),b=!g&&(window&&-1!==["localhost","127.0.0.1","0.0.0.0"].indexOf(window.location.host.split(":")[0])),w={STATIC:y,DEVELOPMENT:b,PRODUCTION:!b},k=function(){var t=e.prototype;function e(t){t&&Object.assign(this,t)}return t.getAbsoluteUrl=function(t,e){var n=""+window.location.origin+t;return Object.keys(e).forEach((function(t){n=n.replace("$"+t,e[t])})),n},t.getPath=function(t){return this.isLocal(t)?this.href+t:t},t.isLocal=function(t){return-1===t.indexOf("://")},o(e,[{key:"STATIC",get:function(){return w.STATIC},set:function(t){w.STATIC=!0===t||"true"===t,console.log("Environment.STATIC.set",w.STATIC)}},{key:"href",get:function(){return v?this.githubDocs:m}}]),e}(),$={port:5e3,flags:{production:!1,heroku:v},slug:{},languages:["it","en"],defaultLanguage:"it",labels:{select:"Seleziona",browse:"Sfoglia",cancel:"Annulla",error_email:"Email non valida",error_match:"I campi non corrispondono",error_required:"Campo obbligatorio",loading:"caricamento",remove:"Rimuovi",required:"Richiesto",select_file:"Seleziona una file...",update:"Aggiorna",upload:"Carica",drag_and_drop_images:"Drag And Drop your images here"}},C=window.STATIC?{flags:{production:!1},api:"/api",workers:{image:"./js/workers/image.service.worker.js",prefetch:"./js/workers/prefetch.service.worker.js"},githubDocs:"https://raw.githubusercontent.com/actarian/giorgetti/main/docs/",template:{modal:{myModal:"/my-modal.html"}}}:{flags:{production:!0},api:"/api",workers:{image:"/Client/docs/js/workers/image.service.worker.js",prefetch:"/Client/docs/js/workers/prefetch.service.worker.js"},template:{modal:{myModal:"/template/modules/giorgetti/my-modal.cshtml"}}},L=Object.assign($,C),x=new k(L=f.merge(L,window.environment));console.log("environment",x);var O=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.transform=function(t){for(var e=x,n=t.split("."),i=n.shift();n.length>0&&e[i];)e=e[i],i=n.shift();return e[i]||null},e}(t.Pipe);O.meta={name:"env"};var j=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.transform=function(t){return x.flags[t]||!1},e}(t.Pipe);j.meta={name:"flag"};var S=function(){function t(){}return t.keydown$=function(){return this.keydown$_||(this.keydown$_=i.fromEvent(window,"keydown").pipe(n.shareReplay(1))),this.keydown$_},t.keyup$=function(){return this.keyup$_||(this.keyup$_=i.fromEvent(window,"keyup").pipe(n.shareReplay(1))),this.keyup$_},t.keys$=function(){var t=this;return this.keys$_||(this.keys$_=i.merge(this.keydown$(),this.keyup$()).pipe(n.map((function(e){var n=t.keys;return"keydown"===e.type?n[e.key]=!0:delete n[e.key],t.keys})),n.startWith(this.keys),n.shareReplay(1))),this.keys$_},t.key$=function(){if(!this.key$_){var t=/\w/;this.key$_=this.keydown$().pipe(n.filter((function(e){return e.key&&e.key.match(t)})),n.map((function(t){return t.key})),n.shareReplay(1))}return this.key$_},t.typing$=function(){if(!this.typing$_){var t,e="";this.typing$_=this.key$().pipe(n.map((function(n){return t&&clearTimeout(t),e+=n,t=setTimeout((function(){e=""}),1500),e})),n.shareReplay(1))}return this.typing$_},t}();s(S,"keys",{});var E=function(e){function n(){return e.apply(this,arguments)||this}return a(n,e),n.prototype.onChanges=function(){var e=t.getContext(this).node,n=this.control.flags;Object.keys(n).forEach((function(t){n[t]?e.classList.add(t):e.classList.remove(t)}))},n}(t.Component);E.meta={selector:"[control]",inputs:["control"]};var A=function(e){function i(){return e.apply(this,arguments)||this}a(i,e);var r=i.prototype;return r.onInit=function(){var t=this;this.label=this.label||"label",this.dropped=!1,this.dropdownId=p.nextId(),S.typing$().pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(e){t.scrollToWord(e)}))},r.scrollToWord=function(e){for(var n=this.control.options||[],i=-1,r=0;r<n.length;r++){if(0===n[r].name.toLowerCase().indexOf(e.toLowerCase())){i=r;break}}if(-1!==i){var o=t.getContext(this).node,s=o.querySelector(".dropdown"),a=o.querySelector(".nav--dropdown").children[i];s.scrollTo(0,a.offsetTop)}},r.setOption=function(t){var e;if(this.isMultiple){var n=this.control.value||[],i=n.indexOf(t.id);-1!==i?n.splice(i,1):n.push(t.id),n.length&&n.slice(),function(t){throw new TypeError('"'+t+'" is read-only')}("value")}else e=t.id;this.control.value=e,this.change.next(e)},r.hasOption=function(t){return this.isMultiple?-1!==(this.control.value||[]).indexOf(t.id):this.control.value===t.id},r.getLabel=function(){var t=this.control.value,e=this.control.options||[];if(this.isMultiple)return(t=t||[]).length?t.map((function(t){var n=e.find((function(e){return e.id===t||e.name===t}));return n?n.name:""})).join(", "):"select";var n=e.find((function(e){return e.id===t||e.name===t}));return n?n.name:"select"},r.onDropped=function(t){this.dropped&&null===t&&(this.control.touched=!0),this.dropped=t===this.dropdownId},o(i,[{key:"isMultiple",get:function(){return this.multiple&&!1!==this.multiple&&"false"!==this.multiple}}]),i}(E);A.meta={selector:"[control-custom-select]",outputs:["change"],inputs:["control","label","multiple"],template:'\n\t\t<div class="group--form--select" [class]="{ required: control.validators.length, multiple: isMultiple }" [dropdown]="dropdownId" (dropped)="onDropped($event)">\n\t\t\t<label [innerHTML]="label"></label>\n\t\t\t<span class="control--custom-select" [innerHTML]="getLabel() | label"></span>\n\t\t\t<svg class="caret-down"><use xlink:href="#caret-down"></use></svg>\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t\t<div class="dropdown" [dropdown-item]="dropdownId">\n\t\t\t<div class="category" [innerHTML]="label"></div>\n\t\t\t<ul class="nav--dropdown" [class]="{ multiple: isMultiple }">\n\t\t\t\t<li (click)="setOption(item)" [class]="{ empty: item.id == null }" *for="let item of control.options">\n\t\t\t\t\t<span [class]="{ active: hasOption(item) }" [innerHTML]="item.name | label"></span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t'};var _=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.prototype.onInit=function(){this.label=this.label||"label"},e}(E);_.meta={selector:"[control-email]",inputs:["control","label"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length }">\n\t\t\t<label [innerHTML]="label"></label>\n\t\t\t<input type="text" class="control--text" [formControl]="control" [placeholder]="label" required email />\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};var F=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.prototype.onInit=function(){this.label=this.label||"label",this.disabled=this.disabled||!1},e}(E);F.meta={selector:"[control-search]",inputs:["control","label","disabled"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length, disabled: disabled }">\n\t\t\t<svg class="search"><use xlink:href="#search"></use></svg>\n\t\t\t<input type="text" class="control--text" [formControl]="control" [placeholder]="label" [disabled]="disabled" />\n\t\t</div>\n\t'};var T=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.transform=function(t){if(t){t=t.replace(/&#(\d+);/g,(function(t,e){return String.fromCharCode(parseInt(e))}));var e=['"',"&","'","<",">"," ","¡","¢","£","¤","¥","¦","§","¨","©","ª","«","¬","­","®","¯","°","±","²","³","´","µ","¶","·","¸","¹","º","»","¼","½","¾","¿","À","Á","Â","Ã","Ä","Å","Æ","Ç","È","É","Ê","Ë","Ì","Í","Î","Ï","Ð","Ñ","Ò","Ó","Ô","Õ","Ö","×","Ø","Ù","Ú","Û","Ü","Ý","Þ","ß","à","á","ã","ä","å","æ","ç","è","é","ê","ë","ì","í","î","ï","ð","ñ","ò","ó","ô","õ","ö","÷","ø","ù","ú","û","ü","ý","þ","ÿ","&","•","°","∞","‰","⋅","±","†","—","¬","µ","⊥","∥","€","£","¥","¢","©","®","™","α","β","γ","δ","ε","ζ","η","θ","ι","κ","λ","μ","ν","ξ","ο","π","ρ","σ","τ","υ","φ","χ","ψ","ω","Α","Β","Γ","Δ","Ε","Ζ","Η","Θ","Ι","Κ","Λ","Μ","Ν","Ξ","Ο","Π","Ρ","Σ","Τ","Υ","Φ","Χ","Ψ","Ω"],n=new RegExp("(&"+["quot","amp","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","amp","bull","deg","infin","permil","sdot","plusmn","dagger","mdash","not","micro","perp","par","euro","pound","yen","cent","copy","reg","trade","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigma","tau","upsilon","phi","chi","psi","omega","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega"].join(";)|(&")+";)","g");return t=t.replace(n,(function(){for(var t=1;t<arguments.length;t++)if(arguments[t])return e[t-1]}))}},e}(t.Pipe);T.meta={name:"html"};var D=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.transform=function(t){return e.labels_[t]||t},e.getKeys=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.transform(n.map((function(t){return t.replace("-","_")})).join("_"))},e.setLabels=function(){var t=f.merge({select:"Seleziona",browse:"Sfoglia",cancel:"Annulla",error_email:"Email non valida",error_match:"I campi non corrispondono",error_required:"Campo obbligatorio",loading:"caricamento",remove:"Rimuovi",required:"Richiesto",select_file:"Seleziona una file...",update:"Aggiorna",upload:"Carica",drag_and_drop_images:"Drag And Drop your images here"},x.labels);this.labels_=t},e}(t.Pipe);D.setLabels(),D.meta={name:"label"};var I=function(){function t(){}return t.scroll=function(t){this.scroll$.next(t)},t.init=function(e,n){if(n=Object.assign({useKeyboard:!0,smoothMobile:!0,inertia:.5,smooth:!0,lerp:.01,getDirection:!0,getSpeed:!0,initClass:"has-scroll-init",scrollingClass:"has-scroll-scrolling",draggingClass:"has-scroll-dragging",smoothClass:"has-scroll-smooth",scrollbarContainer:!1,scrollbarClass:"c-scrollbar",multiplier:1,firefoxMultiplier:50,touchMultiplier:2,scrollFromAnywhere:!0,gestureDirection:"vertical",reloadOnContextChange:!1,resetNativeScroll:!0},n,{el:e}),e.offsetWidth>=768){var i=new LocomotiveScroll(n);return t.instance=i,i}document.querySelector("html").classList.add("has-scroll-init")},t.init$=function(e){return i.fromEvent(window,"load").pipe(n.delay(1),n.switchMap((function(n){var i=t.init(e);if(i)i.on("scroll",(function(e){t.scroll(e)}));else{var r={direction:null,scroll:{x:0,y:0},speed:0},o=document.querySelector("body"),s=o.scrollTop;window.addEventListener("scroll",(function(){var e=o.scrollTop,n=e>s?"down":"up";s=e,r.direction=n,r.scroll.y=e,t.scroll(r)}),!0)}return t.scroll$})))},t.update=function(){this.instance&&this.instance.update()},t}();s(I,"scroll$",new i.ReplaySubject(1));var P=function(e){function i(){return e.apply(this,arguments)||this}return a(i,e),i.prototype.onInit=function(){var e=t.getContext(this).node;I.init$(e).pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(t){}))},i}(t.Directive);P.meta={selector:"[locomotive-scroll],[[locomotive-scroll]]"};var q=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.transform=function(t){return x.slug[t]||"#"+t},e}(t.Pipe);q.meta={name:"slug"};var M=function(e){function n(){return e.apply(this,arguments)||this}return a(n,e),o(n,[{key:"title",get:function(){return this.title_},set:function(e){if(this.title_!==e){this.title_=e;var n=t.getContext(this).node;e?n.setAttribute("title",e):n.removeAttribute("title")}}}]),n}(t.Directive);M.meta={selector:"[[title]]",inputs:["title"]};var R=function(e){function i(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return s(u(t=e.call.apply(e,[this].concat(i))||this),"direction_",null),t}return a(i,e),i.prototype.onInit=function(){var t=this;I.scroll$.pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(e){t.direction=e.direction}))},o(i,[{key:"direction",get:function(){return this.direction_},set:function(e){if(this.direction_!==e){var n=t.getContext(this).node;n.classList.remove("scrolling-"+this.direction_),n.classList.add("scrolling-"+e),this.direction_=e}}}]),i}(t.Component);R.meta={selector:"[header]"};var U=function(t){function i(){return t.apply(this,arguments)||this}a(i,t);var r=i.prototype;return r.onInit=function(){var t=this,i=this.form=new e.FormGroup({email:new e.FormControl(null,[e.Validators.RequiredValidator()])});this.controls=i.controls;i.changes$.pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(e){t.pushChanges()}))},r.onNewsletter=function(t){console.log("NewsletterPropositionComponent.onNewsletter",this.form.value)},i}(t.Component);U.meta={selector:"[newsletter-proposition]"};var z="select",V="or",H="query",N=function(){function t(t){this.change$=new i.BehaviorSubject,this.mode=z,this.filter="Filter",this.placeholder="Select",this.values=[],this.options=[],t&&Object.assign(this,t),t.mode===z&&t.options.unshift({label:t.placeholder,value:void 0})}var e=t.prototype;return e.filter=function(t,e){return-1!==t.options.indexOf(e)},e.match=function(t){var e,n=this;return this.mode===V?(e=!this.values.length,this.values.forEach((function(i){e=e||n.filter(t,i)}))):(e=!0,this.values.forEach((function(i){e=e&&n.filter(t,i)}))),e},e.getLabel=function(){return(this.mode===z||this.mode===H)&&this.placeholder||this.label},e.has=function(t){return-1!==this.values.indexOf(t.value)},e.set=function(t){this.mode===H?(this.values=t?[t]:[],this.placeholder=t):(this.mode===z&&(this.values=[]),-1===this.values.indexOf(t.value)&&void 0!==t.value&&this.values.push(t.value),this.mode===z&&(this.placeholder=t.label));this.change$.next()},e.remove=function(t){var e=this.values.indexOf(t.value);if(-1!==e&&this.values.splice(e,1),this.mode===z){var n=this.options[0];this.placeholder=n.label}this.change$.next()},e.toggle=function(t){this.has(t)?this.remove(t):this.set(t)},e.clear=function(){if(this.values=[],this.mode===z){var t=this.options[0];this.placeholder=t.label}this.change$.next()},t}(),B=function(){function t(){}return t.has=function(t){return new URLSearchParams(window.location.search).has(t)},t.get=function(t){return new URLSearchParams(window.location.search).get(t)},t.set=function(t,e){var n=new URLSearchParams(window.location.search);"string"==typeof t?n.set(t,e):n.set(t,""),this.pushParams(n)},t.pushParams=function(t){if(window.history&&window.history.pushState){var e=document.title,n=window.location.href.split("?")[0]+"?"+t.toString();window.history.pushState(t.toString(),e,n)}},t.replace=function(t,e){var n=window.history;if(n&&n.replaceState){var i=window.location,r=document.title;if("/"===i.pathname){var o=i.origin+e+i.search;n.replaceState(n.state,r,o)}else if(-1!==i.href.indexOf(t)){var s=i.href.replace(t,e);n.replaceState(n.state,r,s)}}},t.deserialize=function(t){var e=this.get("params");return this.decode(t,e)},t.serialize=function(t,e){var n=this.deserialize(),i=this.encode(t,e,n);this.set("params",i)},t.decode=function(t,e){var n=null;if(e){var i=window.atob(e);n=JSON.parse(i)}return t&&n&&(n=n[t]),n||null},t.encode=function(t,e,n){n=n||{};"string"==typeof t?n[t]=e:n=t;var i=JSON.stringify(n);return window.btoa(i)},t}(),K=function(){function t(t,e,n){var i={};t&&Object.keys(t).forEach((function(e){var r=new N(t[e]);"function"==typeof n&&n(e,r),i[e]=r})),this.filters=i,this.deserialize(this.filters,e)}var e=t.prototype;return e.getParamsCount=function(t){return t?Object.keys(t).reduce((function(e,n,i){var r=t[n];return e+(r?r.length:0)}),0):0},e.deserialize=function(t,e){var n;e&&this.getParamsCount(e)&&(n=e);var i=B.deserialize("filters");return i&&this.getParamsCount(i)&&(n=i),n&&Object.keys(t).forEach((function(e){t[e].values=n[e]||[]})),t},e.serialize=function(t){var e={},n=!1;return Object.keys(t).forEach((function(i){var r=t[i];null!==r.value&&(e[i]=r.values,n=!0)})),n||(e=null),B.serialize("filters",e),e},e.items$=function(t){var e=this,r=this.filters,o=Object.keys(r).map((function(t){return r[t].change$}));return i.merge.apply(void 0,o).pipe(n.tap((function(){return e.serialize(r)})),n.map((function(){return e.filterItems(t)})),n.tap((function(){return e.updateFilterStates(r,t)})))},e.filterItems=function(t,e){var n=this,i=Object.keys(this.filters).map((function(t){return n.filters[t]})).filter((function(t){return null!==t.value}));return t=t.filter((function(t){var n=!0;return i.forEach((function(i){i!==e&&(n=n&&i.match(t))})),n}))},e.updateFilterStates=function(t,e){var n=this;Object.keys(t).forEach((function(i){var r=t[i],o=n.filterItems(e,r);r.options.forEach((function(t){var e=0;if(t.value)for(var n=0;n<o.length;){var i=o[n];r.filter(i,t.value)&&e++,n++}else e=o.length;t.count=e,t.disabled=0===e}))}))},e.reset=function(){var t,e=this;Object.keys(this.filters).forEach((function(n){(t=e.filters[n]).values=[]})),t&&t.change$.next()},t}(),G=function(){function t(){}return t.http$=function(t,e,r,o){var s=this,a=null;return i.from(fetch(e,{method:t,headers:{Accept:"application/json","Content-Type":"application/json"},body:-1!==["POST","PUT","PATCH"].indexOf(t)?JSON.stringify(r):void 0}).then((function(t){a=t;try{var e,n=t.headers.get("content-type");return e=n&&-1!==n.indexOf("application/json")?t.json():t.text(),t.ok?e:e.then((function(t){return Promise.reject(t)}))}catch(e){return t.ok?(console.warn("HttpService.http$","Cannot parse response"),Promise.resolve()):Promise.reject(e)}}))).pipe(n.catchError((function(t){return i.throwError(s.getError(t,a))})))},t.get$=function(t,e,n){var i=this.query(e);return this.http$("GET",""+t+i,void 0,n)},t.delete$=function(t){return this.http$("DELETE",t)},t.post$=function(t,e){return this.http$("POST",t,e)},t.put$=function(t,e){return this.http$("PUT",t,e)},t.patch$=function(t,e){return this.http$("PATCH",t,e)},t.query=function(t){return""},t.getError=function(t,e){var n="object"==typeof t?t:{};return n.status||(n.status=e?e.status:0),n.statusCode||(n.statusCode=e?e.status:0),n.statusMessage||(n.statusMessage=e?e.statusText:t),n},t}(),W=function(){function t(){}return t.getDefaultLanguages=function(){return x.alternates||[]},t.getDefaultLanguage=function(){return x.defaultLanguage||(this.languages?this.languages[0].lang:null)},t.setLanguage=function(t){this.selectedLanguage=t.lang},t.setLanguage$=function(t){var e=this;return i.from(fetch(t.href).then((function(t){return t.text()}))).pipe(n.tap((function(n){var i=/(window\.labels[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*=[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\n*[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\{((\{[\s\S]+?\})|[\s\S])+?\})/gm.exec(n);i&&(new Function(i[0]).call(window),D.setLabels());var r=/(window\.bhere[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*=[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\n*[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\{((\{[\s\S]+?\})|[\s\S])+?\})/gm.exec(n);if(r){var o={};new Function(r[0].replace("window","this")).call(o),o.bhere&&f.merge(x,o.bhere)}B.replace(e.activeLanguage.href,t.href),e.selectedLanguage=t.lang})))},t.toggleLanguages=function(){this.showLanguages=!this.showLanguages,this.pushChanges()},o(t,null,[{key:"hasLanguages",get:function(){return this.languages.length>1}},{key:"activeLanguage",get:function(){var t=this;return this.languages.find((function(e){return e.lang===t.selectedLanguage}))}}]),t}();s(W,"languages",W.getDefaultLanguages()),s(W,"defaultLanguage",W.getDefaultLanguage()),s(W,"selectedLanguage",W.defaultLanguage);var J=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.get$=function(e,n,i){return t.get$.call(this,""+x.api+e,n,i)},e.delete$=function(e){return t.delete$.call(this,""+x.api+e)},e.post$=function(e,n){return t.post$.call(this,""+x.api+e,n)},e.put$=function(e,n){return t.put$.call(this,""+x.api+e,n)},e.patch$=function(e,n){return t.patch$.call(this,""+x.api+e,n)},e}(G);s(J,"currentLanguage",W.activeLanguage);var X=function(){function t(){}return t.all$=function(){return J.get$("/projects/all.json")},t.filters$=function(){return J.get$("/projects/filters.json")},t}(),Y=function(t){function r(){return t.apply(this,arguments)||this}a(r,t);var o=r.prototype;return o.onInit=function(){var t=this;this.items=[],this.filteredItems=[],this.filters={},this.filter={};var i=this.form=new e.FormGroup({category:new e.FormControl(null,[e.Validators.RequiredValidator()]),search:new e.FormControl(null,[e.Validators.RequiredValidator()])}),r=this.controls=i.controls;i.changes$.pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(e){t.setFilterByKeyAndValue("category",i.value.category),t.setFilterByKeyAndValue("search",i.value.search),t.pushChanges()})),this.load$().pipe(n.first()).subscribe((function(e){t.items=e[0],t.filters=e[1];var n=t.filters.category.options.slice().map((function(t){return{id:t.value,name:t.label}}));n.unshift({id:null,name:"select"}),r.category.options=n,t.onLoad(),t.pushChanges()}))},o.load$=function(){return i.combineLatest([X.all$(),X.filters$()])},o.onLoad=function(){var t=this,e=this.items,i=this.filters;Object.keys(i).forEach((function(t){i[t].mode=i[t].mode||V}));var r=new K(i,{},(function(t,e){e.filter=function(e,n){switch(t){case"category":return e.category.id===n;case"search":return-1!==e.title.toLowerCase().indexOf(n.toLowerCase())||-1!==e.country.toLowerCase().indexOf(n.toLowerCase())}}}));this.filterService=r,this.filters=r.filters,this.filter=this.filters.category,r.items$(e).pipe(n.takeUntil(this.unsubscribe$)).subscribe((function(e){t.filteredItems=e,t.pushChanges(),I.update()}))},o.setFilterByKeyAndValue=function(t,e){var n=this.filters[t];if(n)if(n.mode===H)n.set(e);else{var i=n.options.find((function(t){return t.value===e}));i?n.set(i):n.clear()}this.pushChanges()},o.toggleFilter=function(t){var e=this;Object.keys(this.filters).forEach((function(n){var i=e.filters[n];i.active=i===t&&!i.active})),this.pushChanges()},o.onSearch=function(t){this.setFilterByKeyAndValue("category",this.form.value.category),this.setFilterByKeyAndValue("search",this.form.value.search)},o.clearFilter=function(t,e){t.preventDefault(),t.stopImmediatePropagation(),e.clear(),this.pushChanges()},r}(t.Component);Y.meta={selector:"[projects]"};var Z=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e}(t.Module);Z.meta={imports:[t.CoreModule,e.FormModule],declarations:[A,_,F,p,d,O,j,R,T,D,P,U,Y,q,M],bootstrap:c},t.Browser.bootstrap(Z)}));
//# sourceMappingURL=main.min.js.map